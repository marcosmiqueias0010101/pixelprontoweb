!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="963c0afe-0558-42d5-b8f9-245ced729dae",e._sentryDebugIdIdentifier="sentry-dbid-963c0afe-0558-42d5-b8f9-245ced729dae")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3300],{3209:(e,t,a)=>{a.d(t,{I:()=>p,O:()=>u});var s=a(3547),n=a(23232);function r(e){if(0===e.length)throw Error("List is empty");return e[Math.floor(Math.random()*e.length)]}var i=a(3683),l=a(88382),o=a(65146),c=a(31651),d=a(84499);function u(){let{t:e}=(0,o.Bd)("workspace"),t=(0,n._)(),{push:a}=(0,d.wK)(),[s,r]=(0,l.useState)(!1),c=(0,i.M)(e=>e.createWorkspace);return{isPending:s,add:async function(){let s,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{name:i,icon:l,instructions:o}=n;r(!0);try{let n=await c({name:null!=i?i:e("workspace-default-name","New Project"),icon:null!=l?l:p(),customPersonality:o});t("ws_create",n.workspaceId,{location:"workspace:useAddWorkspace"}),s=n.workspaceId,a({page:"workspace",workspaceId:n.workspaceId,tab:"attachments"})}finally{r(!1)}return s}}}function p(){let e=r(Object.keys(s.Pt)),t=r(s.Tj);return(0,c.K)({icon:e,color:t})}},5851:(e,t,a)=>{a.d(t,{C:()=>l});var s=a(65258),n=a(56521);async function r(e){(await (0,n.h)("/api/update-team-cookie",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamId:e})})).ok||console.error("Failed to update cookie")}class i{constructor(e,t){this.set=e,this.get=t,this.teamDialogIsOpen=!1,this.setCurrentTeamId=(0,s.kp)(this.set,"currentTeamId"),this.setTeamDialogIsOpen=(0,s.kp)(this.set,"teamDialogIsOpen"),this.openSwitchTeamDialog=()=>{this.setTeamDialogIsOpen(!0)},this.closeSwitchTeamDialog=()=>{this.setTeamDialogIsOpen(!1)},this.switchTeam=async e=>{await r(e),this.setCurrentTeamId(e)}}}let l=(0,s.y$)(i,"useTeamStore")},10678:(e,t,a)=>{a.d(t,{h:()=>p});var s=a(79342),n=a(23232),r=a(24734),i=a(7658),l=a(70526),o=a(92437),c=a(88382),d=a(65146),u=a(44566);function p(e){var t;let{onDrop:a,className:p,workspaceId:m,disabled:h}=e,{t:x}=(0,d.Bd)("workspace"),g=(0,n._)(),{mutate:v,error:f}=(0,i.Iv)(m);(0,r.Y)("workspace-drop-zone:upload",f);let j=(0,u.x)(m),{data:b}=(0,i.UL)(m),w=null!=(t=null==b?void 0:b.assets)?t:[],y=(0,c.useRef)(null),k=(0,c.useCallback)(e=>{if(null==a||a(),w.length+e.length>l.aD){j(),g("ws_max_files_alert",void 0,{location:"workspace-file-drop"});return}e.forEach(e=>(g("upload_file",e.name,{location:"workspace-file-drop",mimeType:e.type}),v(e)))},[w.length,a,j,g,v]),N=(0,o.t)({ref:y,onDrop:k});return h?null:(0,s.jsx)(o.u,{ref:y,dragState:N,title:x("workspace-dropzone.title","Attach to project"),subtitle:x("workspace-dropzone.description","Drop here to add files to project"),className:p})}},10986:(e,t,a)=>{a.d(t,{SidePanelProvider:()=>l});var s=a(79342),n=a(88844);a(56691),a(72055);var r=a(88382);a(65146);let i=(0,r.createContext)(null);function l(e){let{children:t}=e,[a,l]=(0,r.useState)(null),o=(0,r.useCallback)(e=>{l(t=>(t&&t.id!==e.id&&t.onOpenChange(!1),e))},[]),c=(0,r.useCallback)(e=>{l(t=>t&&t.id===e?null:t)},[]);return(0,s.jsxs)(i.Provider,{value:{openPanel:o,closePanel:c,activeEntry:a},children:[t,(0,s.jsx)(n.w,{isVisible:null!==a,minWidth:200,maxWidth:800,initialWidth:400,className:"bg-background max-w-[40%] xl:max-w-none",children:null==a?void 0:a.children})]})}},12001:(e,t,a)=>{a.d(t,{A:()=>r});var s=a(79342),n=a(72712);let r=e=>(0,s.jsx)(n.I,{viewBox:"-0.5 -0.5 15 15",...e,children:(0,s.jsx)("path",{d:"M7.23047 1.26183C7.86569 0.082389 9.45799 -0.151271 10.4053 0.796012L13.2041 3.59484C14.1514 4.54211 13.9177 6.1344 12.7383 6.76964L11.1338 7.6339C10.5893 7.9271 10.2112 8.45562 10.1094 9.06554L9.62207 11.9874L8.33301 13.2765L5 9.9425L2.1377 12.8019L1 13.0001L1.19824 11.8614L4.05664 9.00011L0.723633 5.66711L2.0127 4.37804L4.93359 3.89074C5.54368 3.78906 6.07294 3.41087 6.36621 2.86632L7.23047 1.26183Z",fill:"currentColor"})})},12065:(e,t,a)=>{a.d(t,{c:()=>l});var s=a(23232),n=a(24734),r=a(49972),i=a(88382);function l(){let e=(0,n.K)(),t=(0,s._)();return{handlePinConversation:(0,i.useCallback)((a,s,n)=>{let{fetchUpdateConversation:i}=r.w.getState();i(a,{starred:s}).catch(t=>{e("app-sidebar:handlePinConversation",t)}),t("update_conversation_pinned",a,{location:n})},[e,t])}}},16454:(e,t,a)=>{a.d(t,{_:()=>g});var s=a(79342),n=a(60065),r=a(23232),i=a(61312),l=a(58711),o=a(33846),c=a(74995),d=a(88382),u=a(65146),p=a(42557),m=a(5790),h=a(56691),x=a(38997);let g=e=>{let{className:t}=e,{t:a}=(0,u.Bd)("upsell"),g=(0,l.e)(c.A("setIsUpselling")),v=(0,m.iV)(c.A("setOpen")),f=(0,p.wV)(),j=(0,r._)(),b=d.useCallback(()=>{j("upsell_card_clicked",f.countryCode,{location:"upsell-card",countryCode:f.countryCode||""}),g(!0),v(!1)},[j,f.countryCode,g,v]);return(0,s.jsxs)(o.P.div,{role:"button",className:(0,i.cn)("relative px-4 py-3.5 w-full items-center bg-black text-xs text-white border cursor-pointer","border-card rounded-3xl group text-left flex gap-4 dark -mb-10 sm:-mb-4 transition-all","duration-300 ease-in-out","hover:scale-[1.01] will-change-transform",t),onClick:b,children:[(0,s.jsx)(n.I,{starDensity:.001,className:"rounded-[23px]"}),(0,s.jsx)("div",{className:"absolute inset-0 flex justify-center top-0 overflow-hidden rounded-[23px]",children:(0,s.jsx)("div",{className:"size-80 bg-red-500 bg-gradient-to-r from-sunset via-breeze to-cobalt aspect-square opacity-10 absolute bottom-4 blur-[32px] rounded-full"})}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 sm:items-center z-10 mb-0.5",children:[(0,s.jsx)(x.jI,{}),(0,s.jsx)("p",{className:"text-muted-foreground ms-1 sm:ms-0 ",children:a("Fewer rate limits, more capabilities","Fewer rate limits, more capabilities")})]}),(0,s.jsx)(h.$n,{variant:"filled",rounded:!0,className:"ms-auto z-10",children:a("Go Super","Go Super")})]})}},19841:(e,t,a)=>{a.d(t,{w:()=>b});var s=a(79342),n=a(72055),r=a(18585),i=a(56691),l=a(75500),o=a(41320),c=a(2376),d=a(87206),u=a(5862),p=a(61312),m=a(83123),h=a(61683),x=a(32171),g=a.n(x),v=a(88382),f=a(65146);function j(e){let{conversation:t,onEditStart:a,onDeleteStart:r}=e,{t:l}=(0,f.Bd)("base"),c=(0,o.Di)(),d=(0,v.useCallback)(e=>{e.stopPropagation(),window.open("/chat/".concat(t.conversationId),"_blank")},[t.conversationId]),u=(0,v.useCallback)(e=>{e.stopPropagation(),a(t.conversationId)},[a,t.conversationId]),p=(0,v.useCallback)(e=>{e.stopPropagation(),r(t.conversationId)},[r,t.conversationId]);return(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[!c&&(0,s.jsx)(i.gx,{tabIndex:-1,variant:"ghost",size:"iconSm",onClick:d,tooltipContent:l("New Tab","New Tab"),"aria-label":l("New Tab","New Tab"),children:(0,s.jsx)(n.k0t,{size:16,className:"text-primary"})}),(0,s.jsx)(i.gx,{tabIndex:-1,variant:"ghost",size:"iconSm",onClick:u,tooltipContent:l("Rename","Rename"),"aria-label":l("Rename","Rename"),children:(0,s.jsx)(n.rZj,{size:16,className:"text-primary"})}),(0,s.jsx)(i.gx,{tabIndex:-1,variant:"ghost",size:"iconSm","aria-label":l("Delete","Delete"),onClick:p,tooltipContent:l("Delete","Delete"),children:(0,s.jsx)(n.ucK,{size:16,className:"text-primary"})})]})}let b=(0,v.memo)(e=>{var t;let{conversation:a,highlight:i,matchType:d,matchedWords:u,isEditing:m,isDeleting:h,isSelected:x,isCurrent:b,isHovered:S,newTitle:I,onNewTitleChange:_,onSelect:P,onEditStart:E,onDeleteStart:M,onToggleFavorite:T,onEditSave:z,onDeleteConfirm:D,onCancel:A,className:R}=e,{t:L}=(0,f.Bd)("base"),O=(0,l.h)(),B=(0,o.Di)(),F=(0,v.useMemo)(()=>a.title?a.title:a.createTime?L("conversation-missing-title","Chat on {{date}}",{date:new Date(a.createTime).toLocaleDateString()}):L("Untitled Chat","Untitled Chat"),[a,L]),K=(0,v.useMemo)(()=>"MATCH_MESSAGE"===d&&!!i,[d,i]),H=(0,v.useCallback)(()=>{z(a.conversationId)},[z,a.conversationId]),$=(0,v.useCallback)(e=>{e.stopPropagation(),"Enter"===e.key?H():"Escape"===e.key&&A()},[H,A]),U=(0,v.useCallback)(()=>{D(a.conversationId)},[D,a.conversationId]),{personaById:W}=(0,c.v5)(),G=(0,v.useMemo)(()=>{if(!(0,c.sS)(a.personaId))return;let e=W[a.personaId];if(e)return{...e,...(0,r.e8)(e.personaId)}},[a.personaId,W]),X=(0,v.useCallback)(e=>{P&&(1===e.button||e.ctrlKey||e.metaKey||e.shiftKey||(e.preventDefault(),P(a.conversationId)))},[P,a.conversationId]);return(0,s.jsxs)(s.Fragment,{children:[!m&&(0,s.jsx)(g(),{href:"/chat/".concat(a.conversationId),className:"col-start-1 col-end-2 row-start-1 row-end-2 block z-10",onClick:X}),(0,s.jsxs)("div",{className:(0,p.cn)("flex cursor-pointer items-center gap-2 px-3 col-start-1 col-end-2 row-start-1 row-end-2",R),children:[m?(0,s.jsx)("input",{className:"w-full bg-transparent focus-visible:outline-none",value:I,onKeyDown:$,autoFocus:!0,onChange:e=>{_(e.target.value)}}):(0,s.jsxs)("div",{className:"flex-grow min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 w-full",children:[G?(0,s.jsx)("span",{className:(0,p.cn)("[&>svg]:h-4 [&>svg]:w-4",G.colorClassName),children:G.icon}):!!((null==(t=a.mediaTypes)?void 0:t.includes("audio"))&&O.ENABLE_VOICE_MODE)&&(0,s.jsx)(n.b7X,{className:"text-secondary h-4 w-4 shrink-0"}),(0,s.jsx)("div",{className:"truncate text-primary",children:"MATCH_TITLE"===d?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t||0===t.length||"string"!=typeof e)return e;let a=t.map(e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("|"),n=RegExp("(".concat(a,")"),"gi"),r=e.split(n);return 1===r.length?e:r.map((e,t)=>t%2==1?(0,s.jsx)("span",{className:"text-primary font-extrabold",children:e},t):e)}(F,u):F}),b&&(0,s.jsx)(w,{children:L("Current","Current")})]}),K&&(0,s.jsx)(C,{text:i,matchedWords:u||[],className:"text-xs text-secondary mt-0.5 truncate"})]}),(0,s.jsx)("div",{className:"z-20",children:(x&&S||B)&&!m&&!h?(0,s.jsx)(j,{conversation:a,onEditStart:E,onDeleteStart:M,onToggleFavorite:T}):m?(0,s.jsx)(y,{onCancel:A,onSave:H}):h?(0,s.jsx)(k,{onCancel:A,onConfirm:U}):(0,s.jsx)(N,{conversation:a})})]})]})});function w(e){let{children:t}=e;return(0,s.jsx)("span",{className:(0,p.cn)("border border-border-l2 px-2 rounded-full","text-sm text-secondary flex flex-row items-center gap-1 text-nowrap"),children:t})}function y(e){let{onCancel:t,onSave:a}=e,{t:r}=(0,f.Bd)("base");return(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(i.gx,{tabIndex:-1,variant:"ghost",size:"iconSm",onClick:e=>{e.stopPropagation(),t()},tooltipContent:r("Cancel","Cancel"),"aria-label":r("Cancel","Cancel"),children:(0,s.jsx)(n.uv5,{size:16,className:"text-fg-primary"})}),(0,s.jsx)(i.gx,{tabIndex:-1,variant:"ghost",size:"iconSm",onClick:e=>{e.stopPropagation(),a()},tooltipContent:r("Save","Save"),"aria-label":r("Save","Save"),children:(0,s.jsx)(n.Jlk,{size:16,className:"text-primary"})})]})}function k(e){let{onCancel:t,onConfirm:a}=e,{t:r}=(0,f.Bd)("base");return(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(i.gx,{tabIndex:-1,variant:"ghost",size:"iconSm",onClick:e=>{e.stopPropagation(),t()},tooltipContent:r("Cancel","Cancel"),"aria-label":r("Cancel","Cancel"),children:(0,s.jsx)(n.uv5,{size:16,className:"text-fg-primary"})}),(0,s.jsx)(i.gx,{tabIndex:-1,variant:"ghost",size:"iconSm",onClick:e=>{e.stopPropagation(),a()},tooltipContent:r("Delete","Delete"),"aria-label":r("Delete","Delete"),children:(0,s.jsx)(n.ucK,{size:16,className:"text-red-400"})})]})}function N(e){let{conversation:t}=e,a=(0,v.useMemo)(()=>(0,u.JU)(t.modifyTime),[t.modifyTime]),n=(0,v.useMemo)(()=>{if(t.modifyTime||t.createTime)return function(e,t){let a=new Date(e);if("this-year"===t)return a.toLocaleDateString(h.Ay.language,{day:"numeric",month:"short"});{if("older"===t)return a.toLocaleDateString(h.Ay.language,{day:"numeric",month:"short",year:"numeric"});let s=(0,m.a)(e,new Date,{unit:"day",locale:"en"}),n="day";return"today"===s&&(n=void 0),"yesterday"===s&&(n="hour"),(0,d.B)((0,m.a)(e,new Date,{unit:n,locale:h.Ay.language}))}}(t.modifyTime||t.createTime,a||"older")},[t.modifyTime,t.createTime,a]);return n?(0,s.jsx)("span",{className:(0,p.cn)("text-secondary whitespace-nowrap ml-2 hidden text-sm","md:inline md:group-hover/item:hidden","md:group-focus/item:hidden md:group-active/item:hidden"),children:n}):null}function C(e){let{text:t,matchedWords:a,className:n}=e;if(!t||!(null==a?void 0:a.length))return(0,s.jsx)(s.Fragment,{children:t});let r=a.map(e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("|"),i=RegExp("(".concat(r,")"),"gi"),l=t.split(i);return(0,s.jsx)("div",{className:n,children:l.map((e,t)=>a.some(t=>t.toLowerCase()===e.toLowerCase())?(0,s.jsx)("span",{className:(0,p.cn)("text-primary font-bold"),children:e},t):(0,s.jsx)(v.Fragment,{children:e},t))})}},20269:(e,t,a)=>{a.d(t,{vd:()=>S,y$:()=>w,vu:()=>b,jy:()=>C,b:()=>y,hV:()=>k,Zr:()=>j,Bx:()=>E,Yv:()=>A,CG:()=>D,Cn:()=>R,Gh:()=>z,CP:()=>F,G:()=>K,wZ:()=>L,Uj:()=>B,FX:()=>O,SidebarProvider:()=>P,x2:()=>M,cL:()=>_});var s=a(79342),n=a(7287),r=a(88382),i=a(65146),l=a(56691),o=a(74933),c=a(69648),d=a(80226),u=a(61884),p=a(41320),m=a(80354),h=a(61312);let x={};var g=a(72055),v=a(84969),f=a(33846);let j="h-[36px]",b="w-[1.75rem] h-[1.75rem]",w="px-[0.5rem]",y="h-[2.5rem]",k="mx-[.125rem]",N="mx-1",C="p-[0.375rem]",S="start-[.5rem]",I=r.createContext(null);function _(){let e=r.useContext(I);if(!e)throw Error("useSidebar must be used within a SidebarProvider.");return e}let P=r.forwardRef((e,t)=>{let{defaultOpen:a=!0,open:n,onOpenChange:i,className:l,style:o,children:c,...d}=e,m=(0,p.Di)(0),[g,v]=r.useState(!1),[f,j]=function(e,t){let a=(0,r.useRef)("function"==typeof t?t():t).current,[s,n]=(0,r.useState)(()=>{try{let t=window.sessionStorage.getItem(e);return t?JSON.parse(t):a}catch(e){return console.error("Error parsing sessionStorage value:",e),a}});return(0,r.useEffect)(()=>{let t=e=>{n(e)};return x[e]||(x[e]=[]),x[e].push(t),()=>{x[e]&&(x[e]=x[e].filter(e=>e!==t))}},[e]),(0,r.useEffect)(()=>{let t=t=>{if(t.key===e&&t.storageArea===window.sessionStorage)if(null!==t.newValue)try{n(JSON.parse(t.newValue))}catch(e){console.error("Error parsing storage event value:",e)}else n(a)};return window.addEventListener("storage",t),()=>{window.removeEventListener("storage",t)}},[e,a]),[s,t=>{try{let a="function"==typeof t?t(s):t;window.sessionStorage.setItem(e,JSON.stringify(a)),n(a),x[e]&&x[e].forEach(e=>e(a))}catch(e){console.error("Error setting sessionStorage value:",e)}}]}("sidebarOpen",a),b=null!=n?n:f,w=r.useCallback(e=>{if(i)return null==i?void 0:i("function"==typeof e?e(b):e);j(e)},[i,j,b]),y=r.useCallback(()=>m?v(e=>!e):w(e=>!e),[m,w,v]),k=b?"expanded":"collapsed",N=r.useMemo(()=>({state:k,open:b,setOpen:w,isMobile:m,openMobile:g,setOpenMobile:v,toggleSidebar:y,contentWidthClass:"w-[calc(100%-var(--sidebar-width))]"}),[k,b,w,m,g,v,y]);return(0,s.jsx)(I.Provider,{value:N,children:(0,s.jsx)(u.Bc,{delayDuration:0,children:(0,s.jsx)("div",{style:{"--sidebar-width":"16rem","--sidebar-width-icon":"3.5rem",...o},className:(0,h.cn)("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",l),ref:t,...d,children:c})})})});P.displayName="SidebarProvider";let E=r.forwardRef((e,t)=>{let{side:a="left",variant:n="sidebar",collapsible:r="offcanvas",className:l,children:o,...c}=e,{state:d,openMobile:u,setOpenMobile:m,toggleSidebar:x}=_(),g=(0,p.Di)(),{t:f}=(0,i.Bd)("base");return"none"===r?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:(0,h.cn)("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground","print:hidden",l),ref:t,...c,children:o})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.N,{children:g&&"expanded"===d&&(0,s.jsx)(T,{onClick:x})}),(0,s.jsx)("div",{ref:t,className:(0,h.cn)("group peer md:block text-sidebar-foreground z-[40]","print:hidden"),"data-state":d,"data-collapsible":"collapsed"===d?r:"","data-variant":n,"data-side":a,children:(0,s.jsx)("div",{className:(0,h.cn)("duration-200 inset-y-0 z-10 h-svh w-[--sidebar-width] box-content transition-[left,right,width] ease-linear md:flex","floating"===n?"absolute":"block","floating"===n||"inset"===n?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]","left"===a?"start-0 group-data-[collapsible=offcanvas]:start-[calc(var(--sidebar-width)*-1)]":"end-0 group-data-[collapsible=offcanvas]:end-[calc(var(--sidebar-width)*-1)]",l),...c,children:(0,s.jsx)("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-xl",children:o})})})]})});E.displayName="Sidebar";let M=r.forwardRef((e,t)=>{let{className:a,onClick:n,iconSize:o=20,...c}=e,{toggleSidebar:d,open:u}=_(),{t:p}=(0,i.Bd)("base"),m=(0,r.useCallback)(e=>{null==n||n(e),d()},[d]);return(0,s.jsx)("div",{className:(0,h.cn)(u?"cursor-w-resize":"cursor-e-resize","grow"),onClick:m,children:(0,s.jsxs)(l.$n,{ref:t,"data-sidebar":"trigger",variant:"ghostSecondary",size:"icon",rounded:!0,className:(0,h.cn)(a),...c,children:[(0,s.jsx)(g.hIh,{className:(0,h.cn)(u&&"rotate-180","transition-transform duration-200"),size:o}),(0,s.jsx)("span",{className:"sr-only",children:p("Toggle Sidebar","Toggle Sidebar")})]})})});M.displayName="SidebarTrigger",r.forwardRef((e,t)=>{let{className:a,...n}=e,{toggleSidebar:r}=_();return(0,s.jsx)("button",{ref:t,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:r,title:"Toggle Sidebar",className:(0,h.cn)("absolute top-0 left-0 h-full",a),style:{width:"var(--sidebar-width-icon)"}})}).displayName="SidebarRail";let T=e=>{let{className:t,onClick:a}=e;return(0,s.jsx)(f.P.div,{className:(0,h.cn)("fixed inset-0 z-[30] bg-overlay",t),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},onClick:a},"sidebar-overlay")};T.displayName="SidebarOverlay",r.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("main",{ref:t,className:(0,h.cn)("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",a),...n})}).displayName="SidebarInset",r.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(o.p,{ref:t,"data-sidebar":"input",className:(0,h.cn)("h-8 w-full bg-background shadow-none focus-visible:ring-1 focus-visible:ring-sidebar-ring",a),...n})}).displayName="SidebarInput";let z=r.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,"data-sidebar":"header",className:(0,h.cn)("flex flex-col gap-2",a),...n})});z.displayName="SidebarHeader";let D=r.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,"data-sidebar":"footer",className:(0,h.cn)("flex flex-col gap-2 mt-auto",a),...n})});D.displayName="SidebarFooter",r.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(c.w,{ref:t,"data-sidebar":"separator",className:(0,h.cn)("mx-2 w-auto bg-sidebar-border",a),...n})}).displayName="SidebarSeparator";let A=r.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,"data-sidebar":"content",className:(0,h.cn)("flex min-h-0 flex-col overflow-auto group-data-[collapsible=icon]:overflow-hidden grow",a),...n})});A.displayName="SidebarContent";let R=r.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,"data-sidebar":"group",className:(0,h.cn)("relative flex w-full min-w-0 flex-col","px-1.5","py-[2px]","shrink-0","transition-[width,transform,opacity] duration-200",a),...n})});R.displayName="SidebarGroup",r.forwardRef((e,t)=>{let{className:a,asChild:r=!1,...i}=e,l=r?n.DX:"div";return(0,s.jsx)(l,{ref:t,"data-sidebar":"group-label",className:(0,h.cn)("duration-200 flex h-8 shrink-0 items-center rounded-xl px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-1  [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",a),...i})}).displayName="SidebarGroupLabel",r.forwardRef((e,t)=>{let{className:a,asChild:r=!1,...i}=e,l=r?n.DX:"button";return(0,s.jsx)(l,{ref:t,"data-sidebar":"group-action",className:(0,h.cn)("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-xl p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-1  [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",a),...i})}).displayName="SidebarGroupAction",r.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,"data-sidebar":"group-content",className:(0,h.cn)("w-full text-sm",a),...n})}).displayName="SidebarGroupContent";let L=r.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("ul",{ref:t,"data-sidebar":"menu",className:(0,h.cn)("flex w-full min-w-0 flex-col cursor-default",a),onClick:m.Y,...n})});L.displayName="SidebarMenu";let O=r.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("li",{ref:t,"data-sidebar":"menu-item",className:(0,h.cn)("group/menu-item relative whitespace-nowrap font-semibold",N,a),...n})});O.displayName="SidebarMenuItem";let B=r.forwardRef((e,t)=>{let{asChild:a=!1,isActive:r=!1,allowActive:i=!0,tooltip:l,highlighted:o=!1,className:c,heightClassName:d=j,safeArea:p=!1,...m}=e,x=a?n.DX:"button",{isMobile:g,state:v}=_(),f="collapsed"===v,b=(0,s.jsx)(x,{ref:t,"data-sidebar":"menu-button","data-active":r,tabIndex:-1,className:(0,h.cn)("peer/menu-button flex items-center gap-2 overflow-hidden rounded-xl text-left","text-sm outline-none ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-1","group-has-[[data-sidebar=menu-action]]/menu-item:pr-8","[&>span:last-child]:truncate [&>svg]:shrink-0","hover:bg-button-ghost-hover hover:text-primary","text-sm",p&&f&&'before:content-[""] before:absolute before:-inset-x-2.5 before:-inset-y-0.5 before:rounded-xl',d,o?"bg-button-ghost-hover border-border-l1":"border-transparent","hover:bg-button-ghost-hover","data-[state=open]:hover:bg-button-ghost-hover",i&&"active:bg-button-ghost-active",i&&"data-[active=true]:bg-button-ghost-active","aria-expanded:bg-button-ghost-hover",c),...m});return l?("string"==typeof l&&(l={children:l}),(0,s.jsxs)(u.m_,{children:[(0,s.jsx)(u.k$,{asChild:!0,children:b}),(0,s.jsx)(u.ZI,{side:"right",align:"center",hidden:!f||g,container:document.getElementById("tooltip-portal"),...l})]})):b});B.displayName="SidebarMenuButton",r.forwardRef((e,t)=>{let{className:a,asChild:r=!1,showOnHover:i=!1,...l}=e,o=r?n.DX:"button";return(0,s.jsx)(o,{ref:t,"data-sidebar":"menu-action",className:(0,h.cn)("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-xl p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-1 peer-hover/menu-button:text-sidebar-accent-foreground  [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",i&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",a),...l})}).displayName="SidebarMenuAction",r.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,"data-sidebar":"menu-badge",className:(0,h.cn)("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-xl px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",a),...n})}).displayName="SidebarMenuBadge",r.forwardRef((e,t)=>{let{className:a,showIcon:n=!1,...i}=e,l=r.useMemo(()=>"".concat(Math.floor(40*Math.random())+50,"%"),[]);return(0,s.jsxs)("div",{ref:t,"data-sidebar":"menu-skeleton",className:(0,h.cn)("rounded-xl h-8 flex gap-2 px-2 items-center",a),...i,children:[n&&(0,s.jsx)(d.E,{className:"rounded-xl size-4","data-sidebar":"menu-skeleton-icon"}),(0,s.jsx)(d.E,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":l}})]})}).displayName="SidebarMenuSkeleton",r.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("ul",{ref:t,"data-sidebar":"menu-sub",className:(0,h.cn)("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",a),...n})}).displayName="SidebarMenuSub",r.forwardRef((e,t)=>{let{...a}=e;return(0,s.jsx)("li",{ref:t,...a})}).displayName="SidebarMenuSubItem",r.forwardRef((e,t)=>{let{asChild:a=!1,size:r="md",isActive:i,className:l,...o}=e,c=a?n.DX:"a";return(0,s.jsx)(c,{ref:t,"data-sidebar":"menu-sub-button","data-size":r,"data-active":i,className:(0,h.cn)("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-xl px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-1 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate  [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground","sm"===r&&"text-xs","md"===r&&"text-sm","group-data-[collapsible=icon]:hidden",l),...o})}).displayName="SidebarMenuSubButton";let F=r.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,"data-sidebar":"icon",className:(0,h.cn)("size-6","flex items-center justify-center shrink-0",a),...n})});function K(e){let{children:t,onClickIndent:a}=e;return(0,s.jsxs)("div",{className:(0,h.cn)("flex flex-row mt-1 ",N),children:[(0,s.jsx)("div",{className:"cursor-pointer ms-[8px] me-[2px] py-1",onClick:a,children:(0,s.jsx)("div",{className:"border-l border-border-l1 h-full ms-[10px] me-[4px]"})}),(0,s.jsx)("div",{className:"flex flex-col gap-1 w-full min-w-0",children:t})]})}F.displayName="SidebarIcon"},26676:(e,t,a)=>{a.d(t,{n:()=>x});var s=a(79342),n=a(3547),r=a(72055),i=a(56691),l=a(34500),o=a(1826),c=a(41320),d=a(61312),u=a(88382),p=a(65146),m=a(31651),h=a(47095);let x=(0,u.memo)(e=>{let{icon:t,sizeClass:a="size-6",rounded:x=!1,buttonSize:g="iconMd",onChange:v,disabled:f=!1}=e,{t:j}=(0,p.Bd)("workspace"),[b,w]=(0,u.useState)(!1),y=(0,c.Di)();(0,u.useEffect)(()=>{w(!1)},[t]);let k=(0,u.useCallback)(e=>{w(!1),null==v||v((0,m.K)(e))},[v]),N=(0,s.jsx)(i.$n,{variant:"ghost",size:g,rounded:x,overideIconStyle:!0,className:"text-2xl","aria-label":j("workspace-icon.change","Change icon"),children:(0,s.jsx)(h.O,{icon:t,className:a})});return f?(0,s.jsx)("div",{className:(0,d.cn)((0,i.ru)({size:g,rounded:x}),"cursor-default"),children:(0,s.jsx)(h.O,{icon:t,className:a})}):y?(0,s.jsxs)(l._s,{open:b,onOpenChange:w,children:[(0,s.jsx)(l.Uz,{asChild:!0,children:N}),(0,s.jsxs)(l.zj,{className:"p-1 max-h-[70dvh]",children:[(0,s.jsxs)(l.BE,{className:"text-left flex justify-between items-center ",children:[(0,s.jsxs)(l.gk,{className:"flex gap-2",children:[(0,s.jsx)(r.XRf,{size:16,className:"text-secondary"}),j("workspace-icon-drawer.title","Pick new icon")]}),(0,s.jsx)(i.$n,{variant:"ghostSecondary","aria-label":j("close","Close"),onClick:()=>w(!1),children:(0,s.jsx)(r.X,{size:16})})]}),(0,s.jsx)(n.ar,{onSelect:k})]})]}):(0,s.jsxs)(o.AM,{open:b,onOpenChange:w,children:[(0,s.jsx)(o.Wv,{asChild:!0,children:N}),(0,s.jsx)(o.hl,{className:"p-0 border z-[100]",align:"start",children:(0,s.jsx)(n.ar,{onSelect:k})})]})})},35228:(e,t,a)=>{a.d(t,{Yp:()=>_,Oh:()=>m.O,w8:()=>eS,TP:()=>eD});var s=a(72359),n=a(88382),r=a(79342),i=a(56691),l=a(39729),o=a(23232),c=a(84499),d=a(61312),u=a(72055),p=a(65146),m=a(47095),h=a(73772),x=a(75500),g=a(24994),v=a(33846),f=a(14908);let j={initial:{opacity:1,scale:1},copied:{opacity:0,scale:.8,transition:{duration:.2}}};function b(e){let{t}=(0,p.Bd)("workspace"),[a,s]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{if(a){let e=setTimeout(()=>{s(!1)},2e3);return()=>clearTimeout(e)}},[a]),(0,r.jsxs)(i.$n,{size:"md",variant:"outline",onClick:()=>{navigator.clipboard.writeText(e.text).then(()=>{s(!0)}).catch(e=>{f.oR.error(t("workspace-copy-link-button.error","Failed to copy link")),console.error("Failed to copy: ",e)})},className:"flex items-center gap-2",children:[(0,r.jsx)(v.P.div,{variants:j,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1,transition:{duration:.2,delay:0}},className:"flex items-center",children:a?(0,r.jsx)(u.Jlk,{className:"size-4 text-fg-positive"}):(0,r.jsx)(u.qYV,{className:"size-4 text-fg-secondary"})},a?"check":"link"),(0,r.jsx)("span",{children:a?t("workspace-copy-link-button.copied","Copied!"):t("workspace-copy-link-button.label","Copy Link")})]})}var w=a(35819),y=a(3683);function k(e){var t;let{workspace:a}=e,s=(0,o._)(),{t:i}=(0,p.Bd)("workspace"),[l,c]=(0,n.useState)(null!=(t=a.isPublic)&&t),d=(0,y.M)(e=>e.updateWorkspace);return(0,n.useEffect)(()=>{var e;c(null!=(e=a.isPublic)&&e)},[a]),(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"grid gap-2 grid-rows-auto sm:grid-cols-1",children:(0,r.jsx)(N,{title:i("workspace-share.everyone.title","Everyone"),subtitle:i("workspace-share.everyone.subtitle","Allow anyone to access the project, instructions, and files."),checked:l,onChange:e=>{var t;c(e),d(null!=(t=a.workspaceId)?t:"",{isPublic:e}),e&&s("ws_share_public",void 0,{location:"share-form"})}})})})}function N(e){let{title:t,subtitle:a,checked:s,onChange:i}=e,o=(0,n.useId)();return(0,r.jsxs)(l.Zp,{variant:"ghost",className:"rounded-xl p-3 flex gap-1 justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("label",{htmlFor:o,children:t}),(0,r.jsx)("span",{className:"text-secondary",children:a})]}),(0,r.jsx)(w.d,{id:o,checked:s,onCheckedChange:i})]})}function C(e){var t;let{open:a,onOpenChange:s,workspace:n}=e,{t:l}=(0,p.Bd)("workspace"),o=(0,c.KQ)({page:"workspace",workspaceId:null!=(t=n.workspaceId)?t:"",tab:"attachments"},window.location.origin);return(0,r.jsx)(g.R,{open:a,setOpen:s,contentClassName:(0,d.cn)("focus:outline-0 focus-within:outline-0 gap-2","bg-background rounded-3xl","sm:min-w-[340px]","flex flex-col","md:overflow-hidden","px-6 py-6"),titleClassName:"flex justify-between items-center",title:(0,r.jsxs)(r.Fragment,{children:[l("workspace-share.title","Share Project"),(0,r.jsx)(i.$n,{className:"-mt-2 -mr-2",variant:"ghost",size:"icon","aria-label":l("workspace-instructions-close.label","Close"),onClick:()=>s(!1),tabIndex:-1,children:(0,r.jsx)(u.uv5,{size:18,className:"text-secondary"})})]}),footerClassName:"sm:justify-start pt-1",footer:(0,r.jsx)(b,{text:o}),children:(0,r.jsx)(k,{workspace:n})})}let S=(0,n.memo)(e=>{let{workspaceId:t,open:a,onOpenChange:s,onDeleteStarted:n}=e,l=(0,y.M)(e=>e.deleteWorkspace),{t:o}=(0,p.Bd)("workspace");return a?(0,r.jsx)(g.R,{open:a,setOpen:s,contentClassName:(0,d.cn)("focus:outline-0 focus-within:outline-0 gap-2","bg-background rounded-3xl","w-full md:w-5/6 lg:w-3/5 max-w-3xl","flex flex-col","md:overflow-hidden","px-6 py-6"),titleClassName:"flex justify-between",title:(0,r.jsxs)(r.Fragment,{children:[o("workspace-detetion.title","Are you sure?"),(0,r.jsx)(i.$n,{className:"-mt-2 -mr-2",variant:"ghost",size:"icon","aria-label":o("workspace-instructions-close.label","Close"),onClick:()=>s(!1),tabIndex:-1,children:(0,r.jsx)(u.uv5,{size:18,className:"text-secondary"})})]}),description:o("workspace-deletion.description","This action cannot be undone. Project will be lost forever."),footerClassName:"sm:justify-end pt-1 flex flex-col-reverse md:flex-row",footer:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.$n,{onClick:()=>{s(!1)},variant:"ghost",size:"md",className:"text-secondary",children:o("workspace-deletion-cancel.label","Cancel")}),(0,r.jsxs)(i.$n,{onClick:()=>{null==n||n(),t&&l(t)},variant:"outline",size:"md",className:"shadow-none text-primary",children:[(0,r.jsx)(u.lMJ,{className:"size-4 text-fg-danger"}),o("workspace-deletion-confirm.label","Delete project")]})]})}):null});function I(e){let{workspace:t,className:a,iconSize:s,onDeleteStarted:l,onEditStarted:o,children:c,size:m="iconMd"}=e,{ENABLE_WORKSPACE_SHARING:g}=(0,x.h)(),{t:v}=(0,p.Bd)("workspace"),{workspaceId:f}=t,[j,b]=(0,n.useState)(!1),[w,y]=(0,n.useState)(!1),k=(0,n.useCallback)(()=>{setTimeout(()=>{b(!0)},1)},[]),N=(0,n.useCallback)(()=>{setTimeout(()=>{y(!0)},1)},[]),I=(0,d.cn)(a);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(h.rI,{children:[(0,r.jsx)(h.ty,{asChild:!0,children:c||(0,r.jsx)(i.$n,{variant:"ghostSecondary",rounded:!0,size:m,className:I,"aria-label":v("workspace-menu.label","Open menu"),children:(0,r.jsx)(u.gyB,{size:null!=s?s:14})})}),(0,r.jsxs)(h.SQ,{onCloseAutoFocus:e=>e.preventDefault(),side:"bottom",align:"end",sideOffset:6,alignOffset:-5,className:"flex flex-col shadow-sm shadow-black/5 border-border-l1 min-w-40",children:[g&&(0,r.jsxs)(h._2,{onClick:N,children:[(0,r.jsx)(u._HI,{size:16,className:"me-2"}),v("share-workspace-button.label","Share")]}),o&&(0,r.jsxs)(h._2,{onClick:o,children:[(0,r.jsx)(u.w$p,{size:16,className:"me-2"}),v("workspace-menu.rename.label","Rename")]}),(0,r.jsxs)(h._2,{onClick:k,children:[(0,r.jsx)(u.lMJ,{size:16,className:"me-2"}),v("remove-workspace-button.label","Remove")]})]})]}),(0,r.jsx)(S,{workspaceId:f,open:j,onOpenChange:b,onDeleteStarted:l}),(0,r.jsx)(C,{open:w,onOpenChange:y,workspace:t})]})}function _(e){let{workspace:t,onClick:a,className:s}=e,{name:n,icon:h,workspaceId:x}=t,g=(0,o._)(),{t:v}=(0,p.Bd)("workspace"),f=(0,d.cn)("group relative",s);return(0,r.jsxs)("div",{className:f,children:[(0,r.jsx)(c.N_,{route:{page:"workspace",workspaceId:null!=x?x:"",tab:"attachments"},onClick:a,children:(0,r.jsxs)(l.Zp,{className:"flex flex-row items-center @sm:flex-col @sm:items-stretch gap-2 px-5 py-4 pe-12 @sm:pe-5 max-w-4/5 rounded-3xl hover:bg-surface-l1 shadow-none h-full overflow-hidden bg-none bg-transparent",children:[(0,r.jsx)(m.O,{icon:h,className:"size-4"}),(0,r.jsx)("div",{className:"text-sm font-medium truncate",children:n})]})}),(0,r.jsx)(I,{workspace:t,onDeleteStarted:()=>{g("ws_delete_click",void 0,{location:"workspaces"})},children:(0,r.jsx)(i.$n,{variant:"ghostSecondary",className:"visible @sm:invisible @sm:group-hover:visible absolute right-3 top-2 @sm:top-3",rounded:!0,size:"iconXs","aria-label":v("workspace-menu.label","Open menu"),children:(0,r.jsx)(u.gyB,{size:12})})})]})}var P=a(81745),E=a(69358),M=a(82591),T=a(28503),z=a(48175),D=a(80226),A=a(46748),R=a(52371),L=a(72993),O=a(54344),B=a(83638),F=a(7658),K=a(58247),H=a(38614),$=a(19841),U=a(24734);function W(e){var t,a;let{push:s,route:i}=(0,c.wK)(),l=(0,o._)(),{conversation:u,action:p,onActionRequest:m,workspaceId:h}=e,x=null!=(t=u.conversationId)?t:"",[g,v]=(0,n.useState)(!1),[f,j]=(0,n.useState)(null!=(a=u.title)?a:""),[b,w]=(0,n.useState)(!1),[y,k]=(0,n.useState)("");(0,n.useEffect)(()=>{var e;j(null!=(e=u.title)?e:"")},[p]);let{mutate:N,error:C}=(0,F.Fx)(x);(0,U.Y)("list-item:delete",C),(0,n.useEffect)(()=>{C&&w(!1)},[C]);let{mutate:S,error:I}=(0,F.jT)(x);(0,U.Y)("list-item:update",I),(0,n.useEffect)(()=>{I&&k("")},[I]);let _=(0,n.useCallback)(e=>{let t=H.aP.getState();t.setConversationId(e),t.setSidePanelContent(void 0),s({page:"workspace",conversationId:e,workspaceId:h})},[s,h]);if(b)return null;let P=y?{...u,title:y}:u,E="workspace"===i.page&&i.conversationId===x;return(0,r.jsx)("div",{className:(0,d.cn)("h-[48px] rounded-2xl grid grid-cols-1 grid-rows-1 hover:bg-button-ghost-hover",E&&"bg-button-ghost-active"),onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),children:(0,r.jsx)($.w,{isCurrent:!1,isSelected:g,isHovered:g,isDeleting:"delete"===p,isEditing:"edit"===p,newTitle:f,onNewTitleChange:j,conversation:P,className:"p-4 rounded-2xl ",onDeleteStart:()=>m(x,"delete"),onEditStart:()=>m(x,"edit"),onDeleteConfirm:()=>{l("delete_conversation",x,{location:"workspace"}),m(x,null),w(!0),N()},onCancel:()=>m(x,null),onEditSave:()=>{l("update_conversation",x,{location:"workspace"}),m(x,null);let e=f.trim();k(e),S({title:e})},onSelect:_})})}function G(e){let{conversations:t,workspaceId:a}=e,{t:s}=(0,p.Bd)("workspace"),[i,l]=(0,n.useState)(null),[o,c]=(0,n.useState)(null),d=(0,n.useCallback)((e,t)=>{l(t),c(e)},[]);return 0===t.length?(0,r.jsx)(K.S,{icon:(0,r.jsx)(u.AJG,{size:24,strokeWidth:1.5}),title:s("workspace-conversations-list.empty.label","No conversations yet"),subtitle:s("workspace-conversations-list.empty.cta","Start a new conversation in this project by typing in the input box at the top.")}):(0,r.jsx)("div",{children:t.map(e=>{let t=e.conversationId;return(0,r.jsx)(W,{workspaceId:a,conversation:e,action:o===t?i:null,onActionRequest:d},t)})})}function X(e){var t;let{t:a}=(0,p.Bd)("workspace"),{workspace:s}=e,{workspaceId:i}=s,{data:l,isPending:o,isError:c,fetchNextPage:d,hasNextPage:u,isFetchingNextPage:m,refetch:h}=(0,F.fY)(null!=i?i:""),x=(0,n.useCallback)(()=>{u&&!m&&d()},[u,m,d]),g=(0,B.B)(x);if(o)return(0,r.jsx)(Y,{});let v=null!=(t=null==l?void 0:l.pages.flatMap(e=>{var t;return null!=(t=e.conversations)?t:[]}))?t:[];return(0,r.jsxs)(O.D,{fadeSize:"md",className:"py-2",children:[(0,r.jsx)(G,{workspaceId:null!=i?i:"",conversations:v}),u&&!c&&(0,r.jsx)("div",{ref:g,className:"h-10 flex items-center justify-center",children:m?a("workspace-conversations-loading-more","Loading moreâ€¦"):a("workspace-conversations-scroll-to-load","Scroll to load more")}),c&&(0,r.jsx)(V,{onRefetch:h})]})}function V(e){let{onRefetch:t}=e,{t:a}=(0,p.Bd)("workspace");return(0,r.jsxs)(l.Zp,{className:"flex flex-col items-center px-8 py-4",variant:"ghost",children:[a("conversations-loading-error.title","Unable to load conversations"),(0,r.jsx)(i.$n,{variant:"outline",onClick:t,children:a("conversations-loading-error.cta","Retry")})]})}function Y(){return(0,r.jsx)(E.P,{children:(0,r.jsxs)("div",{role:"status","aria-busy":"true",className:"flex flex-col gap-1",children:[(0,r.jsx)(D.E,{className:"w-full h-10"}),(0,r.jsx)(D.E,{className:"w-full h-10"}),(0,r.jsx)(D.E,{className:"w-full h-10"})]})})}var J=a(99667);a(10986),a(34500);var Q=a(41320);function Z(e){var t,a;let{open:s,onOpenChange:l,workspace:o}=e,{t:c}=(0,p.Bd)("workspace"),m=(0,Q.Di)(),h=null!=(t=o.customPersonality)?t:"",x=null!=(a=o.isReadonly)&&a,[v,f]=(0,n.useState)(h);(0,n.useEffect)(()=>{f(h)},[h,s]);let j=(0,n.useId)();return(0,r.jsxs)(g.R,{open:s,setOpen:l,contentClassName:(0,d.cn)("focus:outline-0 focus-within:outline-0 gap-2","bg-background rounded-3xl","w-full md:w-5/6 lg:w-3/5 max-w-[1200px]","flex flex-col","md:overflow-hidden","px-6 py-6"),titleClassName:"flex justify-between text-lg",title:(0,r.jsxs)(r.Fragment,{children:[c("workspace-instructions-modal.title","Project Instructions"),(0,r.jsx)(i.$n,{className:"-mt-2 -mr-2",variant:"ghost",size:"icon","aria-label":c("workspace-instructions-close.label","Close"),onClick:()=>l(!1),tabIndex:-1,children:(0,r.jsx)(u.uv5,{size:18,className:"text-secondary"})})]}),description:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{children:c("workspace-instruction.description","Grok will follow the instructions for all conversations in this project.")}),x&&(0,r.jsx)("span",{children:c("workspace-instruction.description-readonly-note","You don't have permissions to change instructions")})]}),children:[(0,r.jsx)("label",{className:"sr-only",htmlFor:j,children:c("workspace-instruction.title","Custom instructions")}),(0,r.jsx)(J.q,{value:v,onChange:f,isDirty:h!==v,onSave:e=>{var t;f(e);let{updateWorkspace:a}=y.M.getState();a(null!=(t=o.workspaceId)?t:"",{customPersonality:e}),l(!1)},onReset:()=>{f(h),l(!1)},disabled:x,textareaId:j,minRows:10,maxRows:m?15:25})]})}function q(e){let{workspace:t,className:a}=e,{t:s}=(0,p.Bd)("workspace"),l=(0,o._)(),[c,m]=(0,n.useState)(!1),h=(0,d.cn)("group flex flex-col h-auto items-start rounded-2xl text-start p-4 bg-surface-l1 border-l1 dark:hover:bg-surface-l2 hover:bg-surface-l4-hover",a);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.$n,{variant:"outline",className:h,onClick:()=>{m(!0),l("ws_instructions_click",void 0,{location:"section"})},children:[(0,r.jsxs)("div",{className:"flex gap-2 font-bold items-center",children:[(0,r.jsx)(u.W$k,{size:16,className:"text-fg-secondary group-hover:text-fg-primary transition-colors duration-100"}),s("workspace-intruction-button.label","Instructions")]}),(0,r.jsx)("div",{className:"text-fg-secondary w-full truncate",children:t.customPersonality||(0,r.jsx)("span",{className:"italic",children:s("workspace-intruction-button.empty","Set up instructions for Grok in this project")})})]}),(0,r.jsx)(Z,{workspace:t,open:c,onOpenChange:m})]})}let ee=(0,a(17338).F)("inline-flex items-center rounded-full border border-input-border px-2 py-0.5 text-[10px] font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-secondary"}},defaultVariants:{variant:"default"}});function et(e){let{className:t,variant:a,...s}=e;return(0,r.jsx)("div",{className:(0,d.cn)(ee({variant:a}),t),...s})}var ea=a(26676);let es=(0,n.memo)(e=>{var t;let{workspace:a,editing:s,onEditingChange:l,disabled:o}=e,{t:c}=(0,p.Bd)("workspace"),m=(0,n.useRef)(null);!function(e,t){(0,n.useEffect)(()=>{if(!e||!t.current)return;if("none"!==document.body.style.pointerEvents){var a;null==(a=t.current)||a.select();return}let s=setTimeout(()=>{var e;null==(e=t.current)||e.select()},200);return()=>clearTimeout(s)},[e,t])}(s,m);let[h,x]=(0,n.useState)(null!=(t=a.name)?t:"");(0,n.useEffect)(()=>{a.name&&x(a.name)},[a.name]);let g=(0,n.useCallback)(e=>{var t;let{updateWorkspace:s}=y.M.getState();s(null!=(t=a.workspaceId)?t:"",{name:e})},[a.workspaceId]),v=()=>{g(h),l(!1)},f=(0,n.useId)();return o?(0,r.jsx)("h1",{className:(0,d.cn)("ms-1 @sm:ms-2 flex-1 bg-transparent text-2xl focus-visible:outline-none border-b-secondary min-w-0 truncate group","text-md"),children:h}):s?(0,r.jsxs)("form",{className:"flex-1 flex gap-2 justify-between items-center min-w-0",onSubmit:e=>{e.preventDefault(),v()},children:[(0,r.jsx)("div",{"aria-live":"polite",className:"sr-only",children:c("workspace-name-save.announce","Editing project name")}),(0,r.jsx)("input",{"aria-label":c("workspace-name-input.label","Project name"),type:"text",value:h,onChange:e=>{x(e.target.value)},onKeyDown:e=>{if("Escape"===e.key){var t;l(!1),x(null!=(t=a.name)?t:"")}},onBlur:()=>{},className:(0,d.cn)("flex-1 px-1 @sm:px-2 text-2xl focus-visible:outline-none bg-input-background py-1 rounded-xl","text-md font-semibold"),id:f,ref:m,autoFocus:!0}),(0,r.jsx)(i.$n,{variant:"ghostSecondary",size:"iconSm",rounded:!0,"aria-label":c("workspace-name-save.label","Save"),type:"submit",disabled:!h,children:(0,r.jsx)(u.Jlk,{size:16})})]}):(0,r.jsxs)("h1",{role:"button",tabIndex:0,"aria-expanded":"false",onClick:()=>{l(!0)},className:(0,d.cn)("ms-1 @sm:ms-2 flex-1 bg-transparent text-2xl focus-visible:outline-none border-b-secondary min-w-0 truncate group","text-md font-semibold"),children:[h,(0,r.jsx)(u.w$p,{size:16,className:"hidden @sm:inline ms-1 @sm:ms-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 text-fg-secondary"})]})}),en=(0,n.memo)(function(e){let{workspace:t}=e,{t:a}=(0,p.Bd)("workspace"),{push:s}=(0,c.wK)(),l=(0,Q.Di)(),o=(0,y.M)(e=>e.toggleSidePanel),[d,m]=(0,n.useState)(!1),h=(0,n.useCallback)(e=>{var a;let{updateWorkspace:s}=y.M.getState();s(null!=(a=t.workspaceId)?a:"",{icon:e})},[t.workspaceId]);return(0,r.jsx)("div",{className:"flex flex-col @sm:flex-row items-start @sm:items-center gap-6 @sm:gap-2 w-full",children:(0,r.jsxs)("div",{className:"flex-1 flex items-center justify-start min-w-0 w-full",children:[(0,r.jsx)(ea.n,{icon:t.icon,onChange:h,disabled:t.isReadonly,sizeClass:"w-4",buttonSize:"iconSm"}),(0,r.jsx)(es,{workspace:t,editing:d,onEditingChange:m,disabled:t.isReadonly}),d||(0,r.jsxs)(r.Fragment,{children:[t.isReadonly?(0,r.jsx)(et,{variant:"outline",children:a("workspace.readOnly","Read-only")}):(0,r.jsx)(I,{workspace:t,className:"ms-1 @sm:ms-2",iconSize:16,size:"iconSm",onDeleteStarted:()=>{s({page:"workspaces"})},onEditStarted:()=>{m(!0)}}),!l&&(0,r.jsx)(i.$n,{variant:"ghost",size:"iconSm",rounded:!0,"aria-label":a("projects-sidepanel-collapse-button.label","Collapse side panel"),onClick:()=>{o(!1)},children:(0,r.jsx)(u.KD8,{size:18,className:"text-fg-secondary"})})]})]})})});var er=a(10678),ei=a(60575);a(68332);var el=a(17703),eo=a(44347),ec=a(74995),ed=a(52553),eu=a(92437);function ep(e){let{onDrop:t,className:a}=e,{t:s}=(0,p.Bd)("workspace"),i=(0,o._)(),{attachFiles:l}=(0,ed.S)(),c=(0,n.useRef)(null),d=(0,n.useCallback)(e=>{null==t||t(),l(e),e.forEach(e=>{i("upload_file",e.name,{location:"workspace-query-file-drop",mimeType:e.type})})},[l,t,i]),u=(0,eu.t)({ref:c,onDrop:d});return(0,r.jsx)(eu.u,{ref:c,dragState:u,title:s("workspace-query-dropzone.title","Attach to message"),subtitle:s("workspace-query-dropzone.description","Drop here to add files to your message"),className:a})}function em(e){let{workspaceId:t}=e,a=(0,o._)(),{t:s}=(0,p.Bd)("chat"),{push:i}=(0,c.wK)(),l=function(){let e=(0,o._)();return t=>e("create_workspace_convo",t,{location:"workspace-query-bar:useLogCreation"})}(),{mutate:d,error:u}=(0,F.tX)({onSuccess:l});(0,U.Y)("workspace",u);let m=(0,n.useCallback)(e=>{d({conversationId:e.conversationId,workspaceId:t}),a("ws_start_convo","",{location:"workspace-main:onCreateConversationSuccess"}),i({page:"workspace",workspaceId:t,conversationId:e.conversationId})},[d,a,i,t]),h=function(e,t){let a=(0,H.aP)(ec.A("establishNewConversation")),s=(0,eo.C$)(ec.A("isIncognito")),r=(0,x.h)();return(0,n.useCallback)(async n=>{let i,{query:l,fileAttachmentIds:o,webpageUrls:c,toolOverrides:d,isPreset:u}=n;if(!l)return!1;r.WORKSPACE_AGENT&&(i={agenticWorkspace:{workspaceId:e}});let p=await a({message:l,fileAttachmentIds:o,webpageUrls:c,toolOverrides:d,temporary:s,isPreset:u,persona:void 0,enableRetries:r.ENABLE_AUTO_STREAM_RETRY,workspaceIds:[e],responseMetadata:i,ff:r}).catch(e=>{(0,el.vV)("workspace:establishNewConversation",e)});return!!p&&(t(p),!0)},[r,s,a,e,t])}(t,m);return(0,r.jsx)(ei.s,{className:"",textAreaClassName:"min-h-14 pt-5 my-0 mb-5",placeholder:s("workspace-query-placeholder","Start a conversation in this project"),onQuery:h,isIncognito:!1,onFrontPage:!1,expandable:!1},"query-bar")}function eh(e){let{workspace:t}=e,{workspaceId:a,isReadonly:s}=t,{t:n}=(0,p.Bd)("chat"),{route:i,replace:l}=(0,c.wK)(),o=(0,Q.Di)(),d="workspace"===i.page&&i.tab||"conversations",u=()=>{l({page:"workspace",workspaceId:a,tab:"attachments"})};return(0,r.jsxs)("div",{className:"py-3 px-3 @container h-full flex flex-col relative max-h-[100vh]",children:[(0,r.jsx)(en,{workspace:t}),(0,r.jsx)(q,{workspace:t,className:"my-2 w-full"}),(0,r.jsxs)(R.tU,{value:d,className:"flex-1 overflow-hidden flex flex-col relative pt-1 h-full",children:[(0,r.jsxs)(R.j7,{className:"place-self-start !bg-transparent bg-none border-none",children:[(0,r.jsx)(R.Xi,{variant:"underline",value:"attachments",asChild:!0,children:(0,r.jsx)(c.N_,{route:{page:"workspace",workspaceId:a,tab:"attachments"},children:n("workspace-tab.attachments","Attachments")})}),(0,r.jsx)(R.Xi,{variant:"underline",value:"conversations",children:(0,r.jsx)(c.N_,{route:{page:"workspace",workspaceId:a,tab:"conversations"},children:n("workspace-tab.conversations","Conversations")})})]}),(0,r.jsx)(R.av,{value:"conversations",className:"overflow-auto",children:(0,r.jsx)(X,{workspace:t})}),(0,r.jsx)(R.av,{value:"attachments",className:"overflow-hidden flex-1",children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)(L.n,{workspace:t}),(0,r.jsx)(L.C,{workspaceId:a,onFileAddStarted:u,isReadonly:s,className:"mt-1"})]})})]}),o&&(0,r.jsx)(em,{workspaceId:a}),(0,r.jsx)(er.h,{workspaceId:a,onDrop:u,disabled:s})]})}var ex=a(61214),eg=a(63209),ev=a(35181),ef=a(48992),ej=a(49972),eb=a(43893);function ew(e){let{onClick:t,workspace:a}=e;return(0,r.jsxs)("button",{className:(0,d.cn)("border border-border-l2 px-3 py-1 rounded-full","text-sm text-secondary flex flex-row items-center gap-1"),onClick:t,children:[(0,r.jsx)(m.O,{icon:a.icon,className:(0,d.cn)("[&>svg]:h-3.5 [&>svg]:w-3.5")}),(0,r.jsx)("span",{className:(0,d.cn)("max-w-[0px] @[340px]:max-w-[70px] @[375px]:max-w-[100px] @[430px]:max-w-[150px] @[500px]:max-w-[200px] truncate"),children:a.name})]})}function ey(e){let{workspace:t}=e,a=(0,Q.Di)(),{route:s,push:i}=(0,c.wK)(),l="workspace"===s.page&&s.conversationId||null,o=(0,ej.w)(e=>e.fetchGetConversation),{data:d,isLoading:u,error:p}=(0,ev.v)(l?o(l):void 0);(0,n.useEffect)(()=>{let e=eb.A3.getState();(null==d?void 0:d.conversationId)&&(H.aP.getState().setConversationId(null==d?void 0:d.conversationId),e.loadInitialResponses(null==d?void 0:d.conversationId).then(e=>{var t;let a=H.aP.getState();if(d.conversationId===(null==(t=e[0])?void 0:t.conversationId)){let t=(0,ef.Mb)(e);if(!t)return void a.setLastMessageId(void 0);if("streaming"===t.state||"reconnecting"===t.state){a.setLastMessageId(t.parentResponseId),a.setStreamedMessageId(t.responseId);return}if("optimistic"===t.state){a.setLastMessageId(t.parentResponseId),a.setOptimisticMessageId(t.responseId);return}a.setLastMessageId(t.responseId)}}))},[d]);let m=t.workspaceId;return l||d?(0,r.jsxs)("div",{className:"relative h-full flex-1",children:[(0,r.jsx)(eg.hx,{hideIncognito:!0,conversation:d,conversationIsLoading:u,extraLeftContent:a&&(0,r.jsx)(ew,{workspace:t,onClick:()=>{i({page:"workspace",workspaceId:m,conversationId:null})}})}),(0,r.jsx)(ex.T,{conversationId:null!=l?l:"",conversation:d,isOptimisticConversation:!1,conversationIsLoading:u,conversationError:p,hideFollowUps:!0}),(0,r.jsx)(ep,{className:"z-50 m-2"})]}):(0,r.jsxs)("div",{className:"relative h-full flex-1",children:[(0,r.jsxs)("div",{className:"flex flex-col justify-between h-full",children:[(0,r.jsx)("div",{className:"flex-1 flex flex-col justify-center items-center"}),(0,r.jsx)("div",{className:"flex flex-col justify-end  pb-4 px-5",children:(0,r.jsx)(em,{workspaceId:m})})]}),(0,r.jsx)(ep,{className:"z-50 m-2"})]})}function ek(e){let{workspaceId:t}=e,{t:a}=(0,p.Bd)("chat"),{route:l}=(0,c.wK)(),o=(0,Q.Di)(),h=(0,y.M)(e=>e.loadWorkspace),x=(0,y.M)(e=>e.byId[t]),g=null==x?void 0:x.data;(0,A.r)(null==g?void 0:g.name),(0,n.useEffect)(()=>{x||h(t)},[x,h,t]);let[,f]=function(){let[e,t]=(0,s.Mj)("recent-workspaces",[]);return[e,(0,n.useCallback)(e=>{t(t=>t[0]===e?t:[e,...t.filter(t=>t!==e)].slice(0,4))},[t])]}();(0,n.useEffect)(()=>{(null==g?void 0:g.workspaceId)&&f(null==g?void 0:g.workspaceId)},[g]);let j=(0,y.M)(e=>e.sidePanelExpanded),b=(0,y.M)(e=>e.toggleSidePanel);if(!x||(null==x?void 0:x.status)==="loading")return(0,r.jsxs)(E.P,{children:[(0,r.jsxs)("div",{className:"gap-4 flex flex-row w-full p-4",children:[(0,r.jsxs)("div",{className:"w-[300px] flex flex-col gap-4",children:[(0,r.jsx)(D.E,{className:"h-10 w-full"}),(0,r.jsx)(D.E,{className:"h-20 w-full"})]}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col gap-4",children:[(0,r.jsx)(D.E,{className:"h-10 w-full"}),(0,r.jsx)(D.E,{className:"h-20 w-full"})]})]}),(0,r.jsx)(P.CommandMenu,{})]});if((null==x?void 0:x.error)||!g)return(0,r.jsxs)("div",{className:"h-dvh w-full flex flex-col content-center",children:[(0,r.jsx)(T.J,{title:a("workspace-error.title","Error"),description:a("workspace-error.description","There was an issue finding ID {{workspaceId}}",{workspaceId:t}),cta:a("workspace-error.cta","Go Home")}),(0,r.jsx)(P.CommandMenu,{})]});if(o){let e="workspace"===l.page&&l.conversationId;return(0,r.jsxs)(M.t,{fallbackRender:()=>(0,r.jsx)(T.J,{title:a("workspace-error.title","Error"),description:a("workspace-unexpected-error.description","Something went wrong"),cta:a("workspace-error.cta","Go Home")}),children:[(0,r.jsx)("div",{className:"w-full flex-1 h-dvh",children:e?(0,r.jsx)("div",{className:"w-full h-full flex ",children:(0,r.jsx)(ey,{workspace:g})}):(0,r.jsxs)("div",{className:"flex-1 flex flex-col h-full",children:[(0,r.jsx)("div",{className:"mt-3 ms-1",children:(0,r.jsx)(eg.n9,{})}),(0,r.jsx)(eh,{workspace:g})]})}),(0,r.jsx)(P.CommandMenu,{})]})}return(0,r.jsxs)(M.t,{fallbackRender:()=>(0,r.jsx)(T.J,{title:a("workspace-error.title","Error"),description:a("workspace-unexpected-error.description","Something went wrong"),cta:a("workspace-error.cta","Go Home")}),children:[(0,r.jsxs)(z.K,{collapsed:!j,onCollapsedChange:e=>b(!e),sideContent:(0,r.jsx)(eh,{workspace:g}),autoSaveId:"files-page-layout",style:{height:"100vh"},direction:"horizontal",className:"w-full h-[100vh] overflow-hidden",tagName:"main",children:[!j&&(0,r.jsxs)(v.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.2},className:(0,d.cn)("absolute start-3 top-3 z-50 flex gap-1"),children:[(0,r.jsx)(i.$n,{variant:"ghostSecondary",size:"iconSm",rounded:!0,"aria-label":a("projects-sidepanel-collapse-button.label","Expand side panel"),onClick:()=>b(!0),children:(0,r.jsx)(u.KD8,{className:"",size:18})}),(0,r.jsxs)("button",{className:(0,d.cn)("border border-border-l2 px-3 py-1 rounded-full","text-sm text-secondary flex flex-row items-center gap-1"),onClick:()=>b(!0),children:[(0,r.jsx)(m.O,{icon:g.icon,className:(0,d.cn)("[&>svg]:h-3.5 [&>svg]:w-3.5")}),(0,r.jsx)("span",{className:(0,d.cn)("max-w-[0px] @[340px]:max-w-[75px] @[375px]:max-w-[100px] @[430px]:max-w-[150px] @[500px]:max-w-[200px] truncate"),children:g.name})]})]}),(0,r.jsx)(ey,{workspace:g})]}),(0,r.jsx)(P.CommandMenu,{})]})}var eN=a(33231),eC=a(5663);function eS(e){let{workspaceId:t}=e,a=(0,o._)(),{push:s}=(0,c.wK)();return(0,eN.v)(eC.Ib,e=>{e.preventDefault(),e.stopPropagation(),s({page:"main"}),a("pressed_cmd_j",void 0,{location:"workspace-page-content:useHotkeys"})},[a,s]),(0,r.jsx)(ek,{workspaceId:t})}var eI=a(3209);function e_(e){let{variant:t,onClick:a,className:s}=e,l=(0,x.h)(),{t:o}=(0,p.Bd)("workspace"),c=(0,y.M)(ec.A("setCreateDialogIsOpen")),{add:m,isPending:h}=(0,eI.O)(),g=(0,n.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),null==a||a(),l.ENABLE_PROJECT_CREATOR?c(!0):m().catch((0,el.HX)("app-sidebar:create-workspace"))},[l.ENABLE_PROJECT_CREATOR,a,c,m]),v="square"===t,f=(0,d.cn)(s);return(0,r.jsxs)(i.$n,{variant:"outline",size:v?"iconMd":"md",className:f,onClick:g,"aria-busy":h,"aria-label":h?o("add-workspace-button.pending","Creating project"):o("add-workspace-button.description","Add new project"),children:[h?(0,r.jsx)(u.wmz,{className:"animate-spin",size:16,"aria-hidden":!0}):(0,r.jsx)(u.FWt,{size:16,"aria-hidden":!0}),(0,r.jsx)("span",{className:"hidden sm:block",children:v||o("add-workspace-button.label","Add")})]})}function eP(e){let{children:t,className:a}=e;return(0,r.jsxs)("div",{className:(0,d.cn)("h-dvh w-full relative selection:bg-highlight",a),children:[(0,r.jsx)(eg.hx,{hideIncognito:!0}),(0,r.jsx)("div",{className:"max-w-[50rem] px-2 pt-16 @sm:pt-18 mx-auto w-full flex-col h-full relative items-center",children:t}),(0,r.jsx)(P.CommandMenu,{})]})}function eE(e){let{className:t}=e,a=(0,o._)(),{t:s}=(0,p.Bd)("workspace"),i=(0,y._)(),c=(0,y.M)(e=>e.loadFirstPage),m=(0,y.M)(e=>e.listPageToken);(0,n.useEffect)(()=>{0===i.length&&c()},[c,i.length]);let h=(0,y.M)(e=>e.listStatus),x=(0,y.M)(e=>e.loadNextPage),g=(0,n.useCallback)(()=>{m&&"loading"!==h&&x()},[m,h,x]),v=(0,B.B)(g);if("loading"===h&&0===i.length)return(0,r.jsx)(eT,{});if("error"===h)return(0,r.jsx)(eM,{onRetry:c});let f=(0,d.cn)("pb-8",t);if(0===i.length)return(0,r.jsxs)(l.Zp,{variant:"ghost",className:"p-6 flex flex-col items-center",children:[(0,r.jsx)(u.XRf,{size:16,className:"text-secondary"}),(0,r.jsx)("div",{children:s("workspace-list-empty.title","No projects yet")}),(0,r.jsx)("div",{className:"text-secondary",children:s("workspace-list-empty.subtitle","Create a new project")})]});let j=()=>{a("ws_nav_click",void 0,{location:"workspaces"})};return(0,r.jsxs)("div",{"data-testid":"workspaces-list",className:f,children:[(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:i.map(e=>(0,r.jsx)(_,{workspace:e,onClick:j},e.workspaceId))}),m&&(0,r.jsx)("div",{ref:v,className:"text-center mt-8",children:"loading"===h?s("workspaces-loading.label","Loading moreâ€¦"):s("workspaces-scrollto.label","Scroll to load more")})]})}function eM(e){let{onRetry:t}=e,{t:a}=(0,p.Bd)("workspace");return(0,r.jsxs)(l.Zp,{variant:"ghost",className:"p-8 flex flex-col gap-4 items-center text-center",children:[(0,r.jsx)(u.lW3,{className:"size-4"}),a("workspaces-error.description","An issue occurred when loading your projects"),(0,r.jsx)(i.$n,{variant:"outline",className:"shadow-none",onClick:t,children:a("workspaces-error.cta","Try again")})]})}function eT(){return(0,r.jsx)(E.P,{children:(0,r.jsxs)("div",{className:"flex flex-col @sm:flex-row gap-3",children:[(0,r.jsx)(ez,{}),(0,r.jsx)(ez,{}),(0,r.jsx)(ez,{})]})})}function ez(){return(0,r.jsxs)(l.Zp,{variant:"ghost",className:"flex-1 rounded-xl p-4 flex @sm:flex-col items-center  @sm:items-start gap-4",children:[(0,r.jsx)(D.E,{className:"bg-surface-l1 w-8 h-8 rounded-full"}),(0,r.jsx)(D.E,{className:"bg-surface-l1 w-32 h-4"})]})}function eD(){let e=(0,o._)(),{t}=(0,p.Bd)("workspace");return(0,A.r)(t("workspaces-page-title","Projects")),(0,r.jsx)(eP,{children:(0,r.jsxs)("main",{className:"w-full h-full flex flex-col",children:[(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"flex justify-between align-center my-6 min-h-[42px]",children:[(0,r.jsx)("h1",{className:"text-2xl flex gap-2 items-center font-semibold",children:t("workspaces-page.title","Projects")}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(e_,{onClick:()=>{e("ws_create_click",void 0,{location:"workspaces"})}})})]})}),(0,r.jsx)(O.D,{children:(0,r.jsx)(eE,{})})]})})}},35692:(e,t,a)=>{a.d(t,{x:()=>r});var s=a(79342),n=a(61312);function r(e){let{className:t,variant:a="reg"}=e;return(0,s.jsx)("div",{className:(0,n.cn)("h-2 w-2 rounded-full bg-blue-400",{"h-1.5 w-1.5":"sm"===a},t)})}},41284:(e,t,a)=>{a.d(t,{e:()=>d});var s=a(79342),n=a(61312),r=a(61389),i=a(88382);let l=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,s.jsx)(r.bL,{ref:t,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full border border-border hover:opacity-75 transition-[opacity,width,height] duration-150",a),...i})});l.displayName=r.bL.displayName;let o=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,s.jsx)(r._V,{ref:t,className:(0,n.cn)("aspect-square h-full w-full",a),...i})});o.displayName=r._V.displayName;let c=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,s.jsx)(r.H4,{ref:t,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full",a),...i})});c.displayName=r.H4.displayName;let d=e=>{let{className:t,textClassName:a,user:r}=e,d=(0,i.useMemo)(()=>[null==r?void 0:r.givenName,null==r?void 0:r.familyName].map(e=>null==e?void 0:e[0]).join("").substring(0,2),[r]);return(0,s.jsxs)(l,{className:t,children:[(0,s.jsx)(o,{src:null==r?void 0:r.profileImageUrl,alt:"pfp"}),(0,s.jsx)(c,{className:(0,n.cn)("bg-surface-l4 text-fg-primary shadow-sm dark:shadow-none border-border-l1",a),children:d})]})}},44566:(e,t,a)=>{a.d(t,{x:()=>l});var s=a(23232),n=a(70526),r=a(65146),i=a(14908);function l(e){let{t}=(0,r.Bd)("workspace"),a=(0,s._)();return()=>{i.oR.error(t("files-limit-error","Max number of files allowed is {{maxNumberOfFiles}}",{maxNumberOfFiles:n.aD})),a("workspace_file_limit_exceeded",e,{location:"workspace-page-content:assets-section:useMaxFilesError",maxFiles:n.aD.toString(10)})}}},46748:(e,t,a)=>{a.d(t,{r:()=>r});var s=a(88382),n=a(65146);function r(e){let{t}=(0,n.Bd)("base");(0,s.useEffect)(()=>{document.title=e?t("browser-page-title",{defaultValue:"{{pageTitle}} - Grok",pageTitle:e}):"Grok"},[e,t])}},48175:(e,t,a)=>{a.d(t,{K:()=>l});var s=a(79342),n=a(61312),r=a(88382),i=a(91631);function l(e){let{collapsed:t,onCollapsedChange:a,sideContent:l,children:c,...d}=e,u=(0,r.useRef)(null),[p,m]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let e=u.current;if(e){if(t&&e.isExpanded()){e.collapse(),m(!0);let t=setTimeout(()=>{m(!1)},300);return()=>clearTimeout(t)}else if(!t&&e.isCollapsed()){e.expand(),m(!0);let t=setTimeout(()=>{m(!1)},300);return()=>clearTimeout(t)}}},[t]),(0,s.jsxs)(i.YZ,{...d,children:[(0,s.jsx)(i.Zk,{minSize:20,defaultSize:20,order:0,collapsible:!0,ref:u,onCollapse:()=>a(!0),onExpand:()=>a(!1),className:(0,n.cn)(p?"transition-all duration-300":""),children:l}),(0,s.jsx)(o,{collapsed:t}),(0,s.jsx)(i.Zk,{order:1,minSize:0,defaultSize:100,className:"relative",children:c})]})}function o(e){let{collapsed:t}=e;return(0,s.jsx)(i.TW,{"data-collapsed":t,className:(0,n.cn)("border-l data-[collapsed=true]:border-l-0","border-border-l1","data-[resize-handle-state=hover]:border-border-l2 z-50")})}},51789:(e,t,a)=>{a.d(t,{q:()=>ec,C:()=>eh});var s=a(79342),n=a(61884),r=a(38614),i=a(63209),l=a(1826),o=a(20269),c=a(80354),d=a(84969),u=a(33846),p=a(88382);let m=(0,p.createContext)({collapsed:!1,setCollapsed:e=>{}}),h=()=>(0,p.useContext)(m);function x(e){let{trigger:t,content:a,hasContent:n,onClick:r}=e,{open:i}=(0,o.cL)(),[h,x]=(0,p.useState)(!1);(0,p.useEffect)(()=>{x(!1)},[n]);let g=p.cloneElement(t,{onClick:e=>{r&&r(),e.stopPropagation()}}),v=(0,p.useCallback)(()=>{x(!0)},[]);return(0,s.jsxs)(m.Provider,{value:{collapsed:h,setCollapsed:x},children:[!i&&(0,s.jsxs)(l.AM,{children:[g,(0,s.jsx)(l.hl,{className:"p-1.5 rounded-2xl flex flex-col gap-0.5 w-60 z-[50]",side:"right",align:"start",hoverOpen:!0,sideOffset:3,closeOnClick:!0,onClick:c.Y,children:a})]}),i&&g,(0,s.jsx)(d.N,{children:i&&!h&&n&&(0,s.jsx)(u.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.1,ease:"easeInOut"},style:{overflow:"hidden"},children:(0,s.jsx)(o.G,{onClickIndent:v,children:a})},"drawer-content")})]})}var g=a(72055),v=a(56691),f=a(4295),j=a(61312);function b(e){let{Icon:t}=e,{open:a}=(0,o.cL)(),{collapsed:n,setCollapsed:r}=h(),i=(0,f.c)(),l=(0,p.useCallback)(e=>{e.stopPropagation(),e.preventDefault(),a?r(!n):r(!1)},[a,n,r]);return a?(0,s.jsxs)(v.$n,{variant:"ghost",size:"iconXs",rounded:!0,onClick:l,"aria-label":"Toggle Menu",children:[(0,s.jsx)(t,{className:(0,j.cn)("group-hover/menu-item:hidden",i&&"hidden"),size:18}),(0,s.jsx)(g.vKP,{className:(0,j.cn)("hidden group-hover/menu-item:block transition-[transform] duration-100",i&&"block",!n&&"rotate-90"),size:14})]}):(0,s.jsx)(t,{size:18})}var w=a(41320),y=a(84499);function k(e){let{icon:t,text:a,tooltip:n,route:r,onClick:i,children:c,action:d,canPopover:m,highlighted:h,className:x}=e,{open:g,setOpen:v}=(0,o.cL)(),f=(0,w.Di)(),b=(0,p.useCallback)(e=>{e.stopPropagation(),null==i||i(e),r&&f&&v(!1)},[i,f,v,r]),k=r?(0,s.jsxs)(y.N_,{className:(0,j.cn)("w-full flex flex-row gap-1",o.jy,"text-sm text-primary",h?"bg-button-ghost-hover":"border-transparent",x),route:r,onClick:b,children:[(0,s.jsx)(o.CP,{children:t}),g&&(0,s.jsx)(u.P.span,{initial:{opacity:1},exit:{opacity:0},transition:{duration:.1,ease:"easeInOut"},children:a}),c]}):(0,s.jsxs)("div",{role:"button",tabIndex:0,"aria-label":a,className:(0,j.cn)("w-full flex flex-row justify-start gap-1 bg-background text-primary text-sm rounded-xl",o.jy,h?"bg-button-ghost-hover":"border-transparent",x),onClick:i,children:[(0,s.jsx)(o.CP,{children:t}),g&&(0,s.jsx)(u.P.span,{initial:{opacity:1},exit:{opacity:0},transition:{duration:.1,ease:"easeInOut"},children:a}),c]}),N=!g&&m?(0,s.jsx)(l.Wv,{asChild:!0,hoverOpen:!0,tabIndex:-1,children:k}):k;return(0,s.jsxs)(o.FX,{className:"relative",children:[(0,s.jsx)(o.Uj,{tooltip:n,safeArea:!0,asChild:!0,children:N}),g&&d&&(0,s.jsx)("span",{className:"absolute top-1/2 right-1.5 -translate-y-1/2",children:d})]})}var N=a(65258);class C{constructor(e,t){this.set=e,this.get=t,this.setCurrentAction=(0,N.kp)(this.set,"currentAction")}}let S=(0,N.y$)(C,"useAppSidebarStore");var I=a(92207),_=a(72712);let P=e=>(0,s.jsx)(_.I,{...e,children:(0,s.jsx)("path",{d:"M4 20L8.5 15.5M14 20L4 10L5 9L9.06551 8.32242C10.2858 8.11904 11.3433 7.36248 11.9298 6.27324L13.2256 3.86676C13.8608 2.68717 15.4534 2.45342 16.4007 3.40075L20.5993 7.59926C21.5466 8.54658 21.3128 10.1392 20.1332 10.7744L17.7268 12.0702C16.6375 12.6567 15.881 13.7142 15.6776 14.9345L15 19L14 20Z",stroke:"currentColor",strokeLinecap:"square"})});var E=a(12001),M=a(42557),T=a(35692),z=a(73772),D=a(3209),A=a(26676),R=a(75500),L=a(91102),O=a(12065),B=a(35181),F=a(24734),K=a(2280),H=a(27636),$=a(17703),U=a(40873),W=a(13027),G=a(49972),X=a(87891),V=a(73304),Y=a(23232),J=a(44347),Q=a(3683),Z=a(28205),q=a(80864),ee=a(51234),et=a(21185),ea=a(84810),es=a(38541),en=a.n(es),er=a(74995),ei=a(65146),el=a(51182),eo=a(48795);function ec(){let{t:e}=(0,ei.Bd)("base"),{open:t,setOpen:a,toggleSidebar:n}=(0,o.cL)(),l=(0,R.h)(),m=(0,Y._)(),h=!!(0,M.wV)().user,{handleNavigateToVoiceMode:f}=(0,eo.F)({location:"app-sidebar"}),{commandPrefix:N}=(0,L.c)(),C=N?"".concat(N,"K"):"",S=N?"".concat(N,"J"):"",_=(0,w.Di)();(0,p.useEffect)(()=>{_&&a(!1)},[_]);let E=(0,J.C$)(er.A("isIncognito")),T=(0,r.aP)(e=>e.conversationMode),z=(0,G.w)(e=>e.fetchListConversations);(0,B.v)(z()),(0,B.v)(z({filterIsStarred:!0}));let A=(0,G.w)(e=>e.byId),O=(0,p.useMemo)(()=>Object.values(A).map(e=>e.conversationId),[A]),F=(0,G.w)(e=>e.fetchGetManyConversations),H=(0,p.useMemo)(()=>F(O),[O]),{data:W}=(0,B.v)(H,{preserveValue:!0}),V=(0,p.useMemo)(()=>{if(!W)return[];let e=W.filter(e=>!e.temporary).filter(e=>0===e.workspaces.length).filter(e=>!e.taskResultId);return en().sortBy(e,e=>-new Date(e.modifyTime).getTime())},[W]),{sortedBuckets:es,bucketedConversations:ec,pinnedConversations:eu}=(0,p.useMemo)(()=>{let e=V.filter(e=>e.starred),t=en().groupBy(V,e=>{let t=e.modifyTime;return e.starred?"Pinned":(0,Z.c)(t)?"Today":(0,q.P)(t)?"Yesterday":(0,ee.x)(t)?"This Week":(0,et.e)(t)?(0,ea.GP)(t,"MMMM"):(0,ea.GP)(t,"yyyy")}),a={Pinned:0,Today:1,Yesterday:2,"This Week":3,"This Month":4},s=Object.keys(t),n=s.filter(e=>e in a);n.sort((e,t)=>a[e]-a[t]);let r=s.filter(e=>!(e in a)),i=[...n,...en().sortBy(r,e=>{var a,s;return-new Date(null==(s=t[e])||null==(a=s[0])?void 0:a.modifyTime).getTime()})],l=10,o=i.reduce((e,a)=>{var s,n,r;if(l<=0)return e;let i=null!=(n=null==(s=t[a])?void 0:s.length)?n:0;return i&&("Pinned"!==a&&(l-=i),l<=0?e[a]=null==(r=t[a])?void 0:r.slice(0,i+l):e[a]=t[a]),e},{}),c={};return Object.keys(o).forEach(e=>{let t=o[e],a=en().orderBy(t,[e=>new Date(e.modifyTime).getTime()],["desc"]);c[e]=a}),{sortedBuckets:i,bucketedConversations:c,pinnedConversations:e}},[V]),{push:ex}=(0,y.wK)(),eg=(0,Q.M)(e=>e.loadFirstPage);(0,p.useEffect)(()=>{eg().catch((0,$.HX)("app-sidebar:load-workspaces"))},[eg]);let ev=(0,Q.M)((0,el.k)(e=>e.list.map(t=>{var a;return null==(a=e.byId[t])?void 0:a.data}).filter(U.O))),{route:ef}=(0,y.wK)(),ej=(0,p.useCallback)(e=>{let{setOptimisticConversationId:t,setConversationId:a,setSidePanelContent:s,exitVoiceMode:n}=r.aP.getState();if("chat"===ef.page&&(t(void 0),a(void 0),s(void 0)),"voice"===T)return n("navigation")},[ef.page,T]),eb=(0,p.useCallback)(async e=>{if(("chat"!==ef.page||ef.conversationId)&&"main"!==ef.page||"voice"!==T)return _&&a(!1),f()},[ef,f,_,a,T]),ew=(0,r.aP)(e=>e.conversationId),ey=(0,G.w)(e=>{var t;return!!ew&&(null==(t=e.byId[ew])?void 0:t.temporary)}),ek=(0,p.useMemo)(()=>"chat"===ef.page||"files"===ef.page?{page:"main"}:{page:"chat",conversationId:null!=ew?ew:null,temporary:ey},[ew,ey,ef.page]),eN=(0,p.useCallback)(()=>{let{setSidePanelContent:e}=r.aP.getState();e(void 0)},[]),eC=(0,p.useRef)(null),eS=(0,K.tg)({ref:eC}),eI=(0,Q.M)(er.A("setCreateDialogIsOpen")),{add:e_}=(0,D.O)(),eP=(0,p.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),l.ENABLE_PROJECT_CREATOR?eI(!0):e_().catch((0,$.HX)("app-sidebar:create-workspace"))},[l.ENABLE_PROJECT_CREATOR,eI,e_]),eE=(0,p.useCallback)(e=>{if(_&&a(!1),(0,c.Y)(e),"voice"===T){let{exitVoiceMode:e}=r.aP.getState();return e("navigation")}},[T,_,a]),eM=(0,p.useCallback)(()=>a(!0),[a]),[eT,ez]=(0,p.useState)(null);(0,p.useEffect)(()=>{if("files"===ef.page){var e;ez(null!=(e=ef.fileId)?e:null)}},[ef]);let eD=(0,X.R)(e=>{var t,a,s;if(!eT||"files"===ef.page&&ef.fileId)return null;let n=e.currentVersion[eT];return null!=(s=null==(a=e.assetsById[n])||null==(t=a.data)?void 0:t.assetId)?s:null});return(0,s.jsxs)(o.Bx,{className:(0,j.cn)("z-20 bg-surface-base border-r border-border-l1",t?"cursor-w-resize":"cursor-e-resize"),collapsible:_?"offcanvas":"icon",variant:_?"floating":"sidebar",onClick:n,children:[(0,s.jsx)(o.Gh,{className:(0,j.cn)("h-header-height flex flex-row justify-between items-center gap-0 shrink-0",o.y$),children:(0,s.jsx)(i.C9,{alwaysSmall:!0,className:"relative z-10 block w-fit p-1 mx-0.5 shrink-0 hover:bg-button-ghost-hover rounded-xl",onClick:eE})}),(0,s.jsxs)(o.Yv,{ref:eC,className:(0,j.cn)("relative overflow-x-hidden",t&&"scrollbar-gutter-stable-single"),style:{...eS},children:[(0,s.jsx)(o.Cn,{className:"h-subheader-height flex justify-center py-1",children:(0,s.jsxs)(o.Uj,{"aria-label":e("sidebar-search","Search"),className:(0,j.cn)(t&&"flex-1","ps-[10px] pe-[10px]","rounded-full border border-border-l1","bg-surface-l1 justify-start","text-primary",o.b,o.hV),onClick:e=>{e.preventDefault(),e.stopPropagation(),I.H0.getState().openMenu(),m("opened_command_menu",void 0,{location:"app-sidebar:search"})},children:[(0,s.jsx)(g.WIv,{size:18}),(0,s.jsx)(d.N,{children:t&&(0,s.jsxs)(u.P.span,{className:"space-x-1 align-baseline",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1,easing:"easeInOut"},children:[(0,s.jsx)("span",{children:e("sidebar-search","Search")}),!_&&(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:C})]})})]})}),(0,s.jsx)(o.Cn,{children:(0,s.jsx)(o.wZ,{children:(0,s.jsx)(k,{icon:(0,s.jsx)(g.cJ,{size:18}),text:e("sidebar-chat-nav","Chat"),route:ek,onClick:ej,tooltip:e("sidebar-chat-nav","Chat"),action:(0,s.jsx)("span",{className:"text-xs text-primary ms-auto opacity-0 group-hover/menu-item:opacity-100 transition-opacity duration-100",children:S}),highlighted:("chat"===ef.page&&!ef.conversationId||"main"===ef.page)&&"chat"===T})})}),l.ENABLE_VOICE_MODE&&!E&&(0,s.jsx)(o.Cn,{children:(0,s.jsx)(o.wZ,{children:(0,s.jsx)(k,{icon:(0,s.jsx)(g.b7X,{size:18}),text:e("sidebar-voice-nav","Voice"),onClick:eb,tooltip:e("sidebar-voice-nav","Voice"),highlighted:("chat"===ef.page&&!ef.conversationId||"main"===ef.page)&&"voice"===T,className:"cursor-pointer hover:text-primary hover:!bg-button-ghost-hover"})})}),(0,s.jsx)(o.Cn,{children:(0,s.jsx)(o.wZ,{children:(0,s.jsx)(k,{icon:(0,s.jsx)(g.pyG,{size:18}),text:e("sidebar-files-nav","Files"),route:{page:"files",fileId:eD},onClick:eN,tooltip:e("sidebar-files-nav","Files"),highlighted:"files"===ef.page})})}),l.ENABLE_GROK_TASKS&&h&&(0,s.jsx)(o.Cn,{className:(0,j.cn)(""),children:(0,s.jsx)(o.wZ,{children:(0,s.jsx)(ed,{open:t,highlighted:"tasks"===ef.page})})}),l.ENABLE_IMAGE_TAB&&(0,s.jsx)(o.Cn,{children:(0,s.jsx)(o.wZ,{children:(0,s.jsx)(k,{icon:(0,s.jsx)(g.xfq,{size:18}),text:e("sidebar-images-nav","Images"),route:{page:"images",tab:"explore"},tooltip:e("sidebar-images-nav","Images"),highlighted:"images"===ef.page})})}),(0,s.jsx)(o.Cn,{className:(0,j.cn)(""),children:(0,s.jsx)(o.wZ,{children:(0,s.jsx)(x,{trigger:(0,s.jsx)(k,{icon:(null==ev?void 0:ev.length)?(0,s.jsx)(b,{Icon:g.XRf}):(0,s.jsx)(g.XRf,{size:18}),action:(0,s.jsx)(v.$n,{className:"ms-auto opacity-0 group-hover/menu-item:opacity-100 transition-opacity duration-100",variant:"ghostSecondary",size:"iconXs",rounded:!0,onClick:eP,"aria-label":e("sidebar-create-workspace-button.label","Create new project"),children:(0,s.jsx)(g.FWt,{size:14})}),text:e("sidebar-workspaces-nav","Projects"),route:{page:"workspaces"},canPopover:!0,highlighted:"workspaces"===ef.page}),hasContent:!!(null==ev?void 0:ev.length),content:(0,s.jsxs)(s.Fragment,{children:[!t&&(0,s.jsxs)("div",{className:"w-full flex justify-between items-center gap-1 pl-3 pr-1.5 py-1 text-sm text-primary font-semibold sticky top-0",children:[(0,s.jsx)("div",{className:(0,j.cn)(""),children:e("sidebar-workspaces-nav","Projects")}),(0,s.jsx)(v.$n,{variant:"ghostSecondary",size:"iconXs",rounded:!0,onClick:eP,"aria-label":e("Create Project","Create Project"),children:(0,s.jsx)(g.FWt,{size:14})})]}),!t&&!(null==ev?void 0:ev.length)&&(0,s.jsx)(eh,{content:e("No projects yet","No projects yet"),ctaText:e("Create Project","Create Project"),onClickCta:eP},"no-workspaces"),!!(null==ev?void 0:ev.length)&&ev.slice(0,5).map(e=>(0,s.jsx)(em,{workspaceId:e.workspaceId,showActions:t},e.workspaceId)),ev.length>0&&(0,s.jsx)(v.$n,{tabIndex:-1,variant:"textSecondary",size:"none",className:"w-full justify-start px-3 text-xs font-semibold no-wrap pb-2 mt-1",onClick:()=>{ex({page:"workspaces"}),m("opened_command_menu",void 0,{location:"app-sidebar:recent-chats"})},children:e("See all","See all")})]}),collapsible:!0})})}),l.USE_SEPARATE_PINNED_SECTION_IN_SIDEBAR&&eu.length>0&&(0,s.jsx)(o.Cn,{children:(0,s.jsx)(o.wZ,{children:(0,s.jsx)(x,{hasContent:!!eu.length,trigger:(0,s.jsx)(k,{icon:eu.length?(0,s.jsx)(b,{Icon:P}):(0,s.jsx)(P,{size:18}),text:e("Pinned","Pinned"),canPopover:!0}),content:(0,s.jsxs)(s.Fragment,{children:[!t&&(0,s.jsx)("div",{className:(0,j.cn)("py-1 pl-3 text-sm text-primary font-semibold sticky top-0"),children:e("Pinned","Pinned")}),!t&&0===eu.length&&(0,s.jsx)(eh,{content:e("No pinned chats","No pinned chats")},"no-recent-chats"),eu.length>0&&eu.map(e=>(0,s.jsx)(ep,{conversation:e,showActions:t},e.conversationId))]}),onClick:t?void 0:eM,collapsible:!0})})}),(0,s.jsx)(o.Cn,{className:(0,j.cn)(""),children:(0,s.jsx)(o.wZ,{children:(0,s.jsx)(x,{hasContent:!!es.length,trigger:(0,s.jsx)(k,{icon:(null==es?void 0:es.length)?(0,s.jsx)(b,{Icon:g.HGu}):(0,s.jsx)(g.HGu,{size:18}),text:e("History","History"),canPopover:!0}),content:(0,s.jsxs)(s.Fragment,{children:[!t&&(0,s.jsx)("div",{className:(0,j.cn)("py-1 pl-3 text-sm text-primary font-semibold sticky top-0"),children:e("History","History")}),!t&&0===es.length&&(0,s.jsx)(eh,{content:e("No chats","No chats")},"no-recent-chats"),es.length>0&&es.map(e=>{if(l.USE_SEPARATE_PINNED_SECTION_IN_SIDEBAR&&"Pinned"===e)return null;let a=ec[e]||[];return 0===a.length?null:(0,s.jsxs)(p.Fragment,{children:[(0,s.jsx)("div",{className:(0,j.cn)("py-1 pl-3 text-xs text-fg-primary sticky top-0 z-20 text-nowrap"),children:e}),a.map(e=>(0,s.jsx)(ep,{conversation:e,showActions:t},e.conversationId))]},e)}),es.length>0&&(0,s.jsx)(v.$n,{tabIndex:-1,variant:"textSecondary",size:"none",className:"w-full justify-start px-3 text-xs font-semibold no-wrap pb-2 mt-1",onClick:()=>{I.H0.getState().openMenu(),m("opened_command_menu",void 0,{location:"app-sidebar:recent-chats"})},children:e("See all","See all")})]}),collapsible:!0,onClick:t?void 0:eM})})})]}),(0,s.jsxs)(o.CG,{className:(0,j.cn)("relative shrink-0",t?"h-[56px]":"h-[96px]"),children:[(0,s.jsx)("div",{className:(0,j.cn)("absolute bottom-3",o.vd),style:{transform:t?"translateY(0)":"translateY(-44px)",transitionProperty:"transform",transitionDuration:"300ms"},children:(0,s.jsx)(i.IO,{})}),(0,s.jsx)(o.x2,{className:(0,j.cn)("absolute end-2 bottom-3"),iconSize:18})]})]})}function ed(e){var t,a;let{open:n,highlighted:r}=e,{t:i}=(0,ei.Bd)("base"),l=(0,R.h)(),o=(0,V.d)(er.A("setCreateDialogIsOpen")),c=(0,Y._)(),{push:d}=(0,y.wK)(),{getUserTasksQuery:m}=(0,H.y$)({fetchActive:!0}),{data:h}=m,f=(0,p.useMemo)(()=>{var e,t;return null!=(t=null==h||null==(e=h.unreadResults)?void 0:e.filter(e=>!e.isRead&&e.status===W.cn.TaskResultSuccess).slice(0,3))?t:[]},[null==h?void 0:h.unreadResults]),w=(null==h||null==(a=h.unreadResults)||null==(t=a.at(0))?void 0:t.isRead)===!1&&h.unreadResults.length>0,N=(0,p.useCallback)(()=>{c("clicked_add_new_task",void 0,{location:"tasks-nav-button"}),o(!0)},[o,c]);return(0,s.jsx)(x,{collapsible:!0,trigger:(0,s.jsx)(k,{icon:f.length&&l.SHOW_SIDEBAR_TASK_CHATS?(0,s.jsx)(b,{Icon:g.HEW}):(0,s.jsx)(g.HEW,{size:18}),text:i("sidebar-tasks-label","Tasks"),route:{page:"tasks",taskId:null,tab:null},action:(0,s.jsx)(v.$n,{className:"ms-auto opacity-0 group-hover/menu-item:opacity-100 transition-opacity duration-100",variant:"ghostSecondary",size:"iconXs",rounded:!0,onClick:N,"aria-label":i("create-task","Create task"),children:(0,s.jsx)(g.FWt,{size:14})}),canPopover:!0,highlighted:r,children:w&&(0,s.jsx)(u.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.2},children:(0,s.jsx)(T.x,{variant:"sm",className:(0,j.cn)("absolute",n?"top-[50%] -translate-y-1/2":"right-[6px] top-[6px]")})})}),hasContent:f.length>0&&l.SHOW_SIDEBAR_TASK_CHATS,content:(0,s.jsxs)(s.Fragment,{children:[!n&&(0,s.jsxs)("div",{className:"w-full flex justify-between items-center gap-1 pl-3 pr-1.5 py-1 text-sm text-primary font-semibold sticky top-0",children:[(0,s.jsx)("div",{className:(0,j.cn)(""),children:i("sidebar-tasks-nav","Tasks")}),(0,s.jsx)(v.$n,{variant:"ghostSecondary",size:"iconXs",rounded:!0,onClick:N,"aria-label":i("create-task","Create task"),children:(0,s.jsx)(g.FWt,{size:14})})]}),!n&&!(null==f?void 0:f.length)&&(0,s.jsx)(eh,{content:i("No unread task results","No unread task results")},"no-workspaces"),(0,s.jsx)("div",{className:"w-full flex flex-col gap-1",children:(null==f?void 0:f.length)>0&&f.map(e=>(0,s.jsx)(eu,{taskResult:e},e.taskResultId))}),n&&(null==h?void 0:h.tasks)&&h.tasks.length>0&&(0,s.jsx)(v.$n,{tabIndex:-1,variant:"textSecondary",size:"none",className:"w-full justify-start px-3 text-xs font-semibold no-wrap pb-2 mt-1",onClick:()=>{d({page:"tasks",taskId:null,tab:null})},children:i("See all","See all")})]})})}function eu(e){var t;let{taskResult:a}=e,{t:r}=(0,ei.Bd)("base"),i=(0,Y._)(),l=(0,p.useCallback)(()=>{i("clicked_task_result",void 0,{location:"tasks-nav-button"})},[i]),d=(0,w.Di)(),{setOpen:u}=(0,o.cL)(),m=(0,p.useCallback)(e=>{d&&u(!1),(0,c.Y)(e)},[d,u]),h=(0,p.useMemo)(()=>a.title?a.title:a.createTime?r("Task result on date","Task result on {{date}}",{date:new Date(a.createTime).toLocaleDateString()}):r("New task result","New task result"),[a.createTime,a.title,r]);return(0,s.jsx)(o.Uj,{asChild:!0,heightClassName:o.Zr,onClick:l,children:(0,s.jsxs)(n.m_,{children:[(0,s.jsx)(n.k$,{asChild:!0,children:(0,s.jsxs)(y.N_,{className:(0,j.cn)("group/task-item pl-3 pr-4 py-1 text-sm","w-full flex  gap-3 text-fg-primary"),route:{page:"chat",conversationId:null!=(t=a.conversationId)?t:null,temporary:!1},onClick:m,children:[(0,s.jsx)("span",{className:(0,j.cn)("flex-1 select-none text-nowrap max-w-full overflow-hidden inline-block"),style:{maskImage:K.uU,WebkitMaskImage:K.uU},children:h}),(0,s.jsx)(T.x,{variant:"sm"})]})}),(0,s.jsx)(n.ZI,{side:"right",sideOffset:8,children:h})]})})}function ep(e){let{conversation:t,showActions:a=!0}=e,{t:i}=(0,ei.Bd)("base"),l=(0,Y._)(),{handlePinConversation:m}=(0,O.c)(),h=(0,F.K)(),x=(0,p.useMemo)(()=>t.title?t.title:t.createTime?i("Chat on date","Chat on {{date}}",{date:new Date(t.createTime).toLocaleDateString()}):i("Untitled Chat","Untitled Chat"),[t.createTime,t.title,i]),[f,b]=(0,p.useState)(x),k=S(e=>e.currentAction),N=(null==k?void 0:k.type)==="edit-conversation"&&k.conversationId===t.conversationId,C=(0,p.useCallback)(()=>{let{setCurrentAction:e}=S.getState();e(void 0)},[]),I=(0,p.useCallback)((e,t,a)=>{let{fetchUpdateConversation:s}=G.w.getState();s(e,{title:t,starred:a}).catch(e=>{h("app-sidebar:handleUpdateConversation",e)})},[h]),{route:_,push:M}=(0,y.wK)(),T=(0,r.aP)(er.A("conversationId")),D="chat"===_.page&&T===t.conversationId,A=(0,p.useCallback)(()=>{let{fetchSoftDeleteConversation:e}=G.w.getState();e(t.conversationId).catch(e=>{h("app-sidebar:handleDeleteConversation",e)}),D&&M({page:"main"})},[t.conversationId,h,D,M]),R=(0,p.useCallback)(()=>{let{setCurrentAction:e}=S.getState();e({type:"edit-conversation",conversationId:t.conversationId}),X(!1)},[t.conversationId]),L=(0,p.useCallback)(e=>{e.stopPropagation(),e.preventDefault(),("click"===e.type||e instanceof KeyboardEvent&&"Enter"===e.key)&&I(t.conversationId,f.trim(),t.starred);let{setCurrentAction:a}=S.getState();a(void 0),l("update_conversation_name",t.conversationId,{location:"app-sidebar"})},[I,t.conversationId,f,t.starred,l]),B=(0,p.useCallback)(e=>{e.stopPropagation(),e.preventDefault(),b(e.target.value)},[]),H=(0,p.useCallback)(e=>{if("Enter"===e.key){let{setCurrentAction:e}=S.getState();I(t.conversationId,f.trim(),t.starred),e(void 0),l("update_conversation_name",t.conversationId,{location:"app-sidebar"})}else"Escape"===e.key&&C()},[C,I,t.conversationId,f,t.starred,l]),$=(0,p.useCallback)(e=>{e.stopPropagation(),e.preventDefault(),C()},[C]),U=(0,p.useCallback)(()=>{m(t.conversationId,!t.starred,"app-sidebar")},[t.conversationId,t.starred,m]),[W,X]=(0,p.useState)(!1),V=(0,w.Di)(),{setOpen:J}=(0,o.cL)(),Q=(0,p.useCallback)(e=>{V&&J(!1),(0,c.Y)(e)},[V,J]),Z=(0,p.useCallback)(e=>{e.stopPropagation(),e.preventDefault()},[]),q=(0,p.useCallback)(e=>{N&&(e.stopPropagation(),e.preventDefault())},[N]),ee=(0,p.useCallback)(e=>{e.stopPropagation(),e.preventDefault(),C()},[C]);return(0,s.jsx)(d.N,{children:(0,s.jsx)(u.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:(0,s.jsx)(o.Uj,{asChild:!0,highlighted:D,allowActive:!N,heightClassName:o.Zr,children:(0,s.jsxs)(n.m_,{children:[(0,s.jsx)(n.k$,{asChild:!0,children:(0,s.jsxs)(y.N_,{className:(0,j.cn)("group/conversation-item pl-3 pr-1.5 py-1 text-sm","w-full flex flex-row gap-2 text-primary"),route:{page:"chat",conversationId:t.conversationId,temporary:t.temporary},onClick:Q,onDragStart:q,children:[N?(0,s.jsx)("input",{className:"w-full bg-transparent focus-visible:outline-none",value:f,onKeyDown:H,onChange:B,onClick:Z,onBlur:ee,autoFocus:!0}):(0,s.jsx)("span",{className:(0,j.cn)("flex-1 select-none text-nowrap max-w-full overflow-hidden inline-block"),style:{maskImage:K.uU,WebkitMaskImage:K.uU},children:x}),a&&(N?(0,s.jsxs)("div",{className:(0,j.cn)("flex","items-center justify-end gap-0.5"),children:[(0,s.jsx)(v.gx,{variant:"ghost",size:"iconXs",rounded:!0,onClick:$,tooltipContent:i("Cancel","Cancel"),tooltipContentProps:{hideWhenDetached:!0},children:(0,s.jsx)(g.uv5,{size:14,className:"text-fg-primary"})}),(0,s.jsx)(v.gx,{variant:"ghost",size:"iconXs",rounded:!0,onClick:L,tooltipContent:i("Save","Save"),tooltipContentProps:{hideWhenDetached:!0},children:(0,s.jsx)(g.Srz,{size:14,className:"text-fg-primary"})})]}):(0,s.jsxs)(z.rI,{onOpenChange:X,children:[(0,s.jsx)(z.ty,{asChild:!0,children:(0,s.jsx)(v.$n,{variant:"ghost",size:"iconXs",className:(0,j.cn)("hidden group-hover/conversation-item:flex text-fg-secondary",W&&"flex"),rounded:!0,children:(0,s.jsx)(g.YbC,{size:14})})}),(0,s.jsxs)(z.SQ,{side:"right",align:"start",sideOffset:6,alignOffset:-8,className:"min-w-36 space-y-0.5",onClick:c.Y,children:[(0,s.jsxs)(z._2,{className:(0,j.cn)("text-fg-secondary"),onClick:R,children:[(0,s.jsx)(g.rZj,{size:16,className:"me-2"}),i("Rename","Rename")]}),(0,s.jsxs)(z._2,{className:(0,j.cn)("text-fg-secondary"),onClick:U,children:[t.starred?(0,s.jsx)(E.A,{size:16,className:"me-2"}):(0,s.jsx)(P,{size:16,className:"me-2"}),t.starred?i("Unpin","Unpin"):i("Pin","Pin")]}),(0,s.jsxs)(z._2,{className:(0,j.cn)("text-fg-secondary"),onClick:A,children:[(0,s.jsx)(g.ucK,{size:16,className:"me-2"}),i("Delete","Delete")]})]})]}))]})}),!N&&!W&&(0,s.jsx)(n.ZI,{side:"right",sideOffset:8,children:x})]})})},t.conversationId)})}function em(e){let{workspaceId:t,showActions:a=!0}=e,{route:n,push:r}=(0,y.wK)(),{t:i}=(0,ei.Bd)("base"),l=(0,Y._)(),d=(0,Q.M)(e=>{var a;return null==(a=e.byId[t])?void 0:a.data}),[u,m]=(0,p.useState)((null==d?void 0:d.name)||"");(0,p.useEffect)(()=>{var e;m(null!=(e=null==d?void 0:d.name)?e:"")},[null==d?void 0:d.name]);let h=S(e=>e.currentAction),x=(null==h?void 0:h.type)==="edit-workspace"&&h.workspaceId===t,f="workspace"===n.page&&n.workspaceId===t,b=(0,p.useCallback)(()=>{let{setCurrentAction:e}=S.getState();e(void 0);let a=u.trim();if(""===a)return;l("update_workspace_name",t,{location:"app-sidebar"});let{updateWorkspace:s}=Q.M.getState();s(t,{name:a})},[u,l,t]),k=(0,p.useCallback)(()=>{let{setCurrentAction:e}=S.getState();e(void 0)},[]),N=(0,p.useCallback)(()=>{let{setCurrentAction:e}=S.getState();e({type:"edit-workspace",workspaceId:t}),D(!1)},[t]),C=(0,p.useCallback)(e=>{e.stopPropagation(),e.preventDefault(),("click"===e.type||e instanceof KeyboardEvent&&"Enter"===e.key)&&b()},[b]),I=(0,p.useCallback)(e=>{e.stopPropagation(),e.preventDefault(),m(e.target.value)},[]),_=(0,p.useCallback)(e=>{"Enter"===e.key?b():"Escape"===e.key&&k()},[k,b]),P=(0,p.useCallback)(e=>{e.stopPropagation(),e.preventDefault(),k()},[k]),E=(0,p.useCallback)(e=>{let{updateWorkspace:a}=Q.M.getState();a(t,{icon:e})},[t]),M=(0,p.useCallback)(()=>{t&&(Q.M.getState().deleteWorkspace(t),"workspace"===n.page&&n.workspaceId===t&&r({page:"workspaces"}))},[t,n,r]),[T,D]=(0,p.useState)(!1),R=(0,w.Di)(),{setOpen:L}=(0,o.cL)(),O=(0,p.useCallback)(e=>{R&&L(!1),(0,c.Y)(e)},[R,L]),B=(0,p.useCallback)(e=>{e.stopPropagation(),e.preventDefault()},[]),F=(0,p.useCallback)(e=>{x&&(e.stopPropagation(),e.preventDefault())},[x]),H=(0,p.useCallback)(e=>{e.stopPropagation(),e.preventDefault(),k()},[k]);return(0,s.jsx)(o.Uj,{asChild:!0,highlighted:f,allowActive:!x,heightClassName:o.Zr,children:(0,s.jsxs)(y.N_,{className:(0,j.cn)("group/conversation-item pl-2 pr-1.5 py-1 text-sm","w-full flex flex-row !gap-1 text-primary"),route:{page:"workspace",workspaceId:t,tab:"conversations"},onClick:O,onDragStart:F,children:[(0,s.jsx)("div",{onClick:e=>{e.preventDefault(),e.stopPropagation()},children:(0,s.jsx)(A.n,{icon:null==d?void 0:d.icon,sizeClass:"size-4",onChange:E,rounded:!0,buttonSize:"iconXs",disabled:!a})}),x?(0,s.jsx)("input",{className:"w-full bg-transparent focus-visible:outline-none",value:u,onKeyDown:_,onChange:I,onClick:B,onBlur:H,autoFocus:!0}):(0,s.jsx)("span",{className:(0,j.cn)("flex-1 select-none text-nowrap max-w-full overflow-hidden inline-block"),style:{maskImage:K.uU,WebkitMaskImage:K.uU},children:u}),a&&(x?(0,s.jsxs)("div",{className:(0,j.cn)("flex","items-center justify-end gap-0.5"),children:[(0,s.jsx)(v.gx,{variant:"ghost",size:"iconXs",rounded:!0,onClick:P,tooltipContent:i("Cancel","Cancel"),tooltipContentProps:{hideWhenDetached:!0},children:(0,s.jsx)(g.uv5,{size:14,className:"text-fg-primary"})}),(0,s.jsx)(v.gx,{variant:"ghost",size:"iconXs",rounded:!0,onClick:C,tooltipContent:i("Save","Save"),tooltipContentProps:{hideWhenDetached:!0},children:(0,s.jsx)(g.Srz,{size:14,className:"text-fg-primary"})})]}):(0,s.jsxs)(z.rI,{onOpenChange:D,children:[(0,s.jsx)(z.ty,{asChild:!0,children:(0,s.jsx)(v.$n,{variant:"ghost",size:"iconXs",rounded:!0,"aria-label":i("sidebar-workspace-menu-open.label","Show project menu"),className:(0,j.cn)("hidden group-hover/conversation-item:flex",T&&"flex"),children:(0,s.jsx)(g.YbC,{size:14})})}),(0,s.jsxs)(z.SQ,{side:"right",align:"start",sideOffset:6,alignOffset:-8,className:"min-w-36 space-y-0.5",onClick:c.Y,children:[(0,s.jsxs)(z._2,{className:(0,j.cn)("text-fg-secondary"),onClick:N,children:[(0,s.jsx)(g.rZj,{size:16,className:"me-2"}),i("Rename","Rename")]}),(0,s.jsxs)(z._2,{className:(0,j.cn)("text-fg-secondary"),onClick:M,children:[(0,s.jsx)(g.ucK,{size:14,className:"me-2"}),i("Delete","Delete")]})]})]}))]})})}function eh(e){let{content:t,ctaText:a,onClickCta:n}=e;return(0,s.jsxs)("div",{className:(0,j.cn)("h-[140px] flex flex-col gap-2 items-center justify-center","-mt-8"),children:[(0,s.jsx)("span",{className:"text-xs text-primary",children:t}),a&&n&&(0,s.jsx)(v.$n,{variant:"outline",size:"sm",className:"rounded-xl",onClick:n,children:a})]})}},54344:(e,t,a)=>{a.d(t,{D:()=>r});var s=a(79342),n=a(61312);function r(e){let{children:t,className:a="",fadeSize:r="sm",role:i}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex-1 flex flex-col gap-1 h-full overflow-y-auto py-1",{sm:"[mask-image:linear-gradient(to_bottom,transparent,black_4px,black_calc(100%_-_4px),transparent)] [-webkit-mask-image:linear-gradient(to_bottom,transparent,black_4px,black_calc(100%_-_4px),transparent)]",md:"[mask-image:linear-gradient(to_bottom,transparent,black_8px,black_calc(100%_-_8px),transparent)] [-webkit-mask-image:linear-gradient(to_bottom,transparent,black_8px,black_calc(100%_-_8px),transparent)]",lg:"[mask-image:linear-gradient(to_bottom,transparent,black_16px,black_calc(100%_-_16px),transparent)] [-webkit-mask-image:linear-gradient(to_bottom,transparent,black_16px,black_calc(100%_-_16px),transparent)]"}[r],a),tabIndex:-1,role:i,children:t})}},58247:(e,t,a)=>{a.d(t,{S:()=>i});var s=a(79342),n=a(39729),r=a(61312);function i(e){let{icon:t,title:a,subtitle:i,className:l}=e,o=(0,r.cn)("flex-1 flex flex-col items-center justify-center p-4 gap-4 mb-4",l);return(0,s.jsxs)(n.Zp,{variant:"ghost",className:o,children:[(0,s.jsx)("div",{className:"bg-surface-l1 flex flex-col items-center rounded-full p-4",children:(0,s.jsx)("span",{className:"text-fg-tertiary",children:t})}),(0,s.jsxs)("div",{className:"flex flex-col gap-1 items-center text-center",children:[(0,s.jsx)("h3",{className:"font-semibold text-lg",children:a}),(0,s.jsx)("span",{className:"text-secondary max-w-md",children:i})]})]})}},58655:(e,t,a)=>{a.d(t,{C:()=>m});var s=a(79342),n=a(41320),r=a(61312),i=a(65146),l=a(24994),o=a(74366),c=a(26067),d=a(72055);function u(e){let{locale:t,onChange:a}=e,{t:n}=(0,i.Bd)();return(0,s.jsxs)(o.uB,{children:[(0,s.jsx)(o.G7,{placeholder:n("Search language","Search language")}),(0,s.jsx)(o.oI,{children:c.O4.map(e=>(0,s.jsx)(p,{locale:e,selected:t===e,onSelect:a},e))})]})}function p(e){let{locale:t,selected:a,onSelect:n}=e,{name:r,nativeName:i}=c.IB[t];return(0,s.jsxs)(o.h_,{value:t,keywords:[i,r],onSelect:()=>n(t),className:"justify-between cursor-pointer",children:[i,a?(0,s.jsx)(d.Srz,{className:"size-4","data-testid":"check-icon"}):(0,s.jsx)("span",{className:"text-muted-foreground",children:r})]})}function m(e){let{open:t,onOpenChange:a,locale:o,onLocaleChange:c}=e,{t:d}=(0,i.Bd)(),p=(0,n.Di)(),m=(0,r.cn)("bg-background rounded-2xl outline-none h-[calc(100dvh-64px-128px)] w-full md:w-[400px] max-w-3xl flex flex-col md:h-[min(500px,90dvh)]",{"rounded-b-none":p});return(0,s.jsx)(l.R,{open:t,setOpen:a,contentClassName:m,"aria-labelledby":"language-selector-title",titleClassName:"sr-only",title:d("Language Selector","Language Selector"),children:(0,s.jsx)(u,{locale:o,onChange:c})})}},63209:(e,t,a)=>{a.d(t,{IO:()=>ej,hx:()=>ef,C9:()=>ek,n9:()=>ey});var s=a(79342),n=a(10953),r=a(42557),i=a(41284),l=a(56691),o=a(51789),c=a(92207),d=a(39489),u=a(72055),p=a(12001),m=a(72712);let h=e=>(0,s.jsxs)(m.I,{viewBox:"2 2 21 21",...e,children:[(0,s.jsx)("path",{d:"M3 5L19 5",stroke:"currentColor",strokeLinecap:"square",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M3 12H7",stroke:"currentColor",strokeLinecap:"square",strokeLinejoin:"round"}),(0,s.jsx)("circle",{cx:"16",cy:"15",r:"4",stroke:"currentColor"}),(0,s.jsx)("path",{d:"M19 18L21 20",stroke:"currentColor",strokeLinecap:"square"}),(0,s.jsx)("path",{d:"M3 19H7",stroke:"currentColor",strokeLinecap:"square",strokeLinejoin:"round"})]});var x=a(58655),g=a(18585),v=a(67153),f=a(92618),j=a(5790),b=a(35692),w=a(88119),y=a(34500),k=a(73772),N=a(47127),C=a(20269),S=a(3209),I=a(26676),_=a(5663),P=a(68332),E=a(21782),M=a(75500),T=a(33231),z=a(23232),D=a(41320),A=a(91102),R=a(2376),L=a(12065),O=a(35181),B=a(24734),F=a(2280),K=a(24429),H=a(27636),$=a(7658),U=a(83626),W=a(17703),G=a(84499),X=a(61312),V=a(97196),Y=a(49972),J=a(93436),Q=a(44347),Z=a(58711),q=a(3683),ee=a(17014),et=a(33846),ea=a(32171),es=a.n(ea),en=a(39116),er=a(74995),ei=a(88382),el=a(65146),eo=a(17517),ec=a(14908),ed=a(38614),eu=a(23856),ep=a(35228);let em=(0,ei.memo)(e=>{let{conversation:t}=e,a=(0,z._)(),{conversationId:n}=t,{data:r,error:i}=(0,$.$1)(n);(0,B.Y)("conversation-workspace-pill",i);let l=null==r?void 0:r[0];if(!l)return null;let{name:o,icon:c,workspaceId:d}=l;return(0,s.jsx)(es(),{className:"overflow-hidden",href:"/workspace/".concat(d),onClick:()=>{a("ws_pill_click",void 0,{location:"conversation-workspace-pill:handleClick"})},children:(0,s.jsxs)(et.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.2},className:(0,X.cn)("border border-border-l2 px-3 py-1 rounded-full","text-sm text-secondary flex flex-row items-center gap-1","ml-2 mt-0.5"),children:[(0,s.jsx)("span",{className:(0,X.cn)("[&>svg]:h-3.5 [&>svg]:w-3.5"),children:(0,s.jsx)(ep.Oh,{icon:c})}),(0,s.jsx)("span",{className:(0,X.cn)("max-w-[0px] @[340px]/nav:max-w-[75px] @[375px]/nav:max-w-[100px] @[430px]/nav:max-w-[150px] @[500px]/nav:max-w-[200px] truncate"),children:o})]})})}),eh={size:20,strokeWidth:2};function ex(e){let{hash:t,isIncognito:a,showLabel:n,onLinkClick:r}=e,{t:i}=(0,el.Bd)("chat"),{commandPrefix:o}=(0,A.c)(),c=a?i("Switch to Default Chat","Switch to Default Chat"):i("Switch to Private Chat","Switch to Private Chat"),d=a?"".concat(o,"J"):"".concat(o,"â‡§J");return(0,s.jsx)(l.gx,{rounded:!0,variant:"ghost",size:n?"md":"iconMd",overideIconStyle:!0,"aria-label":c,stayOpenOnClick:!0,tooltipAsChild:!0,tooltipContent:(0,s.jsxs)("div",{className:"flex flex-row gap-1",children:[c,o&&(0,s.jsx)("span",{className:"text-secondary",children:d})]}),tooltipContentProps:{side:"bottom"},asChild:!0,className:a?"text-purple-400 dark:text-purple-300":"text-secondary",children:(0,s.jsxs)(es(),{href:"/chat".concat(a?"":t),onClick:r,children:[a?(0,s.jsx)(u.fz0,{...eh,"data-testid":"pi-ghost-fill"}):(0,s.jsx)(u.FEr,{...eh,"data-testid":"pi-ghost"}),n&&(0,s.jsx)("span",{className:"font-semibold",children:i("private","Private")})]})})}var eg=a(5851);let ev="#private";function ef(e){var t;let{title:a,conversationIsLoading:n,conversation:i,label:o,shared:d,isOptimisticConversation:m,hideIncognito:x,showTasks:f,extraLeftContent:j}=e,{t:w}=(0,el.Bd)("base"),{routeToConversation:y}=(0,P.o)(),[C,S]=(0,eo.Q)(),I=(0,r.wV)(),E=I.user,{push:O}=(0,G.wK)(),{commandPrefix:F,os:K}=(0,A.c)(),U=(0,z._)(),V=(0,ei.useRef)(null),J=(0,ed.aP)(er.A("setReasoningMode")),Z=(0,ed.aP)(er.A("establishNewConversation")),q=(0,ed.aP)(er.A("conversationMode")),ee=(0,Q.C$)(er.A("isIncognito")),et=(0,Q.C$)(er.A("setIsIncognito")),{handlePinConversation:ea}=(0,L.c)(),{fetchDeleteConversation:es}=(0,Y.w)(),en=(0,B.K)(),ec=(0,D.Di)(),ep=(0,M.h)(),em=(0,v.L)(),eh=(0,ed.aP)(er.A("lastMessageId"));(0,ei.useEffect)(()=>{C===ev&&(et(!0),S(""))},[C]);let{data:eg}=(0,$.$1)(null!=(t=null==i?void 0:i.conversationId)?t:""),ef=null==eg?void 0:eg[0],eb=null==ef?void 0:ef.workspaceId,ew=(0,ei.useCallback)(()=>{U("new_chat_action",void 0,{location:"chat-top-nav:pivotNewChat",insideWorkspace:"false"});let{setOptimisticConversationId:e,setSidePanelContent:t}=ed.aP.getState();e(void 0),t(void 0),et(!1),y(void 0)},[U,et,y]),ek=(0,ei.useCallback)(e=>{e.ctrlKey||e.metaKey||ew()},[ew]);(0,T.v)(_.Ib,e=>{e.preventDefault(),e.stopPropagation(),U("pressed_cmd_j",void 0,{location:"chat-top-nav:useHotkeys",insideWorkspace:String(!!ef)}),ew()},[ew,U]);let eN=(0,ei.useCallback)(()=>{et(!0),y(void 0)},[et,y]),eI=!!I.user&&!x;(0,T.v)(_.Xo,e=>{eI&&(e.preventDefault(),e.stopPropagation(),U("pressed_cmd_shift_j",void 0,{location:"chat-top-nav:useHotkeys"}),eN())},[eI,eN,U]);let e_=(0,ei.useCallback)(e=>{if(!e.ctrlKey&&!e.metaKey){e.preventDefault();let t=!ee;et(t),U("toggle_incognito",String(t),{location:"chat-top-nav"})}},[ee,et,U]),eP=(0,c.H0)(er.A("openMenu")),eE=m?ee:i?!!E&&i.temporary:ee,{getPersonaForConversation:eM}=(0,R.v5)(),eT=eM(i),ez=(0,ei.useCallback)(()=>{U("clicked_tasks",void 0,{location:"chat-top-nav"}),O({page:"tasks",taskId:null,tab:"active"})},[O,U]),eD=(0,ei.useCallback)(async()=>{if(!eT)return;J("none");let{initialQuery:e,toolOverrides:t}=(0,g.pL)(eT.personaId,w);U("click_persona",eT.personaId,{location:"chat-top-nav"}),U("new_persona_chat",e,{location:"chat-top-nav",toolOverrides:JSON.stringify(t)}),await em(),await Z({message:e,toolOverrides:t,persona:eT,enableRetries:ep.ENABLE_AUTO_STREAM_RETRY,ff:ep}).catch((0,W.HX)("chat-top-nav:establishNewConversation"))},[eT,J,w,U,em,Z,ep]),eA=(0,ei.useCallback)(()=>{i&&ea(i.conversationId,!i.starred,"chat-top-nav")},[i,ea]),eR=(0,ei.useCallback)(()=>{i&&es(i.conversationId).then(()=>{O({page:"main"})}).catch(e=>en("chat-top-nav:handleDeleteClick",e))},[i,es,O,en]),eL=function(){var e,t;let{getUserTasksQuery:a}=(0,H.y$)({fetchActive:!0}),{data:s}=a;return(null==s||null==(t=s.unreadResults)||null==(e=t.at(0))?void 0:e.isRead)===!1&&s.unreadResults.length>0}(),eO=ep.ENABLE_EXPANDED_SHARE_BUTTON&&!ec,[eB,eF]=(0,ei.useState)(!1);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{ref:V,className:(0,X.cn)("w-full relative @container/nav z-[25] flex-shrink-0","print:hidden"),children:[a&&(0,s.jsx)("div",{className:"h-full",children:a}),(0,s.jsxs)("div",{className:(0,X.cn)("h-16 top-0 @[80rem]/nav:h-0 @[80rem]/nav:top-8","absolute z-10 flex flex-row items-center justify-center w-full bg-gradient-to-b","from-background via-background via-80% to-transparent @[80rem]/nav:from-transparent @[80rem]/nav:via-transparent"),children:[(0,s.jsxs)("div",{className:"absolute start-1 flex gap-1 items-center",children:[(0,s.jsx)(ey,{shared:d}),j]}),(0,s.jsx)("div",{className:(0,X.cn)("grow justify-center hidden max-w-[50%] @[640px]/nav:flex"),children:o?(0,s.jsx)("div",{className:"text-muted-foreground",children:o}):null}),(0,s.jsxs)("div",{className:"absolute flex flex-row items-center gap-0.5 ms-auto end-3",children:[eT&&!n&&i&&(0,s.jsx)(N.p,{children:(0,s.jsx)(l.gx,{className:(0,X.cn)("rounded-full",(0,g.e8)(eT.personaId).colorClassName),variant:"ghost",size:"icon",tooltipContent:(0,s.jsxs)("p",{children:[w("New Persona Chat","New Persona Chat",{ns:"chat"}),F&&(0,s.jsxs)("span",{className:"ms-1 text-secondary",children:[F,"J"]})]}),tooltipContentProps:{side:"bottom"},onClick:eD,asChild:!0,children:(0,s.jsx)("div",{onClick:eD,children:(0,s.jsx)(u.cJ,{size:20,strokeWidth:2})})})},"new-persona-chat-button"),!eT&&(!n&&i||d)&&(0,s.jsx)(N.p,{children:(0,s.jsx)(l.gx,{className:"rounded-full",variant:"ghost",size:"icon",tooltipContent:(0,s.jsxs)("p",{children:[ef?w("top-nav-new-chat.tooltip","New chat in project",{ns:"chat"}):w("start new chat","New Chat",{ns:"chat"}),F&&(0,s.jsxs)("span",{className:"ms-1 text-secondary",children:[F,"J"]})]}),tooltipContentProps:{side:"bottom"},asChild:!0,children:eb?(0,s.jsx)(G.N_,{route:{page:"workspace",workspaceId:eb,conversationId:null},onClick:()=>{U("new_chat_action",void 0,{location:"chat-top-nav:handleClickNewChatWorkspace",insideWorkspace:"true"})},children:(0,s.jsx)(u.cJ,{size:20,strokeWidth:2})}):(0,s.jsx)(G.N_,{route:{page:"main"},onClick:ek,children:(0,s.jsx)(u.cJ,{size:20,strokeWidth:2})})})},"new-chat-button"),ep.USE_APP_SIDEBAR_V2&&i&&!n&&!d&&!eE&&(0,s.jsx)(l.gx,{className:"rounded-full",variant:"ghost",size:"icon","aria-label":i.starred?w("Unpin","Unpin"):w("Pin","Pin"),onClick:eA,tooltipContent:i.starred?w("Unpin","Unpin"):w("Pin","Pin"),children:(0,s.jsx)(N.p,{children:i.starred?(0,s.jsx)(p.A,{size:18}):(0,s.jsx)(u.tsw,{size:18})},i.starred?"pinned":"unpinned")}),!eO&&i&&eh&&!d&&!eE&&(0,s.jsx)(eu.w,{variant:"ghost",size:"icon",conversationId:i.conversationId,responseId:eh,iconProps:{size:20,strokeWidth:2}}),ep.USE_APP_SIDEBAR_V2&&ep.ENABLE_CONVERSATION_PAGE_ACTIONS&&i&&!n&&!d&&!eE&&(0,s.jsxs)(k.rI,{children:[(0,s.jsx)(k.ty,{asChild:!0,children:(0,s.jsx)(l.gx,{className:"rounded-full",variant:"ghost",size:"icon","aria-label":w("chat-top-nav.more","More"),onClick:eA,tooltipContent:w("chat-top-nav.more","More"),children:(0,s.jsx)(u.gyB,{size:20})})}),(0,s.jsxs)(k.SQ,{side:"bottom",align:"end",sideOffset:6,className:"min-w-36 space-y-0.5",children:[(0,s.jsx)(eS,{conversation:i,setDrawerOpen:eF}),(0,s.jsxs)(k._2,{onClick:eR,children:[(0,s.jsx)(u.ucK,{className:"size-4 me-2"}),w("chat-top-nav.delete-chat","Delete Chat")]})]})]}),ep.USE_APP_SIDEBAR_V2?null:ep.ENABLE_GROK_TASKS&&!!E&&f&&(0,s.jsx)(N.p,{children:(0,s.jsx)(l.gx,{variant:"ghost",size:"icon",className:"rounded-full","aria-label":w("Top-nav-tasks-label","Tasks",{ns:"tasks"}),onClick:ez,tooltipContent:(0,s.jsx)("div",{className:"flex flex-row gap-1",children:w("Top-nav-tasks-label","Tasks",{ns:"tasks"})}),children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(u.aMq,{size:20}),eL&&(0,s.jsx)(b.x,{variant:"sm",className:"absolute top-[50%] translate-y-[-50%] -left-2"})]})})},"tasks-nav-button"),eI&&!n&&!i&&!d&&"voice"!==q&&(0,s.jsx)(N.p,{children:(0,s.jsx)(ex,{hash:ev,isIncognito:ee,onLinkClick:e_,showLabel:!ec})},"incognito-nav-button"),ep.USE_APP_SIDEBAR_V2?null:(0,s.jsx)(l.gx,{variant:"ghost",size:"icon",className:"rounded-full","aria-label":w("History","History",{ns:"chat"}),onClick:()=>{U("opened_command_menu",void 0,{location:"chat-top-nav:button"}),eP()},tooltipContent:(0,s.jsxs)("div",{className:"flex flex-row gap-1",children:[w("History","History",{ns:"chat"}),F&&(0,s.jsxs)("span",{className:"text-secondary",children:["macos"===K?F:"".concat(F,"â‡§"),"K"]})]}),children:(0,s.jsx)(h,{size:20})}),eO&&i&&eh&&!d&&!eE&&(0,s.jsx)(eu.w,{variant:"outline",size:"md",rounded:!0,showLabel:!0,conversationId:i.conversationId,responseId:eh,iconProps:{size:20,strokeWidth:2}}),ep.USE_APP_SIDEBAR_V2?null:(0,s.jsx)(ej,{})]})]})]}),i&&(0,s.jsx)(eC,{conversation:i,drawerOpen:eB,setDrawerOpen:eF})]})}function ej(){let{t:e}=(0,el.Bd)("base"),{SUPPORT_URL:t}=(0,d.v)(),a=(0,en.useRouter)(),n=(0,r.wV)(),o=(0,M.h)(),c=(0,j.iV)(er.A("toggleOpen")),p=(0,ei.useCallback)(e=>{e.stopPropagation(),(0,J.P.getState().openReportDialog)()},[]),{isEnterpriseUser:m,isSuperGrokUser:h,isSuperGrokProUser:x,activeSubscriptions:g}=(0,K.Q2)(),v=(0,Z.e)(er.A("setIsUpselling")),f=(0,ei.useCallback)(e=>{e.stopPropagation(),a.push("/sign-out")},[a]),b=(0,E.f)(),w=(0,ei.useCallback)(e=>{e.stopPropagation(),c()},[c]),y=(0,ei.useCallback)(e=>{e.stopPropagation(),v(!0)},[v]),N=(0,ei.useCallback)(e=>{e.stopPropagation(),(0,eg.C.getState().openSwitchTeamDialog)()},[]);return n.user?(0,s.jsxs)(k.rI,{children:[(0,s.jsx)(k.ty,{asChild:!0,children:(0,s.jsx)(l.$n,{variant:"ghost",size:"icon",className:"p-1 rounded-full",children:(0,s.jsx)(i.e,{className:"w-8 h-8",user:n.user})})}),(0,s.jsxs)(k.SQ,{side:"bottom",align:"end",sideOffset:6,className:"min-w-36 space-y-0.5",children:[(0,s.jsxs)(k._2,{onClick:w,children:[(0,s.jsx)(u.DP5,{className:"size-4 me-2"}),e("user-dropdown.settings","Settings")]}),(0,s.jsxs)(k._2,{onClick:p,children:[(0,s.jsx)(ee.VAL,{className:"size-4 me-2"}),e("user-dropdown.report-issue","Report Issue")]}),(0,s.jsx)(k._2,{asChild:!0,children:(0,s.jsxs)(es(),{href:t,target:"_blank",children:[(0,s.jsx)(u.zWC,{height:16,width:16,className:"text-neutral-400 me-2"}),e("user-dropdown.community","Community")]})}),h||x?(0,s.jsx)(eb,{subscriptions:g}):m?null:(0,s.jsxs)(k._2,{onClick:y,children:[(0,s.jsx)(ee.Qtr,{className:"size-4 me-2"}),e("user-dropdown.upgrade","Upgrade plan")]}),o.ENABLE_GROK_TEAMS_FEATURES&&(0,s.jsxs)(k._2,{onClick:N,children:[(0,s.jsx)(u.ZHz,{height:16,width:16,className:"text-neutral-400 me-2"}),e("user-dropdown.switch-team","Switch Team")]}),(0,s.jsxs)(k._2,{onClick:f,children:[(0,s.jsx)(u.aKm,{className:"size-4 me-2"}),e("user-dropdown.sign-out","Sign Out")]})]})]}):(0,s.jsx)(ew,{currentLanguage:b})}function eb(e){let{subscriptions:t}=e,{t:a}=(0,el.Bd)("base"),[n,r]=(0,ei.useState)(!1),i=null==t?void 0:t[0];return i?(0,s.jsxs)(k._2,{onClick:e=>{e.preventDefault(),e.stopPropagation(),i.stripe?(r(!0),V.$W.subscriptionsCreateBillingPortalSession({body:{returnUrl:window.location.href}}).then(e=>{window.open(e.url,"_blank")}).catch((0,W.HX)("chat-top-nav:manage-subscription")).finally(()=>{r(!1)})):window.open((0,f.M)(i),"_blank")},children:[n?(0,s.jsx)(u.krw,{height:16,width:16,className:"text-neutral-400 animate-spin !duration-1000 me-2"}):(0,s.jsx)(u.YQh,{height:16,width:16,className:"text-neutral-400 me-2"}),a("user-dropdown.manage-subscription","Manage Subscription")]}):null}function ew(e){let{currentLanguage:t}=e,a=(0,en.useRouter)(),{t:n,i18n:r}=(0,el.Bd)("base"),i=(0,z._)(),[o,c]=(0,ei.useState)(!1),d=(0,ei.useCallback)(()=>{i("sign_in_redirect",void 0,{location:"chat-top-nav"}),a.push("/sign-in")},[a,i]),p=(0,ei.useCallback)(()=>{i("sign_up_redirect",void 0,{location:"chat-top-nav"}),a.push("/sign-up")},[a,i]),m=(0,ei.useCallback)(e=>{r.changeLanguage(e).then(()=>{Q.C$.getState().setSelectedLanguage(e),c(!1)}).catch((0,W.HX)("settings-account")),i("change_language",e,{location:"chat-top-nav"})},[r,i]);return(0,s.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,s.jsxs)(k.rI,{children:[(0,s.jsx)(k.ty,{asChild:!0,children:(0,s.jsx)(l.gx,{variant:"ghost",size:"icon",className:"rounded-full hidden @sm:flex",tooltipContent:n("Settings","Settings"),children:(0,s.jsx)(u.DP5,{size:20})})}),(0,s.jsxs)(k.SQ,{side:"bottom",align:"end",sideOffset:6,className:"min-w-36 space-y-0.5",children:[(0,s.jsx)(w.Uk,{}),(0,s.jsx)(k._2,{onClick:()=>c(!0),children:n("Language","Language")})]})]}),(0,s.jsxs)(l.$n,{size:"pill",variant:"primary",className:"h-8 px-3 text-sm",onClick:p,children:[(0,s.jsx)(u.KJW,{size:16,strokeWidth:2}),(0,s.jsx)("div",{children:n("Sign up","Sign up")})]}),(0,s.jsx)(l.$n,{size:"pill",variant:"none",className:(0,X.cn)("hidden @sm:flex","h-8 px-3 text-sm text-primary bg-transparent ring-1 ring-inset ring-toggle-border","hover:bg-button-secondary-hover hover:border-text-secondary"),onClick:d,children:(0,s.jsx)("div",{children:n("Sign in","Sign in")})}),(0,s.jsx)(x.C,{locale:t,open:o,onLocaleChange:m,onOpenChange:c})]})}function ey(e){let{shared:t}=e,a=(0,M.h)(),n=(0,Y.w)(er.A("fetchGetConversation")),r=(0,ed.aP)(er.A("conversationId")),{data:i}=(0,O.v)((0,U.F)(r,n)),{toggleSidebar:o}=(0,C.cL)(),{t:c}=(0,el.Bd)("base"),d=(0,D.Di)(),{route:p}=(0,G.wK)();return(0,s.jsxs)("div",{className:"flex flex-row items-center",children:[a.USE_APP_SIDEBAR_V2?d&&(0,s.jsx)(l.$n,{"aria-label":c("side-nav-toggle-button","Toggle sidebar"),className:"ms-2",variant:"ghost",size:"iconMd",rounded:!0,onClick:o,children:(0,s.jsx)(u.mTT,{})}):(0,s.jsx)(ek,{}),(0,s.jsx)(eN,{conversation:i}),!t&&i&&["main","chat"].includes(p.page)&&(0,s.jsx)(em,{conversation:i})]})}function ek(e){var t;let{alwaysSmall:a,className:r,onClick:i}=e,{t:l}=(0,el.Bd)("base"),o=(0,z._)(),c=(0,E.f)(),{isSuperGrokUser:d,isEnterpriseUser:u,isSuperGrokProUser:p}=(0,K.Q2)(),m=a?n.$r:(0,n.a8)({isSuperGrokPro:p,isSuperGrok:d,isEnterprise:u,language:c}),h=(0,en.usePathname)(),{route:x}=(0,G.wK)(),g=(0,Y.w)(er.A("fetchGetConversation")),v=(0,ed.aP)(er.A("conversationId")),{data:f}=(0,O.v)((0,U.F)(v,g)),{data:j}=(0,$.$1)(null!=(t=null==f?void 0:f.conversationId)?t:""),b=null==j?void 0:j[0],w=(0,ei.useCallback)(e=>{o("clicked_logo",void 0,{location:"chat-top-nav:TopLeftButton",insideWorkspace:String(!!b),fromRoute:x.page}),e.stopPropagation(),null==i||i(e)},[o,b,x.page,i]);return(0,s.jsx)(G.N_,{route:{page:"main"},"aria-label":l("Home page","Home page",{ns:"chat"}),onClick:w,className:(0,X.cn)("rounded-lg focus:outline-none focus-visible:ring-1 focus-visible:ring-ring",a?"":"ms-2 me-[0.5]",r),children:(0,s.jsx)(m,{className:(0,X.cn)("fill-primary max-w-full","[&>path]:hidden sm:[&>path]:block [&>#mark]:block [&>#furigana]:opacity-60 [&>#subtitle]:opacity-60","/"===h&&!v&&"sm:[&>path]:hidden",a&&C.vu)})})}function eN(e){let{conversation:t}=e,{getPersonaFromId:a}=(0,R.v5)();if(!t)return null;let n=a(t.personaId);if(!n)return null;let{icon:r,colorClassName:i}=(0,g.e8)(n.personaId);return(0,s.jsxs)(et.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.2},className:(0,X.cn)("border border-border-l2 px-3 py-1 rounded-full","text-sm text-secondary flex flex-row items-center gap-1","ml-2 mt-0.5","overflow-hidden"),children:[(0,s.jsx)("span",{className:(0,X.cn)("[&>svg]:h-3.5 [&>svg]:w-3.5",i),children:r}),(0,s.jsx)("span",{className:(0,X.cn)("max-w-[0px] @[340px]/nav:max-w-[75px] @[375px]/nav:max-w-[100px]","@[430px]/nav:max-w-[150px] truncate"),children:n.name})]})}function eC(e){let{conversation:t,drawerOpen:a,setDrawerOpen:n}=e,{t:r}=(0,el.Bd)("base"),i=(0,q.M)(e=>e.listStatus),l=(0,q.M)(e=>e.loadFirstPage);(0,ei.useEffect)(()=>{"ready"!==i&&l()},[i,l]);let c=(0,q._)(),d=(0,q.M)(e=>e.createWorkspace),u=(0,ei.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),d({name:r("chat-top-nav.new-project","New Project"),icon:(0,S.I)()}).catch((0,W.HX)("conversation-actions:create-project"))},[d,r]);return(0,s.jsx)(y._s,{open:a,onOpenChange:n,children:(0,s.jsxs)(y.zj,{className:"max-h-[80%]",children:[(0,s.jsx)(y.gk,{className:"px-5 pt-4",children:r("chat-top-nav.move-to-project","Move to Project")}),(0,s.jsx)("div",{className:"overflow-auto p-4",children:(null==c?void 0:c.length)?(0,s.jsx)("div",{className:"flex flex-col gap-2",children:c.map(e=>(0,s.jsx)("div",{className:"py-2 cursor-pointer hover:bg-button-secondary-hover rounded-lg",children:(0,s.jsx)(eI,{projectId:e.workspaceId,conversation:t,onClick:()=>n(!1)})},e.workspaceId))}):(0,s.jsx)(o.C,{content:r("chat-top-nav.no-projects","No projects yet"),ctaText:r("chat-top-nav.create-project","Create Project"),onClickCta:u},"no-projects")})]})})}function eS(e){let{conversation:t,setDrawerOpen:a}=e,{t:n}=(0,el.Bd)("base"),r=(0,q.M)(e=>e.listStatus),i=(0,q.M)(e=>e.loadFirstPage),l=(0,D.Di)();(0,ei.useEffect)(()=>{"ready"!==r&&i()},[r,i]);let c=(0,q._)(),d=(0,q.M)(e=>e.createWorkspace),p=(0,ei.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),d({name:n("chat-top-nav.new-project","New Project"),icon:(0,S.I)()}).catch((0,W.HX)("conversation-actions:create-project"))},[d,n]);return l?(0,s.jsx)(k._2,{onClick:()=>a(!0),children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(u.XRf,{size:17}),n("chat-top-nav.move-to-project","Move to Project")]})}):(0,s.jsxs)(k.lv,{children:[(0,s.jsx)(k.nV,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(u.XRf,{size:17}),n("chat-top-nav.move-to-project","Move to Project")]})}),(0,s.jsx)(k.dc,{children:(0,s.jsx)(k.M5,{className:"w-[250px]",children:(null==c?void 0:c.length)?(0,s.jsx)(s.Fragment,{children:c.map(e=>(0,s.jsx)(k._2,{children:(0,s.jsx)(eI,{projectId:e.workspaceId,conversation:t},e.workspaceId)},e.workspaceId))}):(0,s.jsx)(o.C,{content:n("chat-top-nav.no-projects","No projects yet"),ctaText:n("chat-top-nav.create-project","Create Project"),onClickCta:p},"no-projects")})})]},"add-to-workspace-button")}let eI=e=>{var t;let{projectId:a,conversation:n,onClick:r}=e,{t:i}=(0,el.Bd)("base"),l=(0,q.M)(e=>{var t;return null==(t=e.byId[a])?void 0:t.data}),{mutate:o,error:c}=(0,$.tX)({onSuccess:()=>{ec.oR.success(i("chat-top-nav.moved-chat-to-project","Moved chat to project"))}});(0,B.Y)("chat-top-nav:workspace-item",c);let d=(0,ei.useCallback)(()=>{null==r||r(),o({conversationId:n.conversationId,workspaceId:a})},[o,n.conversationId,a,r]);return(0,s.jsxs)("div",{className:(0,X.cn)("w-full flex flex-row items-center gap-2"),onClick:d,children:[(0,s.jsx)(I.n,{icon:null==l?void 0:l.icon,sizeClass:"size-4",rounded:!0,buttonSize:"iconXs",disabled:!0}),(0,s.jsxs)("span",{className:(0,X.cn)("flex-1 select-none text-nowrap max-w-full overflow-hidden text-left"),style:{maskImage:F.uU,WebkitMaskImage:F.uU},children:[null!=(t=null==l?void 0:l.name)?t:"Unnamed Project"," "]})]})}},72993:(e,t,a)=>{a.d(t,{n:()=>w,C:()=>E});var s=a(79342),n=a(69358),r=a(39489),i=a(54344),l=a(56691),o=a(39729),c=a(80226),d=a(24734),u=a(7658),p=a(88382),m=a(65146),h=a(91623),x=a(72055),g=a(37469),v=a(33846),f=a(58247);function j(e){let{assets:t,placeholder:a,uploadingFiles:n,onRemoveAsset:r,workspaceId:i,isReadonly:l}=e,o=(0,u.P9)(i);return t.length+n.length+o.length===0?null!=a?a:(0,s.jsx)(b,{}):(0,s.jsxs)("div",{className:"flex-1 flex flex-col gap-1 @sm:grid @sm:grid-cols-2 @sm:auto-rows-max",children:[n.map((e,t)=>(0,s.jsx)(v.P.div,{className:"max-w-full",initial:{opacity:0,translateY:-10},animate:{opacity:1,translateY:0},exit:{opacity:0,translateY:-10},children:(0,s.jsx)(h.t,{file:e,onRemoveFile:()=>{},metadata:void 0})},"file"+t)),o.map((e,t)=>(0,s.jsx)(v.P.div,{className:"max-w-full",initial:{opacity:0,translateY:-10},animate:{opacity:1,translateY:0},exit:{opacity:0,translateY:-10},children:(0,s.jsx)(h.t,{file:new File([e.thirdPartyFileId],e.name),onRemoveFile:()=>{},metadata:{fileMimeType:e.mimeType,fileName:e.name,thirdPartyFileId:e.thirdPartyFileId}})},"file"+t)),t.map((e,t)=>{var a;return(0,s.jsx)(v.P.div,{className:"max-w-full",initial:{opacity:0,translateY:-10},animate:{opacity:1,translateY:0},exit:{opacity:0,translateY:-10},children:(0,s.jsx)(g.u,{asset:e,onRemoveAsset:l?void 0:r,labelClassName:"sm:max-w-full flex-1",hideEdit:!0})},null!=(a=e.assetId)?a:t)})]})}function b(){let{t:e}=(0,m.Bd)("workspace");return(0,s.jsx)("div",{children:(0,s.jsx)(f.S,{icon:(0,s.jsx)(x.XRf,{size:24,strokeWidth:1.5}),title:e("workspace-assets-empty.title","Welcome"),subtitle:e("workspace-assets-empty.text","Start by attaching files to your project. They will be used in all chats in this project.")})})}function w(e){var t;let{workspace:a,placeholder:n}=e,l=null!=(t=a.workspaceId)?t:"",{data:o,isPending:c,isError:m,refetch:h}=(0,u.UL)(l),{SHARED_ASSET_SERVER_URL:x}=(0,r.v)(),g=(0,u.Ch)(l),{mutate:v,error:f}=(0,u.Ep)(l);(0,d.Y)("assets-section:removeAsset",f);let b=(0,p.useMemo)(()=>{var e;let t=null!=(e=null==o?void 0:o.assets)?e:[];return a.isPublic?t.map(e=>{var t,a;return t=e,a=x,{...t,key:t.workspaceSharingKey?"".concat(a,"/").concat(t.workspaceSharingKey):t.key,previewImageKey:t.workspaceSharingPreviewImageKey?"".concat(a,"/").concat(t.workspaceSharingPreviewImageKey):t.previewImageKey}}):t},[x,null==o?void 0:o.assets,a.isPublic]);return c?(0,s.jsx)(y,{}):m?(0,s.jsx)(N,{onRefetch:h}):(0,s.jsx)("section",{className:"flex-1 w-full h-full flex flex-col gap-2 relative",children:(0,s.jsx)(i.D,{fadeSize:"md",className:"py-2",children:(0,s.jsx)(j,{workspaceId:l,uploadingFiles:g,assets:b,placeholder:n,onRemoveAsset:e=>{e.assetId&&v(e.assetId)},isReadonly:a.isReadonly})})})}function y(){return(0,s.jsx)(n.P,{children:(0,s.jsxs)("div",{"aria-busy":"true",className:"flex flex-col gap-2 @sm:grid @sm:grid-cols-2 @sm:auto-rows-max",children:[(0,s.jsx)(k,{}),(0,s.jsx)(k,{}),(0,s.jsx)(k,{}),(0,s.jsx)(k,{})]})})}function k(){return(0,s.jsx)(c.E,{className:"bg-warm-gray-100 dark:bg-gray-900 h-10"})}function N(e){let{onRefetch:t}=e,{t:a}=(0,m.Bd)("workspace");return(0,s.jsxs)(o.Zp,{className:"flex flex-col items-center px-8 py-4",variant:"ghost",children:[a("assets-loading-error.title","Unable to load assets"),(0,s.jsx)(l.$n,{variant:"outline",size:"md",onClick:t,children:a("assets-loading-error.cta","Retry")})]})}var C=a(82451),S=a(23232),I=a(70526),_=a(44566),P=a(61312);function E(e){var t;let{workspaceId:a,onFileAddStarted:n,isReadonly:r,className:i}=e,{t:l}=(0,m.Bd)("workspace"),o=(0,S._)(),{data:c}=(0,u.UL)(a),h=(0,p.useMemo)(()=>{var e;return null!=(e=null==c?void 0:c.assets)?e:[]},[null==c?void 0:c.assets]),x=(0,p.useRef)(null),g=(0,p.useCallback)(()=>{var e;null==(e=x.current)||e.click()},[]),v=(0,_.x)(a),{mutate:f,error:j}=(0,u.Iv)(a);(0,d.Y)("attach-dropdown:upload",j);let{mutate:b,error:w}=(0,u.PQ)(a);(0,d.Y)("attach-dropdown:uploadThirdParty",w);let{mutate:y,error:k}=(0,u.mT)(a);(0,d.Y)("attach-dropdown:attachAsset",k);let N=(0,p.useCallback)(e=>{if(null==n||n(),h.length+e.length>I.aD){v(),o("ws_max_files_alert",void 0,{location:"file-upload"});return}e.forEach(e=>f(e))},[n,h.length,v,o,f]),E=(0,p.useCallback)(e=>{e.target.files&&(null==n||n(),N(Array.from(e.target.files)))},[n,N]),M=(0,p.useCallback)(()=>(0,s.jsx)("input",{ref:x,className:"hidden",type:"file",onChange:E,multiple:!0,"data-testid":"file-input"}),[E]),{data:T}=(0,u.qN)(),z=null!=(t=null==T?void 0:T.assets)?t:[];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C.z,{label:l("workspace-assets.attach","Attach"),inlineLabel:!0,handleClickUpload:g,onAttachAsset:e=>{if(e&&(null==n||n(),!h.some(t=>t.assetId===e.assetId))){if(h.length+1>I.aD){v(),o("ws_max_files_alert",void 0,{location:"attach-asset"});return}y(e)}},assets:z,handleUploadThirdParty:(e,t,a,s)=>{if(!h.some(e=>e.thirdPartyFileId===s)){if(h.length+1>I.aD){v(),o("ws_max_files_alert",void 0,{location:"attach-3rd-party"});return}b({name:e,mimeType:t,fileSource:a,thirdPartyFileId:s})}},className:(0,P.cn)("w-auto me-[1px]",i),attachFiles:N,disabled:r,tooltipContent:r&&l("project-asset-button.readonly-tooltip","You don't have permissions to attach files")}),M()]})}},74933:(e,t,a)=>{a.d(t,{p:()=>i});var s=a(79342),n=a(88382),r=a(61312);let i=n.forwardRef((e,t)=>{let{className:a,type:n,...i}=e;return(0,s.jsx)("input",{type:n,className:(0,r.cn)("flex h-9 w-full rounded-md border border-input-border bg-transparent px-3 py-1 text-sm shadow-sm file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...i})});i.displayName="Input"},80295:(e,t,a)=>{a.d(t,{s:()=>r});var s=a(88382),n=a(10731);function r(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,[r,i]=(0,s.useState)(e);return(0,s.useEffect)(()=>{i(e)},[e]),(0,n.A)(()=>t(r),a,[r]),[r,i]}},81745:(e,t,a)=>{a.d(t,{CommandMenu:()=>eR});var s=a(79342),n=a(39551),r=a(88382),i=a(38614),l=a(5663),o=a(68332),c=a(80295),d=a(75500),u=a(33231),p=a(23232),m=a(41320),h=a(98100),x=a(91102),g=a(24734),v=a(7658),f=a(17703),j=a(77232),b=a(84499),w=a(61312),y=a(49972),k=a(44347),N=a(17014),C=a(72055),S=a(84969),I=a(33846),_=a(16506),P=a(39116),E=a(74995),M=a(65146),T=a(42557),z=a(56691),D=a(24994),A=a(43086),R=a(92207);let L=e=>{let{name:t,value:a,keywords:i,icon:l,children:o,onTrigger:c}=e,d=(0,r.useMemo)(()=>(0,R.Jo)({type:"action",value:a}),[a]);return(0,s.jsx)(n.uB.Item,{keywords:i,value:d,onSelect:c,className:(0,w.cn)("flex cursor-pointer h-[48px] items-center gap-2 rounded-2xl px-3","data-[selected=true]:bg-button-ghost-hover"),children:o||(0,s.jsx)("div",{className:"flex flex-grow items-center justify-between gap-2 min-w-0",children:(0,s.jsxs)("div",{className:"flex flex-grow items-center gap-2 min-w-0",children:[l&&r.createElement(l,{size:16,className:"text-subtle flex-shrink-0 h-4 w-4"}),(0,s.jsx)("div",{className:"truncate",children:t})]})})})};var O=a(17338);let B=e=>{let{heading:t,className:a,children:r}=e;return(0,s.jsx)(n.L$,{heading:(0,s.jsx)("div",{className:(0,O.cx)("text-secondary px-3 pb-1.5 pt-2 text-sm",a),children:t}),children:r})};var F=a(19841);let K=(0,r.memo)(e=>{let{conversation:t,highlight:a,matchType:l}=e,o=(0,i.aP)(E.A("conversationId")),[c,d]=(0,r.useState)(!1),u=(0,r.useMemo)(()=>"MATCH_MESSAGE"===l&&a,[l,a]),p=(0,r.useMemo)(()=>o===t.conversationId,[o,t.conversationId]),m=(0,r.useMemo)(()=>(0,R.Jo)({type:"conversation",conversationId:t.conversationId}),[t.conversationId]);return(0,s.jsx)(n.uB.Item,{value:m,onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),className:(0,w.cn)("h-[48px] rounded-2xl grid grid-cols-1 grid-rows-1","data-[selected=true]:bg-button-ghost-hover",u&&"h-[64px]"),children:(0,s.jsx)(F.w,{...e,isHovered:c,isCurrent:p})})});var H=a(35181),$=a(48992),U=a(43893),W=a(10505),G=a(87906),X=a(30653),V=a(80978),Y=a(38074),J=a(37469),Q=a(5862),Z=a(86822),q=a(53915),ee=a(46815);let et=(0,r.forwardRef)((e,t)=>{var a,n;let{response:i,showMarkdown:l,matchedWords:o}=e,{t:c}=(0,M.Bd)("chat"),d=(0,Z.d)(E.A("fetchGetAsset")),u=(0,k.C$)(e=>e.userSettings.preferences.displayUserMessageMarkdown),{sender:p,message:m,cardAttachmentsJson:h,fileAttachments:x,responseId:g}=i,[v,f]=(0,r.useState)({}),j=(0,r.useMemo)(()=>Object.values(v),[v]),b=(0,r.useMemo)(()=>j.filter(e=>!e.isModelGenerated),[j]),y=(0,r.useMemo)(()=>"human"===i.sender,[i.sender]),N=(0,r.useMemo)(()=>!y||(null!=l?l:u),[y,l,u]),S=(0,r.useMemo)(()=>{var e,t;return(null==(e=i.generatedImageUrls)?void 0:e.length)||Object.keys(null!=(t=i.streamingImageById)?t:{}).length},[null==(a=i.generatedImageUrls)?void 0:a.length,i.streamingImageById]),I=(0,r.useMemo)(()=>!y&&!!S,[y,S]),[_,P]=(0,r.useMemo)(()=>{let{webSearchResults:e,xposts:t,steps:a}=i,s=[...t||[],...(a||[]).flatMap(e=>e.xposts||[])],n=[...e||[],...(a||[]).flatMap(e=>e.webSearchResults||[])],r=new Set,l=s.filter(e=>!(!(null==e?void 0:e.postId)||r.has(e.postId))&&(r.add(e.postId),!0)),o=new Set;return[l,n.filter(e=>!(!(null==e?void 0:e.url)||o.has(e.url))&&(o.add(e.url),!0))]},[i]),T=(0,r.useMemo)(()=>m?(0,W.V)(m):m,[m]);(0,r.useEffect)(()=>{null==x||x.forEach(e=>{d({assetId:e}).then(t=>{f(q.A(ee.A(e),t))}).catch(()=>{})})},[x,d,f]);let z=(0,r.useMemo)(()=>{var e;if(i.thinkingStartTime&&i.thinkingEndTime){let e=new Date(i.thinkingEndTime).getTime()-new Date(i.thinkingStartTime).getTime();return c("thought-for-duration","Thought for {{duration}}",{duration:(0,Q.a3)(e)})}return(null==(e=i.steps)?void 0:e.length)||i.thinkingTrace?c("simplified-response.thinking-performed","Thinking Performed"):null},[null==(n=i.steps)?void 0:n.length,i.thinkingEndTime,i.thinkingStartTime,i.thinkingTrace,c]);return(0,s.jsxs)("div",{ref:t,className:(0,w.cn)("relative group flex flex-col justify-center px-4 pb-2 gap-2",y?"items-end":"items-start"),children:[(0,s.jsxs)(X.s,{isUser:y,children:[z&&(0,s.jsxs)("div",{className:"text-secondary h-auto flex items-center justify-start gap-1 rounded-xl border-divider py-1",children:[(0,s.jsx)(C.xmO,{size:18,className:"text-secondary text-nowrap shrink-0"}),(0,s.jsx)("span",{children:z})]}),h&&h.length>0&&(0,s.jsx)("div",{className:"flex flex-col space-y-3",children:h.map((e,t)=>(0,s.jsx)(Y._,{cardAttachmentJson:e},"".concat(g,"-card-").concat(t)))}),(0,s.jsx)(G.m,{response:i,isStreaming:!1,numImages:S||0,readOnly:!0,disableImageClick:!0}),I?null:N?(0,s.jsx)(V.Ad,{sender:p||"",webSearchResults:P||ea,xposts:_||ea,hideCitations:(null!=_?_:[]).length+(null!=P?P:[]).length===0,matchedWords:o,cardAttachmentsJson:h,shouldRenderHtml:!0,children:T||""}):(0,s.jsx)("span",{className:"whitespace-pre-wrap",children:(0,V.Sw)(T||"",o)})]}),b.length>0&&(0,s.jsx)("div",{className:"flex flex-row flex-wrap justify-end gap-2 mt-2",children:b.map(e=>(0,s.jsx)(J.u,{asset:e,isPrivate:!1,isDisabled:!0,allowCompact:!0},e.assetId))})]},null==o?void 0:o.join(""))}),ea=[],es=e=>{let{conversationResults:t}=e,{t:a}=(0,M.Bd)("base"),n=(0,U.A3)(E.A("loadPreviewResponses")),i=(0,R.H0)(E.A("selectedItem")),l=(0,r.useMemo)(()=>{if((null==i?void 0:i.type)==="conversation")return i.conversationId},[i]),o=(0,r.useMemo)(()=>l?t.find(e=>e.conversation.conversationId===l):void 0,[l,t]),c=(0,r.useMemo)(()=>{if(l)return n(l,null==o?void 0:o.matchedResponseId)},[l,null==o?void 0:o.matchedResponseId,n]),{data:d={responses:[],hasOlderResponses:!1,hasNewerResponses:!1},isLoading:u,error:p}=(0,H.v)(c),m=(0,r.useMemo)(()=>{var e;return null==(e=d.responses)?void 0:e.filter(e=>!e.responseId.startsWith("streaming_in_progress")&&(!e.state||"closed"===e.state))},[d.responses]),h=(0,r.useMemo)(()=>{let e=(0,$.Mb)(m),t=(0,$.d7)((null==e?void 0:e.responseId)||"",d.responses);return m.filter(e=>!!t.find(t=>t.responseId===e.responseId))},[m,d.responses]),x=(0,k.C$)(e=>e.userSettings.preferences.displayUserMessageMarkdown);return(0,s.jsxs)("div",{className:"col-span-1 xl:col-span-3 flex items-center justify-center overflow-auto h-full relative py-0.5 @container/preview",children:[(0,s.jsx)("div",{className:"absolute z-10 inset-x-0 bottom-0 h-6 bg-gradient-to-t from-background to-transparent"}),(0,s.jsx)("div",{className:"absolute z-10 inset-x-0 top-0 h-6 bg-gradient-to-b from-background to-transparent"}),(0,s.jsx)(S.N,{mode:"wait",children:l?p?(0,s.jsxs)(I.P.div,{initial:{opacity:1},animate:{opacity:1},exit:{opacity:1},transition:{duration:.1,ease:"easeIn"},className:"text-secondary flex items-center gap-3",children:[(0,s.jsx)(C.lW3,{}),a("Error Loading Messages","Error Loading Messages")]},"error"):u?(0,s.jsxs)(I.P.div,{initial:{opacity:1},animate:{opacity:1},exit:{opacity:1,transition:{duration:.05}},transition:{duration:.1,ease:"easeIn"},className:"text-secondary flex justify-center items-center gap-3",children:[a("Loading Messages","Loading Messages"),(0,s.jsx)(A.y,{size:"sm"})]},"loading"):(0,s.jsx)(en,{hasOlderResponses:d.hasOlderResponses,hasNewerResponses:d.hasNewerResponses,messages:h,showMarkdown:x,matchedResponseId:null==o?void 0:o.matchedResponseId,matchedWords:null==o?void 0:o.matchedWords},l):(0,s.jsx)(I.P.div,{initial:{opacity:1},animate:{opacity:1},exit:{opacity:1},transition:{duration:.1,ease:"easeIn"},className:"text-secondary flex items-center gap-3",children:a("Select a conversation to preview","Select a conversation to preview")},"no-conversation")})]})},en=e=>{let{messages:t,hasOlderResponses:a,hasNewerResponses:n,showMarkdown:i,matchedResponseId:l,matchedWords:o}=e,c=(0,r.useRef)(null),d=(0,r.useRef)(null),{t:u}=(0,M.Bd)("base");return(0,r.useEffect)(()=>{if(c.current)if(l&&d.current){var e;null==(e=d.current)||e.scrollIntoView({behavior:"smooth",block:"center"})}else c.current.scrollTop=c.current.scrollHeight},[l,t]),(0,s.jsxs)(I.P.div,{initial:{opacity:1},animate:{opacity:1},exit:{opacity:1,transition:{duration:.05}},transition:{duration:.1,ease:"easeIn"},className:"h-full w-full overflow-auto flex flex-col gap-3 py-6 px-3",ref:c,children:[a&&(0,s.jsx)("div",{className:"text-secondary text-center mb-4",children:u("Open the conversation to see older messages","Open the conversation to see older messages")}),t.sort((e,t)=>null===e.parentResponseId||e.parentResponseId===t.responseId?1:-1).map(e=>(0,s.jsx)(et,{ref:l===e.responseId?d:void 0,response:e,matchedWords:l===e.responseId?o:void 0,showMarkdown:"human"===e.sender?i:void 0},e.responseId)),n&&(0,s.jsx)("div",{className:"text-secondary text-center mt-4",children:u("Open the conversation to see newer messages","Open the conversation to see newer messages")})]})},er=e=>{let{label:t,variant:a,shortcut:n,onTrigger:r}=e;return(0,s.jsxs)(z.$n,{variant:"ghost",size:"sm",className:"pr-1.5 last-of-type:rounded-br-2xl group",onClick:r,children:[(0,s.jsx)("span",{className:(0,w.cn)("whitespace-nowrap",{"text-red-400":"destructive"===a,"text-primary":"default"===a}),children:t}),n&&(0,s.jsx)("span",{className:"text-secondary border border-border px-1.5 rounded-md group-last-of-type:group-hover:rounded-br-xl group-last-of-type:group-focus:rounded-br-xl",children:n})]})};var ei=a(26067);let el=e=>{let{actions:t}=e,{t:a,i18n:n}=(0,M.Bd)("base"),i=(0,k.C$)(E.A("selectedLanguage")),l=(0,r.useMemo)(()=>i||n.languages.find(e=>e in ei.IV)||ei.GG,[n.languages,i]);return(0,s.jsx)(B,{heading:a("Language","Language"),children:t.map(e=>{var t;return(0,s.jsx)(L,{...e,children:(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2 w-full",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 w-full min-w-0",children:[(0,s.jsx)(C.ATU,{className:"w-4 h-4 flex-shrink-0"}),(0,s.jsx)("span",{className:"text-secondary whitespace-nowrap truncate",children:(0,s.jsx)(M.x6,{t:a,ns:"base",i18nKey:"Change to",defaults:"Change to <primary>{{name}}</primary>",values:{name:e.name},components:{primary:(0,s.jsx)("span",{className:"text-primary"})}})})]}),l===e.value?(0,s.jsx)(C.Jlk,{className:"w-4 h-4 text-secondary"}):(0,s.jsx)("span",{className:"text-secondary whitespace-nowrap",children:null==(t=ei.IB[e.value])?void 0:t.nativeName})]})},e.value)})})},eo=e=>{let{actions:t}=e,{t:a}=(0,M.Bd)("base"),n=(0,i.aP)(E.A("activeModelId"));return(0,s.jsx)(B,{heading:a("Models","Models"),children:t.map(e=>(0,s.jsx)(L,{...e,children:(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2 w-full",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,s.jsx)(C.azJ,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-secondary whitespace-nowrap truncate",children:(0,s.jsx)(M.x6,{ns:"base",i18nKey:"Switch to",defaults:"Switch to <primary>{{name}}</primary>",values:{name:e.name},components:{primary:(0,s.jsx)("span",{className:"text-primary"})}})})]}),n===e.value&&(0,s.jsx)(C.Jlk,{className:"w-4 h-4 text-secondary"})]})},e.value))})};var ec=a(97196),ed=a(86639),eu=a(13511),ep=a(74933);function em(e){let{isCopied:t,setIsCopied:a,lastMessageId:n,conversationId:i,onShareLinkChange:l,onShareLinkCopy:o}=e,{t:c}=(0,M.Bd)("base"),{mutate:d,data:u,isPending:p,isIdle:m,isError:h}=(0,eu.n_)({mutationKey:["share-conversation",i,n],mutationFn:()=>ec.chatApi.chatShareConversation({conversationId:i,body:{responseId:n}}),onSuccess:e=>{let{shareLinkId:t}=e;t&&l(t)}});(0,r.useEffect)(()=>{m&&d()},[]),(0,r.useEffect)(()=>()=>{a(!1),l(null)},[]);let x=u?window.location.origin+"/share/"+u.shareLinkId:null;return(0,s.jsxs)("div",{className:"flex flex-col gap-6 py-12",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-3 items-center",children:[(0,s.jsx)("div",{className:"text-lg text-center",children:c("Share this conversation","Share this conversation")}),(0,s.jsx)("div",{className:"text-secondary text-center",children:c("Share this conversation.description","This conversation will be visible to anyone with the shared link.")})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-6 w-[min(100%,460px)] mx-auto",children:[p&&!h||x&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"relative border border-border-l1 rounded-2xl py-1",children:[(0,s.jsx)(ep.p,{type:"text",value:x||"".concat(c("Loading","Loading"),"..."),disabled:!0,className:"flex-1 w-full rounded-xl pl-3 pr-24 py-5 text-sm text-primary border-none shadow-none"}),p?(0,s.jsx)("div",{className:"absolute inset-y-0 end-0 pr-2 flex items-center",children:(0,s.jsx)(A.y,{size:"xs"})}):(0,s.jsx)("div",{className:"absolute inset-y-0 end-0 pr-1 flex items-center",children:(0,s.jsx)(z.$n,{variant:"ghostSecondary",onClick:o,className:"text-primary",autoFocus:!0,children:t?c("Copied!","Copied!"):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C.TdU,{className:"size-4"}),c("Copy","Copy")]})})})]}),(0,s.jsx)("div",{className:"!w-fit mx-auto",children:(0,s.jsx)("a",{href:p?void 0:"https://twitter.com/intent/tweet?url=".concat(encodeURIComponent(x)),target:p?void 0:"_blank",rel:p?void 0:"noopener noreferrer",children:(0,s.jsxs)(z.$n,{variant:"filled",className:"w-60 sm:min-w-24",disabled:p,children:[c("Share on","Share on"),(0,s.jsx)(ed.A,{size:14})]})})})]}),h&&(0,s.jsx)("div",{className:"text-red-500",children:c("Failed to share conversation","Failed to share conversation")})]})]})}var eh=a(88119);let ex=e=>{let{actions:t}=e,{t:a}=(0,M.Bd)("base"),{theme:n}=(0,_.D)();return(0,s.jsx)(B,{heading:a("Theme","Theme"),children:t.map(e=>(0,s.jsx)(L,{...e,children:(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2 w-full",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[Object.keys(eh.zG).includes(e.value)&&eh.zG[e.value]&&r.createElement(eh.zG[e.value].icon,{size:16,className:"text-subtle flex-shrink-0 h-4 w-4"}),(0,s.jsx)("span",{className:"text-secondary whitespace-nowrap truncate",children:(0,s.jsx)(M.x6,{t:a,ns:"base",i18nKey:"Switch to",defaults:"Switch to <primary>{{name}}</primary>",values:{name:e.name},components:{primary:(0,s.jsx)("span",{className:"text-primary"})}})})]}),n===e.value&&(0,s.jsx)(C.Jlk,{className:"w-4 h-4 text-secondary"})]})},e.value))})};var eg=a(95366),ev=a.n(eg);let ef=(e,t)=>t.length?e.filter(e=>Math.max(ev()("string"==typeof e.name?e.name:e.value,t),e.keywords?e.keywords.reduce((e,a)=>{let s=ev()(a,t);return s>e?s:e},0):0)>.3):e,ej=e=>{let{searchQuery:t}=e,{t:a}=(0,M.Bd)("base"),s=(0,i.aP)(E.A("conversationId")),n=(0,r.useMemo)(()=>{let e=[];return s&&e.push({name:a("Share","Share"),value:"share",keywords:["share","link","x"],icon:C.liv,onTrigger:()=>{let{addPage:e}=R.H0.getState();e({id:"share",isSearchEnabled:!1,searchQuery:""})}}),e},[s,a]);return{actions:(0,r.useMemo)(()=>ef(n,t),[n,t])}};var eb=a(2376),ew=a(70888),ey=a(18585),ek=a(5790),eN=a(48795);let eC=e=>{let{searchQuery:t,onClose:a}=e,{t:n}=(0,M.Bd)("base"),l=(0,R.H0)(E.A("addPage")),c=(0,R.H0)(E.A("onSearchQueryChange")),{routeToConversation:u,isChatPage:m}=(0,o.o)(),{theme:x}=(0,_.D)(),{user:g}=(0,T.wV)(),{modelById:v}=(0,h.GB)(),{route:f}=(0,b.wK)(),j=(0,d.h)(),w=(0,P.useRouter)(),N=(0,i.aP)(E.A("activeModelId")),S=(0,i.aP)(E.A("reasoningMode")),I=(0,i.aP)(E.A("setReasoningMode")),z=(0,i.aP)(E.A("conversationMode")),D=(0,i.aP)(E.A("conversationId")),A=(0,i.aP)(E.A("isDeepSearchRateLimited")),L=(0,i.aP)(E.A("isThinkingRateLimited")),O=(0,k.C$)(E.A("setIsIncognito")),B=(0,k.C$)(E.A("isIncognito")),F=(0,y.w)(e=>D?e.byId[D]:void 0),K=(0,p._)(),H=(0,ek.iV)(E.A("toggleOpen")),$=(0,ek.iV)(E.A("open")),U=(0,r.useMemo)(()=>{if(F&&(0,eb.sS)(F.personaId))return(0,ey.pL)(F.personaId,n)},[F,n]),W=(0,r.useMemo)(()=>null==v?void 0:v[N],[N,v]),G=(0,r.useMemo)(()=>{var e;return null==W||null==(e=W.tags)?void 0:e.includes("deepsearch")},[W]),X=(0,r.useMemo)(()=>{var e;return null==W||null==(e=W.tags)?void 0:e.includes("always_show_deepsearch")},[W]),V=(0,r.useMemo)(()=>{var e;return null==W||null==(e=W.tags)?void 0:e.includes("think")},[W]),Y=(0,r.useMemo)(()=>{var e;return null==W||null==(e=W.tags)?void 0:e.includes("always_show_think")},[W]),{isThinkDisabled:J,isDeepsearchDisabled:Q,isThinkSelected:Z,isDeepsearchSelected:q}=(0,h.QG)(W),{handleVoiceModeEnter:ee}=(0,eN.F)({location:"command-menu"}),et=(0,r.useMemo)(()=>!(!W||Q||U&&U.hideDeepSearch||!G&&!X||A||X&&!G),[W,Q,G,X,U,A]),ea=(0,r.useMemo)(()=>!(!W||J||U&&U.hideThinking||!V&&!Y||L||Y&&!V),[W,J,V,Y,U,L]),es=(0,r.useCallback)(()=>{c(""),O(!1),u(void 0),a()},[a,c,O,u]),en=(0,r.useCallback)(()=>{c(""),O(!0),u(void 0),a()},[a,c,O,u]),er=(0,r.useCallback)(()=>{let e=i.aP.getState(),t=ew.x.getState();return t.removeByConversationId(e.conversationId||"no_conversation_id"),t.removeAttachByConversationId(e.conversationId||"no_conversation_id"),c(""),a(),ee()},[a,c,ee]),ei=(0,r.useCallback)(()=>{let e=i.aP.getState();return c(""),a(),e.exitVoiceMode("user_initiated")},[a,c]),el=(0,r.useMemo)(()=>{let e=[];return g||e.push({name:n("Sign in","Sign in"),value:"sign-in",icon:C.KJW,keywords:["enter","sign","in","login"],onTrigger:()=>{K("sign_in_redirect",void 0,{location:"command-menu"}),w.push("/sign-in"),a()}}),D||!m?(e.push({name:n("Create New Chat","Create New Chat"),value:"new-chat",icon:C.cJ,keywords:["new","start","conversation"],onTrigger:es}),g&&e.push({name:n("Create New Private Chat","Create New Private Chat"),value:"new-private-chat",icon:C.FEr,keywords:["new","start","conversation","incognito","private"],onTrigger:en})):B?e.push({name:n("Create New Chat","Create New Chat"),value:"new-chat",icon:C.cJ,keywords:["new","start","conversation"],onTrigger:es}):g&&e.push({name:n("Create New Private Chat","Create New Private Chat"),value:"new-private-chat",icon:C.FEr,keywords:["new","start","conversation","incognito","private"],onTrigger:en}),j.ENABLE_VOICE_MODE&&!B&&"voice"!==z&&["main","chat"].includes(f.page)&&e.push({name:n("Enter Voice Mode","Enter Voice Mode"),value:"voice-mode",keywords:["enter","voice","mode","talk","companion"],icon:C.b7X,onTrigger:er}),"voice"===z&&e.push({name:n("Exit Voice Mode","Exit Voice Mode"),value:"exit-voice-mode",keywords:["exit","voice","mode"],icon:C.b7X,onTrigger:ei}),D&&g&&e.push({name:n("command-menu.move-to-workspace.label","Move conversation to project"),value:"move-to-workspace",icon:C.XRf,keywords:["workspace","move"],onTrigger:()=>l({id:"move-to-workspace",isSearchEnabled:!0,searchQuery:"",searchPlaceholder:n("command-menu.move-to-workspace.placeholder","Find project...")})}),e.push({name:n("Switch Model","Switch Model"),value:"switch-model",icon:C.azJ,keywords:["switch","model"],onTrigger:()=>l({id:"switch-model",isSearchEnabled:!0,searchQuery:"",searchPlaceholder:n("Search models...","Search models...")})},{name:n("Switch Theme","Switch Theme"),value:"switch-theme",icon:x&&Object.keys(eh.zG).includes(x)?eh.zG[x].icon:C.w2g,keywords:["switch","theme"],onTrigger:()=>l({id:"switch-theme",isSearchEnabled:!0,searchQuery:"",searchPlaceholder:n("Search themes...","Search themes...")})}),ea&&(e.push({name:Z?(0,s.jsx)(M.x6,{ns:"base",i18nKey:"Disable Tool",defaults:"Disable <primary>{{name}}</primary>",values:{name:n("Think","Think")},components:{primary:(0,s.jsx)("span",{className:"font-medium"})}}):(0,s.jsx)(M.x6,{ns:"base",i18nKey:"Enable Tool",defaults:"Enable <primary>{{name}}</primary>",values:{name:n("Think","Think")},components:{primary:(0,s.jsx)("span",{className:"font-medium"})}}),value:"think",icon:C.xmO,keywords:[n("Think","Think"),"think","tool","mode","reason"].concat(Z?[n("Disable","Disable")]:[n("Enable","Enable")]),onTrigger:()=>{let e="think"==S?"none":"think";K("switch_reasoning_mode",e,{location:"command-menu:useHomeActions"}),I(e),a()}}),et&&e.push({name:q?(0,s.jsx)(M.x6,{ns:"base",i18nKey:"Disable Tool",defaults:"Disable <primary>{{name}}</primary>",values:{name:n("DeepSearch","DeepSearch")},components:{primary:(0,s.jsx)("span",{className:"font-medium"})}}):(0,s.jsx)(M.x6,{ns:"base",i18nKey:"Enable Tool",defaults:"Enable <primary>{{name}}</primary>",values:{name:n("DeepSearch","DeepSearch")},components:{primary:(0,s.jsx)("span",{className:"font-medium"})}}),value:"deepsearch",icon:C.AaN,keywords:[n("DeepSearch","DeepSearch"),"deepsearch","search","research","tool","mode","reason"].concat(q?[n("Disable","Disable")]:[n("Enable","Enable")]),onTrigger:()=>{let e="deepsearch"==S?"none":"deepsearch";K("switch_reasoning_mode",e,{location:"command-menu:useHomeActions"}),I(e),a()}}),e.push({name:n("Change Language","Change Language"),value:"change-language",icon:C.ATU,keywords:["change","language","locale"],onTrigger:()=>{l({id:"change-language",isSearchEnabled:!0,searchQuery:"",searchPlaceholder:n("Search languages...","Search languages...")})}}),$||e.push({name:n("Settings","Settings"),value:"settings",icon:C.DP5,keywords:["settings","preferences"],onTrigger:()=>{H(),a()}}),g&&e.push({name:n("Sign out","Sign out"),value:"sign-out",icon:C.nUv,keywords:["exit","sign","out","logout"],onTrigger:()=>{w.push("/sign-out"),a()}})),e},[D,es,en,g,B,et,ea,Z,q,x,S,$,H,l,m,a,w,I,K,n,er,ei,j,z,f.page]);return{actions:(0,r.useMemo)(()=>ef(el,t),[el,t])}},eS=e=>{let{searchQuery:t,onLanguageChange:a}=e,s=(0,r.useMemo)(()=>ei.O4.map(e=>({name:ei.IB[e].name,value:e,keywords:[ei.IB[e].nativeName,ei.IB[e].name],icon:C.ATU,onTrigger:()=>{a(e)}})),[a]);return{actions:(0,r.useMemo)(()=>ef(s,t),[s,t])}};var eI=a(3683),e_=a(35228),eP=a(48589),eE=a(20014),eM=a(82646);let eT=e=>{let{searchQuery:t,onModelSwitch:a}=e,{models:s}=(0,h.GB)(),n=(0,r.useMemo)(()=>s.filter(e=>!!e.name).map(e=>({name:e.name,type:"action",value:e.modelId,icon:eM.dNu,onTrigger:()=>{a(e.modelId)}})),[s,a]);return{actions:(0,r.useMemo)(()=>ef(n,t),[n,t])}},ez=e=>{let{searchQuery:t,onThemeSwitch:a}=e,{t:s}=(0,M.Bd)("base"),n=(0,r.useMemo)(()=>{let e={light:s("Light","Light"),dark:s("Dark","Dark"),system:s("System","System")};return Object.entries(eh.zG).map(t=>{let[s,{icon:n}]=t;return{name:e[s],value:s,icon:n,onTrigger:()=>{a(s)}}})},[s,a]);return{actions:(0,r.useMemo)(()=>ef(n,t),[n,t])}},eD=e=>{let{searchQuery:t,onSelect:a}=e,n=(0,eI._)(),i=(0,r.useMemo)(()=>n.map(e=>{var t,n;let r=null!=(t=e.name)?t:"",i=null!=(n=e.workspaceId)?n:"";return{name:r,type:"action",value:i,keywords:[r],icon:()=>(0,s.jsx)(e_.Oh,{icon:e.icon}),onTrigger:()=>{i&&a(i)}}}),[n,a]);return{actions:(0,r.useMemo)(()=>ef(i,t),[i,t])}},eA=e=>{let{actions:t}=e,{t:a}=(0,M.Bd)("base");return(0,s.jsx)(B,{heading:a("command-menu-section.workspace","Project"),children:t.map(e=>(0,s.jsx)(L,{...e},e.value))})};function eR(e){let{trigger:t}=e,{t:a,i18n:O}=(0,M.Bd)("base"),F=(0,d.h)(),H={today:a("Today","Today"),yesterday:a("Yesterday","Yesterday"),"last-7-days":a("Last 7 Days","Last 7 Days"),"this-year":a("This Year","This Year"),older:a("Older","Older")},$=(0,r.useRef)(null),U=(0,p._)(),{routeToConversation:W,signInWithReturnTo:G}=(0,o.o)(),X=(0,T.wV)().user,V=(0,P.useRouter)(),{commandPrefix:Y}=(0,x.c)(),J=(0,g.K)(),{push:Z}=(0,b.wK)(),q=(0,R.H0)(E.A("open")),ee=(0,R.H0)(E.A("selectedItem")),et=(0,R.H0)(E.A("pages")),ea=(0,R.H0)(E.A("goBack")),en=(0,i.aP)(E.A("lastMessageId")),ei=(0,i.aP)(E.A("conversationId")),ed=(0,i.aP)(E.A("activeModelId")),ep=(0,i.aP)(E.A("reasoningMode")),eh=(0,h.$E)(),eg=(0,k.C$)(e=>e.userSettings.preferences.showConversationPreviews),ev=(0,m.Di)(),[ew,ey]=(0,r.useState)(null),[ek,eN]=(0,r.useState)(null),[eM,eR]=(0,r.useState)(""),[eL,eO]=(0,r.useState)(null),[eB,eF]=(0,r.useState)(!1),eK=(0,r.useMemo)(()=>et[et.length-1]||null,[et]),eH=(0,r.useMemo)(()=>X&&(null==eK?void 0:eK.id)==="root"&&!ev,[X,null==eK?void 0:eK.id,ev]),e$=(0,r.useMemo)(()=>eH&&eg,[eg,eH]),eU=(0,r.useMemo)(()=>{var e,t;return null!=(t=null==eK||null==(e=eK.searchQuery)?void 0:e.trim())?t:""},[null==eK?void 0:eK.searchQuery]),eW=(0,r.useMemo)(()=>eB||(null==eK?void 0:eK.isSearchEnabled)&&!!eU,[eB,null==eK?void 0:eK.isSearchEnabled,eU]),{groupedConversations:eG,results:eX,refetch:eV,loadMoreRef:eY,historyContainerRef:eJ,isLoading:eQ,isFetching:eZ,isError:eq}=function(e){let{query:t}=e,a=(0,T.wV)().user,s=(0,eP.o)(t,200),n=(0,eu.jE)(),i=(0,g.K)(),l=(0,r.useRef)(null),o=(0,r.useRef)(null),[c,d]=(0,r.useState)(!1),[u,p]=(0,r.useState)(!1),m=(0,r.useCallback)(async e=>{let{pageParam:t}=e;if(!a)return{conversationResults:[],nextPageToken:void 0};try{var n,r,l;let e=await ec.chatApi.chatListConversations({searchQuery:s||void 0,pageToken:"string"==typeof t?t:void 0,pageSize:"60"});return{conversationResults:(null==(n=e.textSearchMatches)?void 0:n.length)?null==(r=e.textSearchMatches)?void 0:r.map(e=>{var t;return{...e,conversation:{...e.conversation,personaId:(0,eb._c)(null==(t=e.conversation)?void 0:t.systemPromptName),isNew:!1,state:"closed"}}}):(null==(l=e.conversations)?void 0:l.map(e=>({conversation:{...e,personaId:(0,eb._c)(e.systemPromptName),isNew:!1,state:"closed"}})))||[],nextPageToken:e.nextPageToken,textSearchMatches:e.textSearchMatches||[]}}catch(e){throw i("use-search-conversations",e),e}},[s,a,i]),{data:h,fetchNextPage:x,hasNextPage:v,isFetchingNextPage:j,isFetching:b,isError:w,isLoading:k,refetch:N}=(0,eu.qu)({queryKey:["conversations",s,null==a?void 0:a.userId],queryFn:m,initialPageParam:void 0,getNextPageParam:e=>e.nextPageToken,enabled:!!a,staleTime:6e5,refetchOnWindowFocus:!0}),C=(0,r.useMemo)(()=>{let e=(null==h?void 0:h.pages.flatMap(e=>e.conversationResults))||[],t=s?e:e.sort((e,t)=>new Date(t.conversation.modifyTime).getTime()-new Date(e.conversation.modifyTime).getTime());return eE.A(e=>e.conversation.conversationId,t)},[null==h?void 0:h.pages,s]),S=(0,r.useMemo)(()=>{let e=Q.YL.map(e=>{let{key:t}=e;return{timeRange:t,conversations:[]}});return C.forEach(t=>{let{conversation:a}=t,s=(0,Q.JU)(a.modifyTime);if(s){let t=e.find(e=>e.timeRange===s);t&&t.conversations.push(a)}}),e.filter(e=>e.conversations.length>0)},[C]);return(0,r.useEffect)(()=>{let e=y.w.subscribe(e=>e.byId,(e,t)=>{let a=!1;Object.values(e).forEach(e=>{let s=t[e.conversationId];(s||e.temporary)&&(e.temporary||(null==s?void 0:s.modifyTime)===e.modifyTime&&(null==s?void 0:s.title)===e.title&&(null==s?void 0:s.starred)===e.starred&&(null==s?void 0:s.state)===e.state)||(a=!0)}),Object.values(t).forEach(t=>{e[t.conversationId]||(a=!0)}),a&&n.invalidateQueries({queryKey:["conversations"]}).catch(e=>(0,f.vV)("conversation-store-update",e))});return()=>e()},[n]),(0,r.useEffect)(()=>{if(!(null==l?void 0:l.current)||!(null==o?void 0:o.current))return;let e=new IntersectionObserver(e=>{let[t]=e;t&&d(t.isIntersecting)},{root:o.current,rootMargin:"300px 0px 300px 0px",threshold:.1}),t=l.current;if(t)return e.observe(t),()=>{e.unobserve(t)}},[null==l?void 0:l.current,null==o?void 0:o.current]),(0,r.useLayoutEffect)(()=>{c&&v&&!j&&a&&!u&&(p(!0),x().catch(e=>(0,f.vV)("intersection-load-more",e)))},[c,v,j,x,a,u]),(0,r.useEffect)(()=>{if(u){let e=setTimeout(()=>{p(!1)},300);return()=>clearTimeout(e)}},[u]),{results:C,refetch:N,loadMoreRef:l,historyContainerRef:o,groupedConversations:S,isLoading:k,isFetching:b,isError:w}}({query:eU}),e0=(0,r.useCallback)(e=>{let{goBack:t,openMenu:a}=R.H0.getState();if(e)a();else{if(ew||ek){ey(null),eN(null),eR("");return}eF(!1),t()}},[ew,ek]),{actions:e1}=eC({searchQuery:eU,onClose:(0,r.useCallback)(()=>{e0(!1)},[e0])}),{actions:e2}=ej({searchQuery:eU}),e3=(0,r.useCallback)(e=>{U("switch_model",e,{location:"comand-menu"});let{setActiveModelId:t}=i.aP.getState();t(e);let{closeMenu:a}=R.H0.getState();a()},[U]),{actions:e4}=eT({searchQuery:eU,onModelSwitch:e3}),{mutate:e5,error:e6}=(0,v.tX)();(0,g.Y)("command-menu:addToWorkspace",e6);let{actions:e8}=function(e){let{searchQuery:t,onWorkspaceSelected:a,hasCurrentConversation:n}=e,i=(0,eI._)();return(0,r.useMemo)(()=>n?{actions:ef(i.map(e=>({name:e.name,value:"workspace-"+e.workspaceId,icon:t=>{let{size:a}=t;return(0,s.jsx)(e_.Oh,{icon:e.icon,size:a})},onTrigger:()=>{var t;null==a||a(null!=(t=e.workspaceId)?t:"")}})),t)}:{actions:[]},[n,i,t,a])}({searchQuery:eU,onWorkspaceSelected:(0,r.useCallback)(e=>{let{closeMenu:t}=R.H0.getState();t(),ei&&(e5({conversationId:ei,workspaceId:e}),U("add_conversation_to_workspace",void 0,{location:"comand-menu"}))},[e5,ei,U]),hasCurrentConversation:!!ei}),{setTheme:e7}=(0,_.D)(),e9=(0,r.useCallback)(e=>{e7(e);let{closeMenu:t}=R.H0.getState();t()},[e7]),{actions:te}=ez({searchQuery:eU,onThemeSwitch:e9}),tt=(0,r.useCallback)(e=>{O.changeLanguage(e).then(()=>{let{setSelectedLanguage:t}=k.C$.getState();t(e)}).catch(e=>(0,f.vV)("cmdk-language-change",e));let{closeMenu:t}=R.H0.getState();t(),U("change_language",e,{location:"command-menu"})},[O,U]),{actions:ta}=eS({searchQuery:eU,onLanguageChange:tt}),{actions:ts}=eD({searchQuery:eU,onSelect:(0,r.useCallback)(e=>{let{closeMenu:t}=R.H0.getState();t(),Z({page:"workspace",workspaceId:e,tab:"attachments"})},[Z])}),tn=(0,r.useMemo)(()=>ee?ee.type:null,[ee]),tr=(0,r.useMemo)(()=>ee?"home-action"===ee.type?e1.find(e=>e.value===ee.homeActionId)||null:"item-action"===ee.type&&e2.find(e=>e.value===ee.itemActionId)||null:null,[e1,e2,ee]),ti=(0,r.useMemo)(()=>e1[0]||null,[e1]),tl=(0,r.useCallback)(e=>{eF(e)},[]),to=(0,r.useCallback)(e=>{let{fetchSetPreference:t}=k.C$.getState();t("showConversationPreviews",e).catch((0,f.HX)("command-menu:handleShowConversationPreviewsChange"))},[]),tc=(0,r.useCallback)(e=>{let{setSelectedItem:t}=R.H0.getState();ew||ek||t(e)},[ew,ek]),[td,tu]=(0,r.useState)(""),tp=td?(0,R.kw)(td):void 0,tm=(0,r.useCallback)(e=>{let t=(0,R.kw)(e),{setSelectedItem:a}=R.H0.getState();a(t)},[]);(0,c.s)(td,tm,100);let th=(0,r.useCallback)(e=>{let{onSearchQueryChange:t}=R.H0.getState();t(e),ey(null),eN(null),eF(!1)},[]),tx=(0,r.useCallback)(e=>{var t;let a=eX.find(t=>t.conversation.conversationId===e);eR((null==a||null==(t=a.conversation)?void 0:t.title)||""),ey(e)},[eX]),[tg,tv]=(0,r.useState)(!1),tf=(0,r.useCallback)(()=>{let e=eL?window.location.origin+"/share/"+eL:null;e&&(tv(!0),(0,j.g)(e,a("Copied share link to clipboard.","Copied share link to clipboard.")),setTimeout(()=>tv(!1),1e3),U("clicked-share-copy",e,{location:"share-form",conversationId:ei||"",responseId:en||"",shareUrl:e}))},[eL,a,U,ei,en]),tj=(0,r.useCallback)(e=>{var t;let a,s=Array.from((null==(t=$.current)?void 0:t.querySelectorAll("[cmdk-item][data-value]:not([hidden])"))||[]);if(0===s.length)return;let n=ee?(0,R.kX)(ee):void 0,r=s.findIndex(e=>e.getAttribute("data-value")===n&&"true"===e.getAttribute("data-selected"));if(!$.current)return;a=-1!==r&&ee?"PageUp"===e?Math.max(0,r-8):Math.min(s.length-1,r+8):"PageDown"===e?0:s.length-1;let i=s[a];if(!i)return;let l=i.getAttribute("data-value"),o=i.getAttribute("data-type");l&&o&&(tc((0,R.P1)(o,l)),i.scrollIntoView({behavior:"instant",block:"PageUp"===e?"start":"end"}))},[ee,tc,$]),tb=(0,r.useCallback)(e=>{if(ew||ek)return;W(e,!1,!0);let t=y.w.getState().byId[e];U("select_conversation",e,{conversationCreateTime:(null==t?void 0:t.createTime)||"",location:"command-menu"}),e0(!1)},[ew,ek,W,U,e0]),tw=(0,r.useCallback)(async e=>{var t;if(ew!==e)return;let a=eM.trim();if(""===a)return;let s=eX.find(t=>t.conversation.conversationId===e);U("update_conversation",e,{location:"search-dialog"}),ey(null);let{fetchUpdateConversation:n}=y.w.getState();await n(e,{title:a,starred:null==s||null==(t=s.conversation)?void 0:t.starred}).catch(e=>{J("command-menu:handleEditSave",e)}),await eV()},[eX,J,ew,eM,eV,U]),ty=(0,r.useCallback)(async e=>{var t;let a=eX.find(t=>t.conversation.conversationId===e);U("favorite_conversation",e,{value:(null==a?void 0:a.conversation.starred)?"true":"false",location:"search-dialog"});let{fetchUpdateConversation:s}=y.w.getState();await s(e,{starred:!(null==a||null==(t=a.conversation)?void 0:t.starred)}).catch(e=>{J("command-menu:handleToggleFavorite",e)}),await eV()},[eX,J,eV,U]),tk=(0,r.useCallback)(async e=>{if(ek!==e)return;U("delete_conversation",e,{location:"search-dialog"}),ei===ek&&W(),eN(null);let{fetchSoftDeleteConversation:t}=y.w.getState();await t(e).catch(e=>{J("command-menu:handleDeleteConfirm",e)}),await eV()},[ek,U,ei,eV,W,J]),tN=(0,r.useCallback)(e=>{if(e.stopPropagation(),"Tab"===e.key&&e.preventDefault(),"PageUp"===e.key||"PageDown"===e.key){e.preventDefault(),tj(e.key);return}if("Enter"===e.key&&eU&&!eQ&&0===eX.length&&(null==eK?void 0:eK.id)==="root"&&0===e4.length&&0===te.length&&0===ta.length&&0===ts.length&&0===e1.length&&0===e2.length){if(e.preventDefault(),!X&&(!F.ENABLE_ANON_USERS||eh.includes(ed))){U("sign_in","chat-new",{location:"chat-new"}),G(eU,ep);return}let{establishNewConversation:t}=i.aP.getState();t({message:eU,enableRetries:F.ENABLE_AUTO_STREAM_RETRY,ff:F}).then(()=>{e0(!1)}).catch(e=>{J("command-menu:handleKeyDown",e)});return}if(ek&&"Enter"===e.key)return e.preventDefault(),tk(ek);if((null==eK?void 0:eK.id)==="share"&&"Enter"===e.key)return e.preventDefault(),tf();if(!(ew||ek)&&(null==ee?void 0:ee.type)==="conversation"){if("e"===e.key.toLowerCase()&&e.shiftKey&&(e.metaKey||e.ctrlKey)){e.preventDefault(),tx(ee.conversationId);return}else if("d"===e.key.toLowerCase()&&e.shiftKey&&(e.metaKey||e.ctrlKey)){e.preventDefault(),eN(ee.conversationId);return}}if(("Backspace"===e.key&&!eU||"k"===e.key.toLowerCase()&&(e.metaKey||e.ctrlKey&&e.shiftKey))&&(e.preventDefault(),e0(!1)),eH&&"p"===e.key.toLowerCase()&&(e.metaKey||e.ctrlKey)&&e.shiftKey&&(e.preventDefault(),to(!eg)),"Enter"===e.key&&(null==ee?void 0:ee.type)==="conversation")if(e.metaKey||e.ctrlKey)window.open("/chat/".concat(ee.conversationId),"_blank");else{let{fetchGetConversation:e}=y.w.getState();e(ee.conversationId).then(e=>tb(e.conversationId)).catch((0,f.HX)("command-menu:handleConversationSelect"))}},[eU,eQ,eX.length,null==eK?void 0:eK.id,e4.length,te.length,ta.length,ts.length,e1.length,e2.length,ek,ew,ee,eH,tj,X,eh,ed,U,G,ep,e0,J,tk,tf,tx,to,eg,tb,F]),tC=(0,r.useCallback)(()=>{ey(null),eN(null),eR("")},[]),tS=(0,r.useCallback)(()=>{U("sign_in_redirect",void 0,{location:"command-menu"}),V.push("/sign-in")},[V,U]);(0,u.v)(l.VP,()=>{U("opened_command_menu",void 0,{location:"command-menu:hotkey"}),e0(!q)},[q,e0]),(0,u.v)(l._1,()=>{eH&&(q?to(!eg):(e0(!0),to(!0)))},[eg,to,e0,q,eH]);let tI=(0,r.useMemo)(()=>ee?(0,R.Jo)(ee):"",[ee]);return(0,s.jsx)(D.R,{open:q,setOpen:e0,trigger:t,contentClassName:(0,w.cn)("bg-background rounded-3xl transition-all duration-150 ease-in-out outline-none w-full md:w-5/6 lg:w-3/5 max-w-3xl flex flex-col",{"rounded-b-none":ev},{"md:w-[calc(100dvw-32px)] lg:w-5/6 max-w-[1600px]":e$}),headerClassName:"sr-only",titleClassName:"sr-only",title:a("Command Menu","Command Menu"),children:(0,s.jsxs)(n.uB,{ref:$,label:"Command Menu",loop:!0,shouldFilter:!1,value:tI,defaultValue:null==ti?void 0:ti.value,onKeyDown:tN,onValueChange:tu,className:(0,w.cn)("flex flex-col w-full focus-visible:outline-none"),children:[(0,s.jsx)("div",{className:"flex items-center gap-3 px-5 border-b border-border h-14",children:(0,s.jsxs)(S.N,{mode:"popLayout",children:[(null==eK?void 0:eK.id)!=="root"&&(0,s.jsx)(I.P.div,{layout:!0,initial:{opacity:0,translateX:-10},animate:{opacity:1,translateX:0},exit:{opacity:0,translateX:-10},transition:{duration:.15},className:"flex items-center w-8 h-8 justify-center rounded-full text-fg-secondary hover:text-fg-primary hover:bg-button-ghost-hover transition-colors -ml-3",children:(0,s.jsx)(N.Oj5,{size:24,onClick:ea})},"back-arrow"),(null==eK?void 0:eK.isSearchEnabled)&&(0,s.jsx)(I.P.div,{className:"flex items-center w-full gap-2",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.uB.Input,{ref:e=>{ew||null==e||e.focus()},placeholder:(null==eK?void 0:eK.searchPlaceholder)||"".concat(a("Search","Search"),"..."),value:null==eK?void 0:eK.searchQuery,className:"flex-grow w-full bg-transparent placeholder:text-fg-secondary focus-visible:outline-none",onValueChange:th}),(0,s.jsx)(S.N,{mode:"wait",children:eZ&&(null==eK?void 0:eK.id)==="root"?(0,s.jsx)(I.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:"flex-shrink-0",children:(0,s.jsx)(A.y,{size:"sm"})},"spinner"):(0,s.jsx)(I.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:"flex-shrink-0",children:(0,s.jsx)(C.vji,{className:"size-5 text-fg-secondary"})},"search-icon")})]})})]})}),(0,s.jsx)(n.uB.List,{onPointerDown:e=>e.stopPropagation(),onPointerMove:e=>e.stopPropagation(),onPointerUp:e=>e.stopPropagation(),children:(0,s.jsxs)(I.P.div,{initial:{height:ev?"calc(90dvh - 64px)":e$?"80dvh":"min(460px, calc(100dvh - 56px - 48px - 32px))"},animate:{height:ev?"calc(90dvh-64px)":e$?"80dvh":"min(460px, calc(100dvh - 56px - 48px - 32px))"},transition:{duration:.15,ease:"easeInOut"},className:"w-full relative",children:[X&&(null==eK?void 0:eK.isSearchEnabled)&&(0,s.jsx)(n.uB.Empty,{className:"flex absolute inset-0 bg-background z-10 pt-24 md:pt-0 md:pb-32 flex-col items-center justify-center text-center grow",children:(0,s.jsx)(S.N,{mode:"wait",children:eq&&(null==eK?void 0:eK.id)==="root"?(0,s.jsxs)(I.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:"text-fg-secondary flex items-center gap-3",children:[(0,s.jsx)(C.lW3,{}),a("Error Loading Conversations","Error Loading Conversations")]},"error"):eQ&&(null==eK?void 0:eK.id)==="root"?(0,s.jsx)(I.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:"text-fg-secondary flex items-center gap-3 animate-pulse",children:a("Loading Conversations","Loading Conversations")},"loading"):(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(I.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:"text-fg-secondary",children:[(0,s.jsx)("div",{className:"text-fg-secondary",children:a("No results found.","No results found.")}),eU.length>0&&(null==eK?void 0:eK.id)==="root"&&(0,s.jsxs)("div",{className:"hidden mt-4 md:block",children:[(0,s.jsx)("div",{className:"text-fg-secondary",children:a("Press enter to start new chat with:","Press enter to start new chat with:")}),(0,s.jsx)("div",{className:"text-fg-primary whitespace-nowrap truncate max-w-[400px]",children:eU})]})]},"no-results")})})}),(null==eK?void 0:eK.id)==="root"?(0,s.jsxs)("div",{className:(0,w.cn)("grid h-full relative",{"grid-cols-2 xl:grid-cols-5":e$}),children:[(0,s.jsxs)("div",{className:(0,w.cn)("col-span-1 xl:col-span-2 h-full overflow-auto space-y-3 p-3",e$&&"border-r border-border"),style:{scrollPaddingBlock:"1rem"},ref:eJ,children:[eW?(0,s.jsxs)(s.Fragment,{children:[(!!e1.length||!!e2.length)&&(0,s.jsxs)(B,{heading:(0,s.jsxs)("div",{className:"flex justify-between gap-3 items-center",children:[(0,s.jsx)("div",{children:a("Actions","Actions")}),!eU&&(null==eK?void 0:eK.isSearchEnabled)&&(0,s.jsx)("div",{className:"text-xs hover:text-primary transition-colors cursor-pointer",onClick:()=>tl(!1),children:a("Show Less","Show Less")})]}),children:[e1.map(e=>(0,s.jsx)(L,{...e},e.value)),e2.map(e=>(0,s.jsx)(L,{...e},e.value))]}),eU.length>0&&e4.length>0&&(0,s.jsx)(eo,{actions:e4}),eU.length>0&&te.length>0&&(0,s.jsx)(ex,{actions:te}),eU.length>0&&ta.length>0&&(0,s.jsx)(el,{actions:ta}),eU.length>0&&ts.length>0&&(0,s.jsx)(eA,{actions:ts}),eU.length>0&&e8.length>0&&(0,s.jsx)(eA,{actions:e8})]}):ti?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(B,{heading:(0,s.jsxs)("div",{className:"flex justify-between gap-3 items-center",children:[(0,s.jsx)("div",{children:a("Actions","Actions")}),(0,s.jsx)("div",{className:"text-xs hover:text-primary transition-colors cursor-pointer",onClick:()=>tl(!0),children:a("Show All","Show All")})]}),children:(0,s.jsx)(L,{...ti},ti.value)})}):null,X?eX.length>0?(0,s.jsxs)(s.Fragment,{children:[eU?(0,s.jsx)(B,{heading:a("History","History"),children:null==eX?void 0:eX.map(e=>{let{conversation:t,matchedWords:a,matchType:n,highlight:r}=e;return(0,s.jsx)(K,{conversation:t,matchedWords:a,matchType:n,highlight:eg?void 0:r,isSelected:(null==tp?void 0:tp.type)==="conversation"&&tp.conversationId==tp.conversationId,isEditing:ew===t.conversationId,isDeleting:ek===t.conversationId,newTitle:eM,onNewTitleChange:eR,onSelect:tb,onEditStart:tx,onDeleteStart:eN,onToggleFavorite:ty,onEditSave:tw,onDeleteConfirm:tk,onCancel:tC},t.conversationId)})}):eG.map(e=>{var t;return(0,s.jsx)(B,{heading:H[e.timeRange],children:null==(t=e.conversations)?void 0:t.map(e=>(0,s.jsx)(K,{conversation:e,isSelected:(null==tp?void 0:tp.type)==="conversation"&&tp.conversationId===e.conversationId,isEditing:ew===e.conversationId,isDeleting:ek===e.conversationId,newTitle:eM,onNewTitleChange:eR,onSelect:tb,onEditStart:tx,onDeleteStart:eN,onToggleFavorite:ty,onEditSave:tw,onDeleteConfirm:tk,onCancel:tC},e.conversationId))},e.timeRange)}),(0,s.jsx)("div",{ref:eY,className:"h-[1px] flex justify-center !m-0 !p-0"})]}):!eU&&(0,s.jsx)(B,{heading:a("History","History"),children:(0,s.jsx)("div",{className:"flex flex-col items-center justify-center py-12 text-center grow md:py-24",children:(0,s.jsx)(S.N,{mode:"wait",children:eq?(0,s.jsxs)(I.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:"text-secondary flex items-center gap-3",children:[(0,s.jsx)(C.lW3,{}),a("Error Loading Conversations","Error Loading Conversations")]},"error"):eQ?(0,s.jsx)(I.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:"text-secondary flex items-center gap-3 animate-pulse",children:a("Loading Conversations","Loading Conversations")},"loading"):(0,s.jsx)(I.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:"text-secondary",children:a("History is empty","History is empty")},"empty")})})}):(0,s.jsx)(B,{heading:a("History","History"),children:(0,s.jsx)("div",{className:"flex flex-col items-center justify-center py-12 text-center grow md:py-24",children:(0,s.jsx)(z.$n,{variant:"outline",onClick:tS,children:a("Sign in to see your history","Sign in to see your history")})})})]}),e$&&(0,s.jsx)(es,{conversationResults:eX})]}):(0,s.jsxs)("div",{className:(0,w.cn)("h-full p-3 overflow-auto"),style:{scrollPaddingBlock:"1rem"},children:[(null==eK?void 0:eK.id)==="share"&&ei&&en&&(0,s.jsx)(em,{isCopied:tg,setIsCopied:tv,conversationId:ei,lastMessageId:en,onShareLinkChange:eO,onShareLinkCopy:tf}),(null==eK?void 0:eK.id)==="switch-model"&&e4.length>0&&(0,s.jsx)(eo,{actions:e4}),(null==eK?void 0:eK.id)==="switch-theme"&&te.length>0&&(0,s.jsx)(ex,{actions:te}),(null==eK?void 0:eK.id)==="change-language"&&ta.length>0&&(0,s.jsx)(el,{actions:ta}),(null==eK?void 0:eK.id)==="workspace"&&ts.length>0&&(0,s.jsx)(eA,{actions:ts}),(null==eK?void 0:eK.id)==="move-to-workspace"&&e8.length>0&&(0,s.jsx)(eA,{actions:e8})]})]})}),!ev&&(0,s.jsxs)("div",{className:(0,w.cn)("flex items-center justify-end w-full h-12 gap-2 px-2 py-1 border-t border-border-l1",eH&&"justify-between"),children:[eH&&(0,s.jsx)(z.gx,{"aria-label":eg?a("Hide Conversation Previews","Hide Conversation Previews"):a("Show Conversation Previews","Show Conversation Previews"),tooltipContent:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{children:eg?a("Hide Conversation Previews","Hide Conversation Previews"):a("Show Conversation Previews","Show Conversation Previews")}),(0,s.jsx)("span",{className:"text-secondary border border-card px-1.5 rounded-md -mr-1.5",children:"".concat(Y," â‡§ P")})]}),tooltipContentProps:{side:"bottom"},tooltipProps:{delayDuration:500},variant:"ghost",size:"iconSm",rounded:!0,className:"transition-colors text-secondary hover:text-primary",onClick:()=>to(!eg),children:eg?(0,s.jsx)(C.Oy_,{size:16}):(0,s.jsx)(C.MQ_,{size:16})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[tn&&["home-action","item-action"].includes(tn)&&tr&&(0,s.jsx)(er,{label:tr.name,shortcut:"âŽ",variant:"default",onTrigger:tr.onTrigger}),(null==ee?void 0:ee.type)==="model"&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(er,{label:a("Switch","Switch"),shortcut:"âŽ",variant:"default",onTrigger:()=>{e3(ee.modelId)}})}),(null==ee?void 0:ee.type)==="theme"&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(er,{label:a("Switch","Switch"),shortcut:"âŽ",variant:"default",onTrigger:()=>{e9(ee.themeId)}})}),(null==ee?void 0:ee.type)==="language"&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(er,{label:a("Change","Change"),shortcut:"âŽ",variant:"default",onTrigger:()=>{tt(ee.languageId)}})}),(null==ee?void 0:ee.type)==="conversation"&&(0,s.jsx)(s.Fragment,{children:ew?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(er,{label:a("Cancel","Cancel"),shortcut:"Esc",variant:"default",onTrigger:()=>{ey(null),eR("")}}),(0,s.jsx)(er,{label:a("Confirm","Confirm"),shortcut:"âŽ",variant:"default",onTrigger:()=>tw(ew)})]}):ek?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(er,{label:a("Cancel","Cancel"),shortcut:"Esc",variant:"default",onTrigger:()=>{eN(null)}}),(0,s.jsx)(er,{label:a("Delete","Delete"),shortcut:"âŽ",variant:"destructive",onTrigger:()=>tk(ek)})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(er,{label:a("Go","Go"),shortcut:"âŽ",variant:"default",onTrigger:()=>tb(ee.conversationId)}),(0,s.jsx)(er,{label:a("Edit","Edit"),shortcut:"".concat(Y," â‡§ E"),variant:"default",onTrigger:()=>{tx(ee.conversationId)}}),(0,s.jsx)(er,{label:a("Delete","Delete"),shortcut:"".concat(Y," â‡§ D"),variant:"default",onTrigger:()=>{eN(ee.conversationId)}})]})}),(null==eK?void 0:eK.id)==="share"&&eL&&(0,s.jsx)(er,{label:a("Copy","Copy"),shortcut:"âŽ",variant:"default",onTrigger:tf})]})]})]})})}},83638:(e,t,a)=>{a.d(t,{B:()=>n});var s=a(88382);function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{threshold:.1},a=(0,s.useRef)(null);return(0,s.useEffect)(()=>{let s=new IntersectionObserver(t=>{let a=t[0];a&&a.isIntersecting&&e()},t),n=a.current;if(n)return s.observe(n),()=>{s.unobserve(n)}},[e,t]),a}},88119:(e,t,a)=>{a.d(t,{M:()=>m,Uk:()=>p,zG:()=>u});var s=a(79342),n=a(56691),r=a(61884),i=a(61312),l=a(40251),o=a(72055),c=a(16506);a(88382);var d=a(65146);let u={light:{icon:o.bd5,label:"Light"},dark:{icon:o.UtH,label:"Dark"},system:{icon:o.w2g,label:"System"}};function p(){let{t:e}=(0,d.Bd)("base"),{setTheme:t,theme:a}=(0,c.D)(),o={light:e("Light","Light"),dark:e("Dark","Dark"),system:e("System","System")};return(0,s.jsx)("div",{className:"w-full px-1 pt-1 pb-1",children:(0,s.jsx)("div",{className:"flex items-stretch w-full gap-2 justify-stretch",children:Object.entries(u).map(e=>{let[c,{icon:d}]=e;return(0,s.jsxs)(r.m_,{disableHoverableContent:!0,children:[(0,s.jsx)(l.k$,{asChild:!0,children:(0,s.jsx)(n.$n,{className:(0,i.cn)("w-full rounded-lg",{"bg-button-ghost-hover":a===c}),size:"icon",variant:"ghost",onClick:()=>t(c),value:c,children:(0,s.jsx)(d,{size:16})})}),(0,s.jsx)(r.ZI,{side:"bottom",children:(0,s.jsx)("p",{children:o[c]})})]},c)})})})}function m(){let{t:e}=(0,d.Bd)("base"),{setTheme:t,theme:a}=(0,c.D)(),r={light:e("Light","Light"),dark:e("Dark","Dark"),system:e("System","System")};return(0,s.jsx)("div",{className:"w-full px-1 pb-1",children:(0,s.jsx)("div",{className:"flex items-stretch w-full gap-2 justify-stretch",children:Object.entries(u).map(e=>{let[l,{icon:o}]=e;return(0,s.jsxs)(n.$n,{className:(0,i.cn)(a===l&&"bg-button-ghost-hover","w-full rounded-2xl flex-col p-3 group","ring-1 ring-inset ring-toggle-border hover:ring-card-border-focus hover:bg-card-hover text-primary"),variant:"none",size:"none",onClick:()=>t(l),value:l,children:[(0,s.jsx)(o,{className:(0,i.cn)("group-hover:text-primary",a===l?"text-primary":"text-secondary"),size:20}),(0,s.jsx)("p",{children:r[l]})]},l)})})})}},88844:(e,t,a)=>{a.d(t,{w:()=>o});var s=a(79342),n=a(61312),r=a(84969),i=a(33846),l=a(88382);function o(e){let{children:t,isVisible:a,minWidth:o,maxWidth:c,initialWidth:d,className:u}=e,[p,m]=(0,l.useState)(!1),[h,x]=(0,l.useState)(d);(0,l.useRef)(h).current=h;let g=(0,l.useRef)(null),v=(0,l.useRef)(document.body.clientWidth);(0,l.useEffect)(()=>{x(d)},[d]);let f=(0,l.useCallback)(e=>{e.preventDefault(),m(!0)},[]),j=(0,l.useCallback)(()=>{m(!1)},[]),b=(0,l.useCallback)(e=>{p&&g.current&&x(Math.max(o,Math.min(c,document.body.clientWidth-e.clientX)))},[p,o,c]),w=(0,l.useCallback)(()=>{x(Math.max(o,Math.min(c,d/v.current*document.body.clientWidth)))},[o,c,d]);return(0,l.useEffect)(()=>(window.addEventListener("mousemove",b),()=>window.removeEventListener("mousemove",b)),[b]),(0,l.useEffect)(()=>(window.addEventListener("mouseup",j),()=>window.removeEventListener("mouseup",j)),[j]),(0,l.useEffect)(()=>(window.addEventListener("resize",w),()=>window.removeEventListener("resize",w)),[w]),(0,s.jsx)(r.N,{children:a&&(0,s.jsx)(i.P.div,{initial:{x:h,opacity:0,width:0},animate:{x:0,opacity:1,width:h},exit:{x:h,opacity:0,width:0},transition:p?{duration:0}:{type:"ease",ease:"easeInOut",duration:.3},className:(0,n.cn)("h-dvh flex-shrink-0",u),children:(0,s.jsxs)("div",{ref:g,className:"relative h-full w-full",children:[(0,s.jsx)("div",{className:(0,n.cn)("absolute start-0 top-0 bottom-0 w-2 cursor-col-resize border-l border-input-border hover:bg-card-hover z-50",p&&"bg-card-hover"),onMouseDown:f}),(0,s.jsxs)("div",{className:"h-full p-0",children:[t,p&&(0,s.jsx)("div",{className:"absolute inset-0 bg-transparent z-50"})]})]})})})}},91102:(e,t,a)=>{a.d(t,{c:()=>i});var s=a(88382);function n(e){return/(Macintosh)|(MacIntel)|(MacPPC)|(Mac68K)/i.test(e)}function r(){let{userAgent:e}=window.navigator;return/(iPhone)|(iPad)|(iPod)/i.test(e)||n(e)&&"ontouchend"in document?"ios":n(e)?"macos":/(Win32)|(Win64)|(Windows)|(WinCE)/i.test(e)?"windows":/Android/i.test(e)?"android":/Linux/i.test(e)?"linux":"undetermined"}function i(){let[e,t]=(0,s.useState)("undetermined");(0,s.useEffect)(()=>{t(r)},[]);let a=function(e){switch(e){case"macos":return"âŒ˜";case"windows":case"linux":return"Ctrl+";default:return null}}(e);return{os:e,commandPrefix:a}}},92207:(e,t,a)=>{a.d(t,{H0:()=>c,Jo:()=>r,P1:()=>l,kX:()=>n,kw:()=>i});var s=a(65258);function n(e){switch(e.type){case"conversation":return e.conversationId;case"home-action":return e.homeActionId;case"item-action":return e.itemActionId;case"model":return e.modelId;case"theme":return e.themeId;case"language":return e.languageId;case"move-to-workspace":return e.workspaceId;case"action":return e.value}}function r(e){return"".concat(e.type,":").concat(n(e))}function i(e){if(!e)return;let[t,a]=e.split(":");return l(t,a)}function l(e,t){switch(e){case"conversation":return{type:e,conversationId:t};case"home-action":return{type:e,homeActionId:t};case"item-action":return{type:e,itemActionId:t};case"model":return{type:e,modelId:t};case"theme":return{type:e,themeId:t};case"language":return{type:e,languageId:t};case"move-to-workspace":return{type:e,workspaceId:t};case"action":return{type:e,value:t};default:throw Error("Unknown selection type: ".concat(e))}}class o{constructor(e,t){this.set=e,this.get=t,this.open=!1,this.selectedItem=void 0,this.pages=[{id:"root",isSearchEnabled:!0,searchQuery:""}],this.onSearchQueryChange=e=>{let t=this.get().pages[this.get().pages.length-1];this.set({pages:[...this.get().pages.slice(0,-1),{...t,searchQuery:e}]})},this.openMenu=()=>{this.set({open:!0})},this.goBack=()=>{if(1===this.get().pages.length){this.onSearchQueryChange(""),this.set({open:!1}),this.setSelectedItem(void 0);return}this.setSelectedItem(void 0),this.set({pages:this.get().pages.slice(0,-1)})},this.closeMenu=()=>{this.set({open:!1,selectedItem:void 0,pages:[{...this.get().pages[0],searchQuery:""}]})},this.setSelectedItem=(0,s.kp)(this.set,"selectedItem"),this.addPage=e=>{this.setSelectedItem(void 0),this.set({pages:[...this.get().pages,e]})}}}let c=(0,s.y$)(o,"useCommandMenuStore")},92618:(e,t,a)=>{a.d(t,{A:()=>j,M:()=>y});var s=a(79342),n=a(10953),r=a(72055),i=a(56691),l=a(69648),o=a(16454),c=a(24429),d=a(17703),u=a(61312),p=a(97196),m=a(58711),h=a(74995),x=a(88382),g=a(65146),v=a(82646),f=a(5790);function j(){let{t:e}=(0,g.Bd)("settings"),{isEnterpriseUser:t,isSuperGrokProUser:a,isSuperGrokUser:l,activeSubscriptions:o}=(0,c.Q2)(),d=(0,f.iV)(h.A("setOpen")),p=(0,m.e)(h.A("setIsUpselling")),x=(0,m.e)(h.A("setTargetTier"));return(0,s.jsxs)("div",{className:"flex flex-col w-full h-full",children:[(0,s.jsxs)("div",{className:"px-3",children:[(0,s.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"font-semibold text-md",children:a?(0,s.jsx)(n.dq,{className:"h-6 w-auto"}):e("SuperGrok","SuperGrok")}),(0,s.jsx)("p",{className:(0,u.cn)("text-sm text-fg-secondary font-medium mb-4"),children:l||a?e("Your plan includes:","Your plan includes:"):e("Subscribe to SuperGrok to get:","Subscribe to SuperGrok to get:")})]}),a?null:(0,s.jsx)(i.$n,{variant:"outline",size:"pill",className:"text-sm",onClick:()=>{d(!1),x(c.i.SuperGrokPro),p(!0)},children:e("settings-billing.upgrade-to-heavy","Upgrade to Heavy")})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-4 bg-surface-l2 rounded-2xl p-4 -mx-2",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("div",{className:"text-xs text-secondary",children:e("settings-billing.model","Model")}),a?(0,s.jsx)("div",{className:"flex flex-row justify-between w-full",children:(0,s.jsx)("div",{className:"text-sm",children:e("settings-billing.grok-4-heavy","Grok 4 Heavy")})}):null,(0,s.jsx)("div",{className:"flex flex-row justify-between w-full",children:(0,s.jsx)("div",{className:"text-sm",children:e("settings-billing.grok-4","Grok 4")})}),(0,s.jsx)("div",{className:"flex flex-row justify-between w-full",children:(0,s.jsx)("div",{className:"text-sm",children:e("settings-billing.grok-3","Grok 3")})})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("div",{className:"text-xs text-secondary",children:e("settings-billing.features","Features")}),(0,s.jsx)("div",{className:"flex flex-row justify-between w-full",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(r.FWt,{className:"text-fg-secondary",height:14,width:14}),(0,s.jsx)("span",{className:"text-xs",children:e("settings-billing.free",a?"Everything in SuperGrok":"Everything in Basic")})]})}),a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex flex-row justify-between w-full",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(r.wn_,{className:"text-fg-secondary",height:14,width:14}),(0,s.jsx)("span",{className:"text-xs",children:e("settings-billing.new-features","Early access to new features")})]})}),(0,s.jsxs)("div",{className:"flex flex-row justify-between w-full",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(r.Sxh,{className:"text-fg-secondary",height:14,width:14}),(0,s.jsx)("span",{className:"text-xs",children:e("settings-billing.context","Larger context memory")})]}),(0,s.jsx)("div",{className:"text-xs text-secondary",children:e("settings-billing.context.tokens","{{tokens, number}} tokens",{tokens:256e3})})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-row justify-between w-full",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(r.Sxh,{className:"text-fg-secondary",height:14,width:14}),(0,s.jsx)("span",{className:"text-xs",children:e("settings-billing.context","Larger context memory")})]}),(0,s.jsx)("div",{className:"text-xs text-secondary",children:e("settings-billing.context.tokens","{{tokens, number}} tokens",{tokens:128e3})})]}),(0,s.jsx)("div",{className:"flex flex-row justify-between w-full",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(v.Q5b,{className:"text-fg-secondary",height:14,width:14}),(0,s.jsx)("span",{className:"text-xs",children:e("settings-billing.voice","Voice with vision")})]})})]})]})]})]}),!t&&(0,s.jsx)(b,{subscriptions:o})]})}function b(e){let{subscriptions:t}=e,{t:a}=(0,g.Bd)("settings"),n=(0,x.useMemo)(()=>null==t?[]:t.filter(e=>!e.enterprise&&"SUBSCRIPTION_STATUS_ACTIVE"===e.status),[t]),r=n[0];return null==t?null:r?1===n.length?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.w,{orientation:"horizontal",className:"my-6"}),(0,s.jsx)(w,{subscription:r,labelOverride:a("Manage your subscription","Manage your subscription")})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.w,{orientation:"horizontal",className:"my-6"}),n.map((e,t)=>(0,s.jsx)(w,{subscription:e},t))]}):(0,s.jsx)(o._,{className:"mt-auto"})}function w(e){let{labelOverride:t,subscription:a}=e,{t:n}=(0,g.Bd)("settings"),[l,o]=(0,x.useState)(!1);if(a.stripe)return(0,s.jsxs)(i.$n,{className:"text-sm",variant:"outline",size:"pill",disabled:l,onClick:()=>{o(!0),p.$W.subscriptionsCreateBillingPortalSession({body:{returnUrl:window.location.href}}).then(e=>{window.open(e.url,"_blank")}).catch((0,d.HX)("settings-billing:manage-subscription")).finally(()=>{o(!1)})},children:[null!=t?t:n("Manage your subscription (Stripe)","Manage your subscription (Stripe)"),l?(0,s.jsx)(r.krw,{height:16,width:16,className:"text-neutral-400 animate-spin !duration-1000"}):(0,s.jsx)(r.F1e,{height:16,width:16,className:"text-neutral-400"})]});if(a.x){let e=y(a);return(0,s.jsx)(i.$n,{variant:"outline",size:"pill",className:"text-sm",children:(0,s.jsxs)("a",{href:e,target:"_blank",className:"flex items-center gap-2",children:[null!=t?t:n("Manage your subscription (X)","Manage your subscription (\uD835\uDD4F)"),(0,s.jsx)(r.F1e,{height:16,width:16,className:"text-neutral-400"})]})})}if(a.apple){let e=y(a);return(0,s.jsx)(i.$n,{variant:"outline",size:"pill",className:"text-sm",children:(0,s.jsxs)("a",{href:e,target:"_blank",className:"flex items-center gap-2",children:[null!=t?t:n("Manage your subscription (Apple)","Manage your subscription (Apple)"),(0,s.jsx)(r.F1e,{height:16,width:16,className:"text-neutral-400"})]})})}if(a.google){let e=y(a);return(0,s.jsx)(i.$n,{variant:"outline",size:"pill",className:"text-sm",children:(0,s.jsxs)("a",{href:e,target:"_blank",className:"flex items-center gap-2",children:[null!=t?t:n("Manage your subscription (Google)","Manage your subscription (Google)"),(0,s.jsx)(r.F1e,{height:16,width:16,className:"text-neutral-400"})]})})}return null}function y(e){return e.x?"https://x.com/settings/subscription":e.apple?"https://apps.apple.com/account/subscriptions":e.google?"https://play.google.com/store/account/subscriptions?sku=grok.pro&package=ai.x.grok":void 0}},99667:(e,t,a)=>{a.d(t,{q:()=>m});var s=a(79342),n=a(56691),r=a(5663),i=a(75500),l=a(33231),o=a(61312),c=a(72055),d=a(88382),u=a(65146),p=a(63174);function m(e){let{value:t,onChange:a,isDirty:m,placeholder:h,onSave:x,onReset:g,disabled:v,textareaId:f,minRows:j=4,maxRows:b=8,autoFocus:w}=e,y=(0,d.useRef)(null),{t:k}=(0,u.Bd)("settings"),N=(0,d.useCallback)(e=>{a(e.target.value)},[a]),C=(0,d.useRef)(t);C.current=t;let S=(0,d.useCallback)(()=>{x(C.current)},[x]);(0,l.v)(r.Bq,()=>{S()},[S]);let I=(0,d.useCallback)(()=>{g()},[g]);(0,d.useEffect)(()=>{y.current&&!v&&w&&y.current.focus()},[w,v]);let _=(0,i.h)(),P=(0,d.useMemo)(()=>Number(_.MAX_CUSTOM_INSTRUCTIONS_LENGTH.value.maxLength),[_]),E=(0,d.useMemo)(()=>t.length>P,[t,P]),M=(0,d.useMemo)(()=>{let e=Number(_.MAX_CUSTOM_INSTRUCTIONS_LENGTH.value.maxLength);return!!e&&t.length>Math.floor(.8*e)},[t,_]);return(0,s.jsxs)("div",{className:"relative flex flex-col gap-3",children:[(0,s.jsx)("div",{className:(0,o.cn)("w-full transition ease-in-out rounded-xl","border border-border-l2",v&&"opacity-50"),children:(0,s.jsx)(p.A,{ref:y,className:(0,o.cn)("w-full p-3 text-sm align-bottom bg-transparent focus:outline-none text-primary rounded-xl"),value:t,onChange:N,placeholder:h,style:{resize:"none"},minRows:j,maxRows:b,disabled:v,id:f})}),(0,s.jsxs)("div",{className:"flex flex-row justify-between gap-2 px-0 min-h-10",children:[(0,s.jsxs)("div",{className:(0,o.cn)("flex flex-row items-center gap-1 text-xs px-3 w-full",E?"text-fg-danger":M?"text-secondary opacity-100":"opacity-0"),children:[(0,s.jsxs)("span",{children:[t.length," / ",P]}),E&&(0,s.jsx)("span",{className:"flex flex-row items-center gap-1",children:(0,s.jsx)(c.lW3,{className:"size-4 shrink-0"})})]}),(0,s.jsxs)("div",{className:(0,o.cn)("flex flex-row justify-end gap-2",v&&"hidden"),children:[(0,s.jsx)(n.$n,{variant:"outline",size:"md",disabled:!m,onClick:I,children:k("Discard","Discard")}),(0,s.jsx)(n.$n,{variant:"primary",size:"md",disabled:!m,onClick:S,children:k("Save","Save")})]})]})]})}}}]);